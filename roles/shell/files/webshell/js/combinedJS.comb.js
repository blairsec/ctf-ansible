var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,b,h){e!=Array.prototype&&e!=Object.prototype&&(e[b]=h.value)};
$jscomp.getGlobal=function(e){e=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,e];for(var b=0;b<e.length;++b){var h=e[b];if(h&&h.Math==Math)return h}return globalThis};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(e,b,h,d){if(b){h=$jscomp.global;e=e.split(".");for(d=0;d<e.length-1;d++){var a=e[d];a in h||(h[a]={});h=h[a]}e=e[e.length-1];d=h[e];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(h,e,{configurable:!0,writable:!0,value:b})}};
$jscomp.underscoreProtoCanBeSet=function(){var e={a:!0},b={};try{return b.__proto__=e,b.a}catch(h){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(e,b){e.__proto__=b;if(e.__proto__!==b)throw new TypeError(e+" is not extensible");return e}:null;$jscomp.polyfill("Object.setPrototypeOf",function(e){return e||$jscomp.setPrototypeOf},"es6","es5");
$jscomp.polyfill("String.prototype.trimLeft",function(e){function b(){return this.replace(/^[\s\xa0]+/,"")}return e||b},"es_2019","es3");$jscomp.polyfill("String.prototype.trimStart",function(e){return e||String.prototype.trimLeft},"es_2019","es3");$jscomp.polyfill("Array.prototype.fill",function(e){return e?e:function(e,h,d){var a=this.length||0;0>h&&(h=Math.max(0,a+h));if(null==d||d>a)d=a;d=Number(d);0>d&&(d=Math.max(0,a+d));for(h=Number(h||0);h<d;h++)this[h]=e;return this}},"es6","es3");
$jscomp.arrayIteratorImpl=function(e){var b=0;return function(){return b<e.length?{done:!1,value:e[b++]}:{done:!0}}};$jscomp.arrayIterator=function(e){return{next:$jscomp.arrayIteratorImpl(e)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(e,b){this.$jscomp$symbol$id_=e;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function e(h){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(h||"")+"_"+b++,h)}var b=0;return e}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.iterator;e||(e=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.asyncIterator;e||(e=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(e){$jscomp.initSymbolIterator();e={next:e};e[$jscomp.global.Symbol.iterator]=function(){return this};return e};
$jscomp.iteratorFromArray=function(e,b){$jscomp.initSymbolIterator();e instanceof String&&(e+="");var h=0,d={next:function(){if(h<e.length){var a=h++;return{value:b(a,e[a]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(e){return e?e:function(){return $jscomp.iteratorFromArray(this,function(e){return e})}},"es6","es3");
$jscomp.polyfill("Object.is",function(e){return e?e:function(e,h){return e===h?0!==e||1/e===1/h:e!==e&&h!==h}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(e){return e?e:function(e,h){var b=this;b instanceof String&&(b=String(b));var a=b.length;h=h||0;for(0>h&&(h=Math.max(h+a,0));h<a;h++){var c=b[h];if(c===e||Object.is(c,e))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(e,b,h){if(null==e)throw new TypeError("The 'this' value for String.prototype."+h+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+h+" must not be a regular expression");return e+""};$jscomp.polyfill("String.prototype.includes",function(e){return e?e:function(e,h){return-1!==$jscomp.checkStringArgs(this,e,"includes").indexOf(e,h||0)}},"es6","es3");
SSHyClient={MSG_DISCONNECT:1,MSG_IGNORE:2,MSG_UNIMPLEMENTED:3,MSG_DEBUG:4,MSG_SERVICE_REQUEST:5,MSG_SERVICE_ACCEPT:6,MSG_KEX_INIT:20,MSG_NEW_KEYS:21,MSG_KEXDH_INIT:30,MSG_KEXDH_GEX_GROUP:31,MSG_KEXDH_GEX_INIT:32,MSG_KEXDH_GEX_REPLY:33,MSG_KEXDH_GEX_REQUEST:34,MSG_USERAUTH_REQUEST:50,MSG_USERAUTH_FAILURE:51,MSG_USERAUTH_SUCCESS:52,MSG_USERAUTH_BANNER:53,MSG_GLOBAL_REQUEST:80,MSG_REQUEST_SUCCESS:81,MSG_REQUEST_FAILURE:82,MSG_CHANNEL_OPEN:90,MSG_CHANNEL_OPEN_SUCCESS:91,MSG_CHANNEL_OPEN_FAILURE:92,MSG_CHANNEL_WINDOW_ADJUST:93,
MSG_CHANNEL_DATA:94,MSG_CHANNEL_EXTENDED_DATA:95,MSG_CHANNEL_EOF:96,MSG_CHANNEL_CLOSE:97,MSG_CHANNEL_REQUEST:98,MSG_CHANNEL_SUCCESS:99,MSG_CHANNEL_FAILURE:100,WINDOW_SIZE:40674,MAX_PACKET_SIZE:16384,AES_CBC:2,AES_CTR:6,fishFsHintLeave:"\u001b[32",bashFsHintLeave:"\u001b]0;"};sjcl={cipher:{}};
sjcl.cipher.aes=function(e,b){this._tables[0][0][0]||this._precompute();this.mode=b;var h,d,a=this._tables[0][4],c=this._tables[1];b=e.length;var k=1;if(4!==b&&6!==b&&8!==b)throw"invalid aes key size";this._key=[h=e.slice(0),d=[]];for(e=b;e<4*b+28;e++){var m=h[e-1];if(0===e%b||8===b&&4===e%b)m=a[m>>>24]<<24^a[m>>16&255]<<16^a[m>>8&255]<<8^a[m&255],0===e%b&&(m=m<<8^m>>>24^k<<24,k=k<<1^283*(k>>7));h[e]=h[e-b]^m}for(b=0;e;b++,e--)m=h[b&3?e:e-4],d[b]=4>=e||4>b?m:c[0][a[m>>>24]]^c[1][a[m>>16&255]]^c[2][a[m>>
8&255]]^c[3][a[m&255]]};sjcl.cipher.aes.MODE_CBC=2;sjcl.cipher.aes.MODE_CTR=6;
sjcl.cipher.aes.prototype={encrypt:function(e,b,h){b=this.mode==sjcl.cipher.aes.MODE_CBC?b:[];for(var d=[],a=0;a<e.length/16;a++){var c=e.slice(16*a,16*(a+1));if(this.mode==sjcl.cipher.aes.MODE_CBC){for(var k=0;16>k;k++)c[k]^=b[k];b=sjcl.codec.bytes.fromBits(this._crypt(sjcl.codec.bytes.toBits(c),0))}else for(b=sjcl.codec.bytes.fromBits(this._crypt(sjcl.codec.bytes.toBits(toByteArray(h.increment())),0)),k=0;16>k;k++)b[k]^=c[k];d=d.concat(b)}return d},decrypt:function(e,b){for(var h=[],d=0;d<e.length/
16;d++){var a=e.slice(16*d,16*(d+1));ct=sjcl.codec.bytes.fromBits(this._crypt(sjcl.codec.bytes.toBits(a),1));if(this.mode==sjcl.cipher.aes.MODE_CBC){for(var c=0;16>c;c++)ct[c]^=b[c];b=a}h=h.concat(ct)}return h},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var e=this._tables[0],b=this._tables[1],h=e[4],d=b[4],a,c,k,m=[],p=[],q;for(a=0;256>a;a++)p[(m[a]=a<<1^283*(a>>7))^a]=a;for(c=k=0;!h[c];c^=q||1,k=p[k]||1){var l=k^k<<1^k<<2^k<<3^k<<4;l=l>>8^l&255^99;h[c]=l;d[l]=c;var f=m[a=
m[q=m[c]]];var g=16843009*f^65537*a^257*q^16843008*c;f=257*m[l]^16843008*l;for(a=0;4>a;a++)e[a][c]=f=f<<24^f>>>8,b[a][l]=g=g<<24^g>>>8}for(a=0;5>a;a++)e[a]=e[a].slice(0),b[a]=b[a].slice(0)},_crypt:function(e,b){if(4!==e.length)throw"invalid aes block size";var h=this._key[b],d=e[0]^h[0],a=e[b?3:1]^h[1],c=e[2]^h[2];e=e[b?1:3]^h[3];var k=h.length/4-2,m,p=4,q=[0,0,0,0];var l=this._tables[b];var f=l[0],g=l[1],n=l[2],u=l[3],r=l[4];for(m=0;m<k;m++){l=f[d>>>24]^g[a>>16&255]^n[c>>8&255]^u[e&255]^h[p];var z=
f[a>>>24]^g[c>>16&255]^n[e>>8&255]^u[d&255]^h[p+1];var t=f[c>>>24]^g[e>>16&255]^n[d>>8&255]^u[a&255]^h[p+2];e=f[e>>>24]^g[d>>16&255]^n[a>>8&255]^u[c&255]^h[p+3];p+=4;d=l;a=z;c=t}for(m=0;4>m;m++)q[b?3&-m:m]=r[d>>>24]<<24^r[a>>16&255]<<16^r[c>>8&255]<<8^r[e&255]^h[p++],l=d,d=a,a=c,c=e,e=l;return q}};sjcl.codec={};
sjcl.codec.bytes={fromBits:function(e){var b=[],h=sjcl.bitArray.bitLength(e),d,a;for(d=0;d<h/8;d++)0===(d&3)&&(a=e[d/4]),b.push(a>>>24),a<<=8;return b},toBits:function(e){var b=[],h,d=0;for(h=0;h<e.length;h++)d=d<<8|e[h],3===(h&3)&&(b.push(d),d=0);h&3&&b.push(sjcl.bitArray.partial(8*(h&3),d));return b}};
sjcl.bitArray={bitLength:function(e){var b=e.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(e[b-1])},partial:function(e,b,h){return 32===e?b:(h?b|0:b<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32}};var BigInteger=function(){function e(a,e,b){null!=a&&("number"==typeof a?this.fromNumber(a,e,b):null==e&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,e))}function b(){return new e(null)}function h(a,e,b,g,f,n){for(;0<=--n;){var x=e*this[a++]+b[g]+f;f=Math.floor(x/67108864);b[g++]=x&67108863}return f}function d(a,e,b,g,f,n){var x=e&32767;for(e>>=15;0<=--n;){var c=this[a]&32767,l=this[a++]>>15,d=e*c+l*x;c=x*c+((d&32767)<<15)+b[g]+(f&1073741823);f=(c>>>30)+(d>>>15)+e*l+(f>>>30);b[g++]=
c&1073741823}return f}function a(a,e,b,g,f,n){var x=e&16383;for(e>>=14;0<=--n;){var c=this[a]&16383,l=this[a++]>>14,d=e*c+l*x;c=x*c+((d&16383)<<14)+b[g]+f;f=(c>>28)+(d>>14)+e*l;b[g++]=c&268435455}return f}function c(a,e){a=y[a.charCodeAt(e)];return null==a?-1:a}function k(a){var e=b();e.fromInt(a);return e}function m(a){var e=1,b;0!=(b=a>>>16)&&(a=b,e+=16);0!=(b=a>>8)&&(a=b,e+=8);0!=(b=a>>4)&&(a=b,e+=4);0!=(b=a>>2)&&(a=b,e+=2);0!=a>>1&&(e+=1);return e}function p(a){this.m=a}function q(a){this.m=a;
this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}function l(a,e){return a&e}function f(a,e){return a|e}function g(a,e){return a^e}function n(a,e){return a&~e}function u(){}function r(a){return a}function z(a){this.r2=b();this.q3=b();e.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a);this.m=a}var t;"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=d,t=30):"Netscape"!=navigator.appName?(e.prototype.am=h,t=26):(e.prototype.am=
a,t=28);e.prototype.DB=t;e.prototype.DM=(1<<t)-1;e.prototype.DV=1<<t;e.prototype.FV=Math.pow(2,52);e.prototype.F1=52-t;e.prototype.F2=2*t-52;var y=[],w;t=48;for(w=0;9>=w;++w)y[t++]=w;t=97;for(w=10;36>w;++w)y[t++]=w;t=65;for(w=10;36>w;++w)y[t++]=w;p.prototype.convert=function(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a};p.prototype.revert=function(a){return a};p.prototype.reduce=function(a){a.divRemTo(this.m,null,a)};p.prototype.mulTo=function(a,e,b){a.multiplyTo(e,b);this.reduce(b)};p.prototype.sqrTo=
function(a,e){a.squareTo(e);this.reduce(e)};q.prototype.convert=function(a){var g=b();a.abs().dlShiftTo(this.m.t,g);g.divRemTo(this.m,null,g);0>a.s&&0<g.compareTo(e.ZERO)&&this.m.subTo(g,g);return g};q.prototype.revert=function(a){var e=b();a.copyTo(e);this.reduce(e);return e};q.prototype.reduce=function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var e=0;e<this.m.t;++e){var b=a[e]&32767,g=b*this.mpl+((b*this.mph+(a[e]>>15)*this.mpl&this.um)<<15)&a.DM;b=e+this.m.t;for(a[b]+=this.m.am(0,g,a,e,0,this.m.t);a[b]>=
a.DV;)a[b]-=a.DV,a[++b]++}a.clamp();a.drShiftTo(this.m.t,a);0<=a.compareTo(this.m)&&a.subTo(this.m,a)};q.prototype.mulTo=function(a,e,b){a.multiplyTo(e,b);this.reduce(b)};q.prototype.sqrTo=function(a,e){a.squareTo(e);this.reduce(e)};e.prototype.copyTo=function(a){for(var e=this.t-1;0<=e;--e)a[e]=this[e];a.t=this.t;a.s=this.s};e.prototype.fromInt=function(a){this.t=1;this.s=0>a?-1:0;0<a?this[0]=a:-1>a?this[0]=a+DV:this.t=0};e.prototype.fromString=function(a,b){if(16==b)b=4;else if(8==b)b=3;else if(256==
b)b=8;else if(2==b)b=1;else if(32==b)b=5;else if(4==b)b=2;else{this.fromRadix(a,b);return}this.s=this.t=0;for(var g=a.length,f=!1,n=0;0<=--g;){var x=8==b?a[g]&255:c(a,g);0>x?"-"==a.charAt(g)&&(f=!0):(f=!1,0==n?this[this.t++]=x:n+b>this.DB?(this[this.t-1]|=(x&(1<<this.DB-n)-1)<<n,this[this.t++]=x>>this.DB-n):this[this.t-1]|=x<<n,n+=b,n>=this.DB&&(n-=this.DB))}8==b&&0!=(a[0]&128)&&(this.s=-1,0<n&&(this[this.t-1]|=(1<<this.DB-n)-1<<n));this.clamp();f&&e.ZERO.subTo(this,this)};e.prototype.clamp=function(){for(var a=
this.s&this.DM;0<this.t&&this[this.t-1]==a;)--this.t};e.prototype.dlShiftTo=function(a,e){var b;for(b=this.t-1;0<=b;--b)e[b+a]=this[b];for(b=a-1;0<=b;--b)e[b]=0;e.t=this.t+a;e.s=this.s};e.prototype.drShiftTo=function(a,e){for(var b=a;b<this.t;++b)e[b-a]=this[b];e.t=Math.max(this.t-a,0);e.s=this.s};e.prototype.lShiftTo=function(a,e){var b=a%this.DB,g=this.DB-b,f=(1<<g)-1;a=Math.floor(a/this.DB);var n=this.s<<b&this.DM,c;for(c=this.t-1;0<=c;--c)e[c+a+1]=this[c]>>g|n,n=(this[c]&f)<<b;for(c=a-1;0<=c;--c)e[c]=
0;e[a]=n;e.t=this.t+a+1;e.s=this.s;e.clamp()};e.prototype.rShiftTo=function(a,e){e.s=this.s;var b=Math.floor(a/this.DB);if(b>=this.t)e.t=0;else{a%=this.DB;var g=this.DB-a,f=(1<<a)-1;e[0]=this[b]>>a;for(var n=b+1;n<this.t;++n)e[n-b-1]|=(this[n]&f)<<g,e[n-b]=this[n]>>a;0<a&&(e[this.t-b-1]|=(this.s&f)<<g);e.t=this.t-b;e.clamp()}};e.prototype.subTo=function(a,e){for(var b=0,g=0,f=Math.min(a.t,this.t);b<f;)g+=this[b]-a[b],e[b++]=g&this.DM,g>>=this.DB;if(a.t<this.t){for(g-=a.s;b<this.t;)g+=this[b],e[b++]=
g&this.DM,g>>=this.DB;g+=this.s}else{for(g+=this.s;b<a.t;)g-=a[b],e[b++]=g&this.DM,g>>=this.DB;g-=a.s}e.s=0>g?-1:0;-1>g?e[b++]=this.DV+g:0<g&&(e[b++]=g);e.t=b;e.clamp()};e.prototype.multiplyTo=function(a,b){var g=this.abs(),f=a.abs(),n=g.t;for(b.t=n+f.t;0<=--n;)b[n]=0;for(n=0;n<f.t;++n)b[n+g.t]=g.am(0,f[n],b,n,0,g.t);b.s=0;b.clamp();this.s!=a.s&&e.ZERO.subTo(b,b)};e.prototype.squareTo=function(a){for(var e=this.abs(),b=a.t=2*e.t;0<=--b;)a[b]=0;for(b=0;b<e.t-1;++b){var g=e.am(b,e[b],a,2*b,0,1);(a[b+
e.t]+=e.am(b+1,2*e[b],a,2*b+1,g,e.t-b-1))>=e.DV&&(a[b+e.t]-=e.DV,a[b+e.t+1]=1)}0<a.t&&(a[a.t-1]+=e.am(b,e[b],a,2*b,0,1));a.s=0;a.clamp()};e.prototype.divRemTo=function(a,g,f){var n=a.abs();if(!(0>=n.t)){var c=this.abs();if(c.t<n.t)null!=g&&g.fromInt(0),null!=f&&this.copyTo(f);else{null==f&&(f=b());var l=b(),d=this.s;a=a.s;var x=this.DB-m(n[n.t-1]);0<x?(n.lShiftTo(x,l),c.lShiftTo(x,f)):(n.copyTo(l),c.copyTo(f));n=l.t;c=l[n-1];if(0!=c){var k=c*(1<<this.F1)+(1<n?l[n-2]>>this.F2:0),q=this.FV/k;k=(1<<
this.F1)/k;var r=1<<this.F2,u=f.t,p=u-n,t=null==g?b():g;l.dlShiftTo(p,t);0<=f.compareTo(t)&&(f[f.t++]=1,f.subTo(t,f));e.ONE.dlShiftTo(n,t);for(t.subTo(l,l);l.t<n;)l[l.t++]=0;for(;0<=--p;){var h=f[--u]==c?this.DM:Math.floor(f[u]*q+(f[u-1]+r)*k);if((f[u]+=l.am(0,h,f,p,0,n))<h)for(l.dlShiftTo(p,t),f.subTo(t,f);f[u]<--h;)f.subTo(t,f)}null!=g&&(f.drShiftTo(n,g),d!=a&&e.ZERO.subTo(g,g));f.t=n;f.clamp();0<x&&f.rShiftTo(x,f);0>d&&e.ZERO.subTo(f,f)}}}};e.prototype.invDigit=function(){if(1>this.t)return 0;
var a=this[0];if(0==(a&1))return 0;var e=a&3;e=e*(2-(a&15)*e)&15;e=e*(2-(a&255)*e)&255;e=e*(2-((a&65535)*e&65535))&65535;e=e*(2-a*e%this.DV)%this.DV;return 0<e?this.DV-e:-e};e.prototype.isEven=function(){return 0==(0<this.t?this[0]&1:this.s)};e.prototype.exp=function(a,g){if(4294967295<a||1>a)return e.ONE;var f=b(),n=b(),c=g.convert(this),l=m(a)-1;for(c.copyTo(f);0<=--l;)if(g.sqrTo(f,n),0<(a&1<<l))g.mulTo(n,c,f);else{var d=f;f=n;n=d}return g.revert(f)};e.prototype.toString=function(a){if(0>this.s)return"-"+
this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;else if(32==a)a=5;else if(4==a)a=2;else return this.toRadix(a);var e=(1<<a)-1,b,g=!1,f="",n=this.t,c=this.DB-n*this.DB%a;if(0<n--)for(c<this.DB&&0<(b=this[n]>>c)&&(g=!0,f="0123456789abcdefghijklmnopqrstuvwxyz".charAt(b));0<=n;)c<a?(b=(this[n]&(1<<c)-1)<<a-c,b|=this[--n]>>(c+=this.DB-a)):(b=this[n]>>(c-=a)&e,0>=c&&(c+=this.DB,--n)),0<b&&(g=!0),g&&(f+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(b));return g?f:"0"};e.prototype.negate=
function(){var a=b();e.ZERO.subTo(this,a);return a};e.prototype.abs=function(){return 0>this.s?this.negate():this};e.prototype.compareTo=function(a){var e=this.s-a.s;if(0!=e)return e;var b=this.t;e=b-a.t;if(0!=e)return e;for(;0<=--b;)if(0!=(e=this[b]-a[b]))return e;return 0};e.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+m(this[this.t-1]^this.s&this.DM)};e.prototype.mod=function(a){var g=b();this.abs().divRemTo(a,null,g);0>this.s&&0<g.compareTo(e.ZERO)&&a.subTo(g,g);return g};
e.prototype.modPowInt=function(a,e){e=256>a||e.isEven()?new p(e):new q(e);return this.exp(a,e)};e.ZERO=k(0);e.ONE=k(1);u.prototype.convert=r;u.prototype.revert=r;u.prototype.mulTo=function(a,e,b){a.multiplyTo(e,b)};u.prototype.sqrTo=function(a,e){a.squareTo(e)};z.prototype.convert=function(a){if(0>a.s||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var e=b();a.copyTo(e);this.reduce(e);return e};z.prototype.revert=function(a){return a};z.prototype.reduce=function(a){a.drShiftTo(this.m.t-
1,this.r2);a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);0<=a.compareTo(this.m);)a.subTo(this.m,a)};z.prototype.mulTo=function(a,e,b){a.multiplyTo(e,b);this.reduce(b)};z.prototype.sqrTo=function(a,e){a.squareTo(e);this.reduce(e)};var v=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,
113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],C=67108864/v[v.length-1];e.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))};e.prototype.toRadix=function(a){null==a&&(a=10);if(0==this.signum()||2>a||36<a)return"0";var e=this.chunkSize(a);e=Math.pow(a,
e);var g=k(e),f=b(),n=b(),c="";for(this.divRemTo(g,f,n);0<f.signum();)c=(e+n.intValue()).toString(a).substr(1)+c,f.divRemTo(g,f,n);return n.intValue().toString(a)+c};e.prototype.fromRadix=function(a,b){this.fromInt(0);null==b&&(b=10);for(var g=this.chunkSize(b),f=Math.pow(b,g),n=!1,l=0,d=0,m=0;m<a.length;++m){var k=c(a,m);0>k?"-"==a.charAt(m)&&0==this.signum()&&(n=!0):(d=b*d+k,++l>=g&&(this.dMultiply(f),this.dAddOffset(d,0),d=l=0))}0<l&&(this.dMultiply(Math.pow(b,l)),this.dAddOffset(d,0));n&&e.ZERO.subTo(this,
this)};e.prototype.fromNumber=function(a,b,g){if("number"==typeof b)if(2>a)this.fromInt(1);else for(this.fromNumber(a,g),this.testBit(a-1)||this.bitwiseTo(e.ONE.shiftLeft(a-1),f,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(e.ONE.shiftLeft(a-1),this);else{g=[];var n=a&7;g.length=(a>>3)+1;b.nextBytes(g);g[0]=0<n?g[0]&(1<<n)-1:0;this.fromString(g,256)}};e.prototype.bitwiseTo=function(a,e,b){var g,f=Math.min(a.t,this.t);for(g=
0;g<f;++g)b[g]=e(this[g],a[g]);if(a.t<this.t){var n=a.s&this.DM;for(g=f;g<this.t;++g)b[g]=e(this[g],n);b.t=this.t}else{n=this.s&this.DM;for(g=f;g<a.t;++g)b[g]=e(n,a[g]);b.t=a.t}b.s=e(this.s,a.s);b.clamp()};e.prototype.changeBit=function(a,b){a=e.ONE.shiftLeft(a);this.bitwiseTo(a,b,a);return a};e.prototype.addTo=function(a,e){for(var b=0,g=0,f=Math.min(a.t,this.t);b<f;)g+=this[b]+a[b],e[b++]=g&this.DM,g>>=this.DB;if(a.t<this.t){for(g+=a.s;b<this.t;)g+=this[b],e[b++]=g&this.DM,g>>=this.DB;g+=this.s}else{for(g+=
this.s;b<a.t;)g+=a[b],e[b++]=g&this.DM,g>>=this.DB;g+=a.s}e.s=0>g?-1:0;0<g?e[b++]=g:-1>g&&(e[b++]=this.DV+g);e.t=b;e.clamp()};e.prototype.dMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()};e.prototype.dAddOffset=function(a,e){if(0!=a){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=a;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}};e.prototype.multiplyLowerTo=function(a,e,b){var g=Math.min(this.t+a.t,e);b.s=0;for(b.t=g;0<g;)b[--g]=
0;var f;for(f=b.t-this.t;g<f;++g)b[g+this.t]=this.am(0,a[g],b,g,0,this.t);for(f=Math.min(a.t,e);g<f;++g)this.am(0,a[g],b,g,0,e-g);b.clamp()};e.prototype.multiplyUpperTo=function(a,e,b){--e;var g=b.t=this.t+a.t-e;for(b.s=0;0<=--g;)b[g]=0;for(g=Math.max(e-this.t,0);g<a.t;++g)b[this.t+g-e]=this.am(e-g,a[g],b,0,0,this.t+g-e);b.clamp();b.drShiftTo(1,b)};e.prototype.modInt=function(a){if(0>=a)return 0;var e=this.DV%a,b=0>this.s?a-1:0;if(0<this.t)if(0==e)b=this[0]%a;else for(var g=this.t-1;0<=g;--g)b=(e*
b+this[g])%a;return b};e.prototype.millerRabin=function(a){var g=this.subtract(e.ONE),f=g.getLowestSetBit();if(0>=f)return!1;var n=g.shiftRight(f);a=a+1>>1;a>v.length&&(a=v.length);for(var c=b(),l=0;l<a;++l){c.fromInt(v[l]);var d=c.modPow(n,this);if(0!=d.compareTo(e.ONE)&&0!=d.compareTo(g)){for(var m=1;m++<f&&0!=d.compareTo(g);)if(d=d.modPowInt(2,this),0==d.compareTo(e.ONE))return!1;if(0!=d.compareTo(g))return!1}}return!0};e.prototype.clone=function(){var a=b();this.copyTo(a);return a};e.prototype.intValue=
function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};e.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24};e.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};e.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1};e.prototype.toByteArray=function(){var a=this.t,e=[];e[0]=this.s;var b=this.DB-
a*this.DB%8,g,f=0;if(0<a--)for(b<this.DB&&(g=this[a]>>b)!=(this.s&this.DM)>>b&&(e[f++]=g|this.s<<this.DB-b);0<=a;)if(8>b?(g=(this[a]&(1<<b)-1)<<8-b,g|=this[--a]>>(b+=this.DB-8)):(g=this[a]>>(b-=8)&255,0>=b&&(b+=this.DB,--a)),0!=(g&128)&&(g|=-256),0==f&&(this.s&128)!=(g&128)&&++f,0<f||g!=this.s)e[f++]=g;return e};e.prototype.equals=function(a){return 0==this.compareTo(a)};e.prototype.min=function(a){return 0>this.compareTo(a)?this:a};e.prototype.max=function(a){return 0<this.compareTo(a)?this:a};e.prototype.and=
function(a){var e=b();this.bitwiseTo(a,l,e);return e};e.prototype.or=function(a){var e=b();this.bitwiseTo(a,f,e);return e};e.prototype.xor=function(a){var e=b();this.bitwiseTo(a,g,e);return e};e.prototype.andNot=function(a){var e=b();this.bitwiseTo(a,n,e);return e};e.prototype.not=function(){for(var a=b(),e=0;e<this.t;++e)a[e]=this.DM&~this[e];a.t=this.t;a.s=~this.s;return a};e.prototype.shiftLeft=function(a){var e=b();0>a?this.rShiftTo(-a,e):this.lShiftTo(a,e);return e};e.prototype.shiftRight=function(a){var e=
b();0>a?this.lShiftTo(-a,e):this.rShiftTo(a,e);return e};e.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(0!=this[a]){var e=a*this.DB;a=this[a];if(0==a)a=-1;else{var b=0;0==(a&65535)&&(a>>=16,b+=16);0==(a&255)&&(a>>=8,b+=8);0==(a&15)&&(a>>=4,b+=4);0==(a&3)&&(a>>=2,b+=2);0==(a&1)&&++b;a=b}return e+a}return 0>this.s?this.t*this.DB:-1};e.prototype.bitCount=function(){for(var a=0,e=this.s&this.DM,b=0;b<this.t;++b){for(var g=this[b]^e,f=0;0!=g;)g&=g-1,++f;a+=f}return a};e.prototype.testBit=
function(a){var e=Math.floor(a/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<a%this.DB)};e.prototype.setBit=function(a){return this.changeBit(a,f)};e.prototype.clearBit=function(a){return this.changeBit(a,n)};e.prototype.flipBit=function(a){return this.changeBit(a,g)};e.prototype.add=function(a){var e=b();this.addTo(a,e);return e};e.prototype.subtract=function(a){var e=b();this.subTo(a,e);return e};e.prototype.multiply=function(a){var e=b();this.multiplyTo(a,e);return e};e.prototype.divide=function(a){var e=
b();this.divRemTo(a,e,null);return e};e.prototype.remainder=function(a){var e=b();this.divRemTo(a,null,e);return e};e.prototype.divideAndRemainder=function(a){var e=b(),g=b();this.divRemTo(a,e,g);return[e,g]};e.prototype.modPow=function(a,e){var g=a.bitLength(),f=k(1);if(0>=g)return f;var n=18>g?1:48>g?3:144>g?4:768>g?5:6;e=8>g?new p(e):e.isEven()?new z(e):new q(e);var c=[],l=3,d=n-1,u=(1<<n)-1;c[1]=e.convert(this);if(1<n)for(g=b(),e.sqrTo(c[1],g);l<=u;)c[l]=b(),e.mulTo(g,c[l-2],c[l]),l+=2;var r=
a.t-1,t,h=!0,w=b();for(g=m(a[r])-1;0<=r;){g>=d?t=a[r]>>g-d&u:(t=(a[r]&(1<<g+1)-1)<<d-g,0<r&&(t|=a[r-1]>>this.DB+g-d));for(l=n;0==(t&1);)t>>=1,--l;0>(g-=l)&&(g+=this.DB,--r);if(h)c[t].copyTo(f),h=!1;else{for(;1<l;)e.sqrTo(f,w),e.sqrTo(w,f),l-=2;0<l?e.sqrTo(f,w):(l=f,f=w,w=l);e.mulTo(w,c[t],f)}for(;0<=r&&0==(a[r]&1<<g);)e.sqrTo(f,w),l=f,f=w,w=l,0>--g&&(g=this.DB-1,--r)}return e.revert(f)};e.prototype.modInverse=function(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return e.ZERO;for(var g=
a.clone(),f=this.clone(),n=k(1),c=k(0),l=k(0),d=k(1);0!=g.signum();){for(;g.isEven();)g.rShiftTo(1,g),b?(n.isEven()&&c.isEven()||(n.addTo(this,n),c.subTo(a,c)),n.rShiftTo(1,n)):c.isEven()||c.subTo(a,c),c.rShiftTo(1,c);for(;f.isEven();)f.rShiftTo(1,f),b?(l.isEven()&&d.isEven()||(l.addTo(this,l),d.subTo(a,d)),l.rShiftTo(1,l)):d.isEven()||d.subTo(a,d),d.rShiftTo(1,d);0<=g.compareTo(f)?(g.subTo(f,g),b&&n.subTo(l,n),c.subTo(d,c)):(f.subTo(g,f),b&&l.subTo(n,l),d.subTo(c,d))}if(0!=f.compareTo(e.ONE))return e.ZERO;
if(0<=d.compareTo(a))return d.subtract(a);if(0>d.signum())d.addTo(a,d);else return d;return 0>d.signum()?d.add(a):d};e.prototype.pow=function(a){return this.exp(a,new u)};e.prototype.gcd=function(a){var e=0>this.s?this.negate():this.clone();a=0>a.s?a.negate():a.clone();if(0>e.compareTo(a)){var b=e;e=a;a=b}b=e.getLowestSetBit();var g=a.getLowestSetBit();if(0>g)return e;b<g&&(g=b);for(0<g&&(e.rShiftTo(g,e),a.rShiftTo(g,a));0<e.signum();)0<(b=e.getLowestSetBit())&&e.rShiftTo(b,e),0<(b=a.getLowestSetBit())&&
a.rShiftTo(b,a),0<=e.compareTo(a)?(e.subTo(a,e),e.rShiftTo(1,e)):(a.subTo(e,a),a.rShiftTo(1,a));0<g&&a.lShiftTo(g,a);return a};e.prototype.isProbablePrime=function(a){var e,b=this.abs();if(1==b.t&&b[0]<=v[v.length-1]){for(e=0;e<v.length;++e)if(b[0]==v[e])return!0;return!1}if(b.isEven())return!1;for(e=1;e<v.length;){for(var g=v[e],f=e+1;f<v.length&&g<C;)g*=v[f++];for(g=b.modInt(g);e<f;)if(0==g%v[e++])return!1}return b.millerRabin(a)};return{BigInteger:e}}();BigInteger=BigInteger.BigInteger;SSHyClient.hash={};SSHyClient.hash.SHA1=function(e){this.data=e||"";this.digest_size=20};
SSHyClient.hash.SHA1.prototype={digest:function(){var e=toByteArray(this.data),b=bytesToWords(e),h=8*e.length;e=[];var d=1732584193,a=-271733879,c=-1732584194,k=271733878,m=-1009589776;b[h>>5]|=128<<24-h%32;b[(h+64>>>9<<4)+15]=h;for(h=0;h<b.length;h+=16){for(var p=d,q=a,l=c,f=k,g=m,n=0;80>n;n++){if(16>n)e[n]=b[h+n];else{var u=e[n-3]^e[n-8]^e[n-14]^e[n-16];e[n]=u<<1|u>>>31}u=(d<<5|d>>>27)+m+(e[n]>>>0)+(20>n?(a&c|~a&k)+1518500249:40>n?(a^c^k)+1859775393:60>n?(a&c|a&k|c&k)-1894007588:(a^c^k)-899497514);
m=k;k=c;c=a<<30|a>>>2;a=d;d=u}d+=p;a+=q;c+=l;k+=f;m+=g}return fromByteArray(wordsToBytes([d,a,c,k,m]))}};SSHyClient.hash.SHA256=function(e){this.data=e||"";this.digest_size=32};
SSHyClient.hash.SHA256.prototype={digest:function(){var e=toByteArray(this.data),b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,
2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],h=bytesToWords(e),d=8*e.length;e=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];var a=[],c,k;h[d>>5]|=128<<24-d%32;h[(d+64>>9<<4)+15]=d;for(c=0;c<h.length;c+=16){d=e[0];var m=e[1];var p=e[2];
var q=e[3];var l=e[4];var f=e[5];var g=e[6];var n=e[7];for(k=0;64>k;k++){if(16>k)a[k]=h[k+c];else{var u=a[k-15];var r=a[k-2];a[k]=((u<<25|u>>>7)^(u<<14|u>>>18)^u>>>3)+(a[k-7]>>>0)+((r<<15|r>>>17)^(r<<13|r>>>19)^r>>>10)+(a[k-16]>>>0)}r=d&m^d&p^m&p;var z=(d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22);u=(n>>>0)+((l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25))+(l&f^~l&g)+b[k]+(a[k]>>>0);r=z+r;n=g;g=f;f=l;l=q+u>>>0;q=p;p=m;m=d;d=u+r>>>0}e[0]+=d;e[1]+=m;e[2]+=p;e[3]+=q;e[4]+=l;e[5]+=f;e[6]+=g;e[7]+=n}return fromByteArray(wordsToBytes(e))}};
SSHyClient.hash.HMAC=function(e,b,h){h=digestmod="SHA-1"==h?SSHyClient.hash.SHA1:SSHyClient.hash.SHA256;var d=new h,a=new h;64<e.length&&(e=(new h(e)).digest());e+=Array(64-e.length+1).join("\x00");h=toByteArray(e).slice(0);e=toByteArray(e).slice(0);for(var c=0;64>c;++c)h[c]^=92,e[c]^=54;d.data+=fromByteArray(h);a.data+=fromByteArray(e);a.data+=b;d.data+=a.digest();return d.digest()};
SSHyClient.hash.MD5=function(e){var b=toByteArray(e);e=bytesToWords(b);var h=8*b.length;b=1732584193;for(var d=-271733879,a=-1732584194,c=271733878,k=0;k<e.length;k++)e[k]=(e[k]<<8|e[k]>>>24)&16711935|(e[k]<<24|e[k]>>>8)&4278255360;e[h>>>5]|=128<<h%32;e[(h+64>>>9<<4)+14]=h;h=function(a,e,b,g,f,n,c){a=a+(e&b|~e&g)+(f>>>0)+c;return(a<<n|a>>>32-n)+e};var m=function(a,e,b,g,f,n,c){a=a+(e&g|b&~g)+(f>>>0)+c;return(a<<n|a>>>32-n)+e},p=function(a,e,b,g,f,n,c){a=a+(e^b^g)+(f>>>0)+c;return(a<<n|a>>>32-n)+e},
q=function(a,e,b,g,f,n,c){a=a+(b^(e|~g))+(f>>>0)+c;return(a<<n|a>>>32-n)+e};for(k=0;k<e.length;k+=16){var l=b,f=d,g=a,n=c;b=h(b,d,a,c,e[k+0],7,-680876936);c=h(c,b,d,a,e[k+1],12,-389564586);a=h(a,c,b,d,e[k+2],17,606105819);d=h(d,a,c,b,e[k+3],22,-1044525330);b=h(b,d,a,c,e[k+4],7,-176418897);c=h(c,b,d,a,e[k+5],12,1200080426);a=h(a,c,b,d,e[k+6],17,-1473231341);d=h(d,a,c,b,e[k+7],22,-45705983);b=h(b,d,a,c,e[k+8],7,1770035416);c=h(c,b,d,a,e[k+9],12,-1958414417);a=h(a,c,b,d,e[k+10],17,-42063);d=h(d,a,c,
b,e[k+11],22,-1990404162);b=h(b,d,a,c,e[k+12],7,1804603682);c=h(c,b,d,a,e[k+13],12,-40341101);a=h(a,c,b,d,e[k+14],17,-1502002290);d=h(d,a,c,b,e[k+15],22,1236535329);b=m(b,d,a,c,e[k+1],5,-165796510);c=m(c,b,d,a,e[k+6],9,-1069501632);a=m(a,c,b,d,e[k+11],14,643717713);d=m(d,a,c,b,e[k+0],20,-373897302);b=m(b,d,a,c,e[k+5],5,-701558691);c=m(c,b,d,a,e[k+10],9,38016083);a=m(a,c,b,d,e[k+15],14,-660478335);d=m(d,a,c,b,e[k+4],20,-405537848);b=m(b,d,a,c,e[k+9],5,568446438);c=m(c,b,d,a,e[k+14],9,-1019803690);
a=m(a,c,b,d,e[k+3],14,-187363961);d=m(d,a,c,b,e[k+8],20,1163531501);b=m(b,d,a,c,e[k+13],5,-1444681467);c=m(c,b,d,a,e[k+2],9,-51403784);a=m(a,c,b,d,e[k+7],14,1735328473);d=m(d,a,c,b,e[k+12],20,-1926607734);b=p(b,d,a,c,e[k+5],4,-378558);c=p(c,b,d,a,e[k+8],11,-2022574463);a=p(a,c,b,d,e[k+11],16,1839030562);d=p(d,a,c,b,e[k+14],23,-35309556);b=p(b,d,a,c,e[k+1],4,-1530992060);c=p(c,b,d,a,e[k+4],11,1272893353);a=p(a,c,b,d,e[k+7],16,-155497632);d=p(d,a,c,b,e[k+10],23,-1094730640);b=p(b,d,a,c,e[k+13],4,681279174);
c=p(c,b,d,a,e[k+0],11,-358537222);a=p(a,c,b,d,e[k+3],16,-722521979);d=p(d,a,c,b,e[k+6],23,76029189);b=p(b,d,a,c,e[k+9],4,-640364487);c=p(c,b,d,a,e[k+12],11,-421815835);a=p(a,c,b,d,e[k+15],16,530742520);d=p(d,a,c,b,e[k+2],23,-995338651);b=q(b,d,a,c,e[k+0],6,-198630844);c=q(c,b,d,a,e[k+7],10,1126891415);a=q(a,c,b,d,e[k+14],15,-1416354905);d=q(d,a,c,b,e[k+5],21,-57434055);b=q(b,d,a,c,e[k+12],6,1700485571);c=q(c,b,d,a,e[k+3],10,-1894986606);a=q(a,c,b,d,e[k+10],15,-1051523);d=q(d,a,c,b,e[k+1],21,-2054922799);
b=q(b,d,a,c,e[k+8],6,1873313359);c=q(c,b,d,a,e[k+15],10,-30611744);a=q(a,c,b,d,e[k+6],15,-1560198380);d=q(d,a,c,b,e[k+13],21,1309151649);b=q(b,d,a,c,e[k+4],6,-145523070);c=q(c,b,d,a,e[k+11],10,-1120210379);a=q(a,c,b,d,e[k+2],15,718787259);d=q(d,a,c,b,e[k+9],21,-343485551);b=b+l>>>0;d=d+f>>>0;a=a+g>>>0;c=c+n>>>0}var u=function(a){if(a.constructor==Number)return(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;for(var e=0;e<a.length;e++)a[e]=u(a[e]);return a};return fromByteArray(wordsToBytes(u([b,d,
a,c])))};var symbols={"-2":"E","-1":"S",0:" ",1:".",2:"o",3:"+",4:"=",5:"*",6:"B",7:"O",8:"X",9:"@",10:"%",11:"&",12:"#",13:"/",14:"^"},bounds={width:17,height:9};function createBoard(e){for(var b=[],h=0;h<e.width;h++){b[h]=[];for(var d=0;d<e.height;d++)b[h][d]=0}return b}
function generateBoard(e){var b=createBoard(bounds),h=Math.floor(bounds.width/2),d=Math.floor(bounds.height/2);b[h][d]=-1;e.forEach(function(a){for(var e=0;8>e;e+=2){var k=a>>e&3;switch(k){case 0:case 1:0<d&&d--;break;case 2:case 3:d<bounds.height-1&&d++}switch(k){case 0:case 2:0<h&&h--;break;case 1:case 3:h<bounds.width-1&&h++}0<=b[h][d]&&b[h][d]++}});b[h][d]=-2;return b}
function boardToString(e){result=[];for(var b=0;b<bounds.height;b++){result[b]=[];for(var h=0;h<bounds.width;h++)result[b][h]=symbols[e[h][b]]||symbols[0];result[b]="|"+result[b].join("")+"|"}result.splice(0,0,"\n+---[ RSA2048 ]---+");result.push("+-----------------+");return result.join("\n")}function randomart(e){for(var b=[],h=0,d=e.length;h<d;h++)b.push("0x"+e[h]);document.getElementById("hostKeyImg").innerHTML=boardToString(generateBoard(b))};var struct={pack:function(e,b){var h="";switch(e){case "Q":e=new BigInteger("ff",16);h+=String.fromCharCode(b.shiftRight(56).and(e));h+=String.fromCharCode(b.shiftRight(48).and(e));h+=String.fromCharCode(b.shiftRight(40).and(e));h+=String.fromCharCode(b.shiftRight(32).and(e));h+=String.fromCharCode(b.shiftRight(24).and(e));h+=String.fromCharCode(b.shiftRight(16).and(e));h+=String.fromCharCode(b.shiftRight(8).and(e));h+=String.fromCharCode(b.and(e));break;case "I":h+=String.fromCharCode(b>>>24&255),
h+=String.fromCharCode(b>>>16&255),h+=String.fromCharCode(b>>>8&255);case "B":h+=String.fromCharCode(b&255)}return h},unpack:function(e,b){var h=[],d=0,a=0;switch(e){case "Q":a=new BigInteger("0",10);a=a.add((new BigInteger(b.charCodeAt(0).toString(),10)).shiftLeft(56));a=a.add((new BigInteger(b.charCodeAt(1).toString(),10)).shiftLeft(48));a=a.add((new BigInteger(b.charCodeAt(2).toString(),10)).shiftLeft(40));a=a.add((new BigInteger(b.charCodeAt(3).toString(),10)).shiftLeft(32));a=a.add((new BigInteger(b.charCodeAt(4).toString(),
10)).shiftLeft(24));a=a.add((new BigInteger(b.charCodeAt(5).toString(),10)).shiftLeft(16));a=a.add((new BigInteger(b.charCodeAt(6).toString(),10)).shiftLeft(8));a=a.add((new BigInteger(b.charCodeAt(7).toString(),10)).shiftLeft(0));h.push(a);break;case "I":a+=b.charCodeAt(0)<<24>>>0,a+=b.charCodeAt(1)<<16>>>0,a+=b.charCodeAt(2)<<8>>>0,d+=3;case "B":a+=b.charCodeAt(0+d)<<0>>>0,h.push(a)}return h}};function inflate_long(e){var b=new BigInteger("0",10);e.length%4&&(e=Array(4-e.length%4+1).join("\x00")+e);for(var h=0;h<e.length;h+=4)b=b.shiftLeft(32),b=b.add(new BigInteger(struct.unpack("I",e.substring(h,h+4))[0].toString(),10));return b}
function deflate_long(e,b){e="number"==typeof e?new BigInteger(e.toString(),10):e.clone();b=void 0==b?!0:b;for(var h="",d=new BigInteger("-1",10),a=new BigInteger("ffffffff",16);!e.equals(BigInteger.ZERO)&&!e.equals(d);)h=struct.pack("I",e.and(a))+h,e=e.shiftRight(32);a=!1;for(var c=0;c<h.length;++c){if(e.equals(BigInteger.ZERO)&&"\x00"!=h.charAt(c)){a=!0;break}if(e.equals(d)&&"\u00ff"!=h.charAt(c)){a=!0;break}}a||(c=0,h=e.equals(BigInteger.ZERO)?"\x00":"\u00ff");h=h.substring(c);b&&(e.equals(BigInteger.ZERO)&&
128<=h.charCodeAt(0)&&(h="\x00"+h),e.equals(d)&&128>h.charCodeAt(0)&&(h="\u00ff"+h));return h}function toByteArray(e){for(var b=new Uint8Array(e.length),h=0;h<e.length;h++)b[h]=e.charCodeAt(h);return b}function fromByteArray(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function bytesToWords(e){for(var b=[],h=0,d=0;h<e.length;h++,d+=8)b[d>>>5]|=(e[h]&255)<<24-d%32;return b}function wordsToBytes(e){for(var b=[],h=0;h<32*e.length;h+=8)b.push(e[h>>>5]>>>24-h%32&255);return b}
function setCharAt(e,b,h){return e.substring(0,b)+h+e.substring(b+1)}function fromUtf8(e){for(var b="",h=toByteArray(e),d=0;d<e.length;d++){var a=e.charCodeAt(d);if(192<=a&&223>=a){var c=h[++d];a=(a&31)<<6|c&63}else if(224<=a&&239>=a){c=h[++d];var k=h[++d];a=(a&15)<<12|(c&63)<<6|k&63}else 128<=a&&(a=".");b+=String.fromCharCode(a)}return b}function read_rng(e){return String.fromCharCode.apply(null,window.crypto.getRandomValues(new Uint8Array(e)))}
function filter(e,b){e=e.split(",");for(var h=0;h<e.length;++h)if(-1!=b.indexOf(e[h]))return e[h]}function splitSlice(e,b){b=void 0===b?5E3:b;for(var h=[],d=0,a=e.length;d<a;d+=b)h.push(e.slice(d,b+d));return h}function modColorPercent(e,b){var h=parseInt(e.slice(1),16);e=0>b?0:255;b=0>b?-1*b:b;var d=h>>16,a=h>>8&255;h&=255;return"#"+(16777216+65536*(Math.round((e-d)*b)+d)+256*(Math.round((e-a)*b)+a)+(Math.round((e-h)*b)+h)).toString(16).slice(1)}
function ascii2hex(e){for(var b="",h=0;h<e.length;h++)b=1==e.charCodeAt(h).toString(16).length?b+("0"+e.charCodeAt(h).toString(16)):b+(""+e.charCodeAt(h).toString(16));return b}function termBackspace(e){e.write("\b");e.eraseRight(e.buffers._terminal.buffer.x-1,e.buffers._terminal.buffer.y)};!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Terminal=e()}(function(){return function a(b,h,d){function c(m,q){if(!h[m]){if(!b[m]){var l="function"==typeof require&&require;if(!q&&l)return l(m,!0);if(k)return k(m,!0);q=Error("Cannot find module '"+m+"'");throw q.code="MODULE_NOT_FOUND",q;}q=h[m]={exports:{}};
b[m][0].call(q.exports,function(a){return c(b[m][1][a]||a)},q,q.exports,a,b,h,d)}return h[m].exports}for(var k="function"==typeof require&&require,m=0;m<d.length;m++)c(d[m]);return c}({1:[function(b,h,d){function a(a,b){var f=k.call(this)||this;f._terminal=a;f._dimensions=b;f._liveRegionLineCount=0;f._charsToConsume=[];f._charsToAnnounce="";f._accessibilityTreeRoot=document.createElement("div");f._accessibilityTreeRoot.classList.add("xterm-accessibility");f._rowContainer=document.createElement("div");
f._rowContainer.classList.add("xterm-accessibility-tree");f._rowElements=[];for(a=0;a<f._terminal.rows;a++)f._rowElements[a]=f._createAccessibilityTreeNode(),f._rowContainer.appendChild(f._rowElements[a]);return f._topBoundaryFocusListener=function(a){return f._onBoundaryFocus(a,0)},f._bottomBoundaryFocusListener=function(a){return f._onBoundaryFocus(a,1)},f._rowElements[0].addEventListener("focus",f._topBoundaryFocusListener),f._rowElements[f._rowElements.length-1].addEventListener("focus",f._bottomBoundaryFocusListener),
f._refreshRowsDimensions(),f._accessibilityTreeRoot.appendChild(f._rowContainer),f._renderRowsDebouncer=new q.RenderDebouncer(f._renderRows.bind(f)),f._refreshRows(),f._liveRegion=document.createElement("div"),f._liveRegion.classList.add("live-region"),f._liveRegion.setAttribute("aria-live","assertive"),f._accessibilityTreeRoot.appendChild(f._liveRegion),f._terminal.element.insertAdjacentElement("afterbegin",f._accessibilityTreeRoot),f.register(f._renderRowsDebouncer),f.register(f._terminal.onResize(function(a){return f._onResize(a.rows)})),
f.register(f._terminal.onRender(function(a){return f._refreshRows(a.start,a.end)})),f.register(f._terminal.onScroll(function(){return f._refreshRows()})),f.register(f._terminal.addDisposableListener("a11y.char",function(a){return f._onChar(a)})),f.register(f._terminal.onLineFeed(function(){return f._onChar("\n")})),f.register(f._terminal.addDisposableListener("a11y.tab",function(a){return f._onTab(a)})),f.register(f._terminal.onKey(function(a){return f._onKey(a.key)})),f.register(f._terminal.addDisposableListener("blur",
function(){return f._clearLiveRegion()})),f._screenDprMonitor=new g.ScreenDprMonitor,f.register(f._screenDprMonitor),f._screenDprMonitor.setListener(function(){return f._refreshRowsDimensions()}),f.register(l.addDisposableDomListener(window,"resize",function(){return f._refreshRowsDimensions()})),f}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var g in b)b.hasOwnProperty(g)&&(a[g]=b[g])})(a,
b)},function(a,b){function g(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(g.prototype=b.prototype,new g)});Object.defineProperty(d,"__esModule",{value:!0});var k,m=b("./Strings"),p=b("./common/Platform"),q=b("./ui/RenderDebouncer"),l=b("./ui/Lifecycle"),f=b("./common/Lifecycle"),g=b("./ui/ScreenDprMonitor");b=(k=f.Disposable,h(a,k),a.prototype.dispose=function(){k.prototype.dispose.call(this);this._terminal.element.removeChild(this._accessibilityTreeRoot);this._rowElements.length=
0},a.prototype._onBoundaryFocus=function(a,b){var g=a.target,f=this._rowElements[0===b?1:this._rowElements.length-2];if(g.getAttribute("aria-posinset")!==(0===b?"1":""+this._terminal.buffer.lines.length)&&a.relatedTarget===f){var n,c;(0===b?(n=g,c=this._rowElements.pop(),this._rowContainer.removeChild(c)):(n=this._rowElements.shift(),c=g,this._rowContainer.removeChild(n)),n.removeEventListener("focus",this._topBoundaryFocusListener),c.removeEventListener("focus",this._bottomBoundaryFocusListener),
0===b)?(g=this._createAccessibilityTreeNode(),this._rowElements.unshift(g),this._rowContainer.insertAdjacentElement("afterbegin",g)):(g=this._createAccessibilityTreeNode(),this._rowElements.push(g),this._rowContainer.appendChild(g));this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener);this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener);this._terminal.scrollLines(0===b?-1:1);this._rowElements[0===b?1:this._rowElements.length-
2].focus();a.preventDefault();a.stopImmediatePropagation()}},a.prototype._onResize=function(a){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(var b=this._rowContainer.children.length;b<this._terminal.rows;b++)this._rowElements[b]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[b]);for(;this._rowElements.length>a;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-
1].addEventListener("focus",this._bottomBoundaryFocusListener);this._refreshRowsDimensions()},a.prototype._createAccessibilityTreeNode=function(){var a=document.createElement("div");return a.setAttribute("role","listitem"),a.tabIndex=-1,this._refreshRowDimensions(a),a},a.prototype._onTab=function(a){for(var b=0;b<a;b++)this._onChar(" ")},a.prototype._onChar=function(a){var b=this;21>this._liveRegionLineCount&&(0<this._charsToConsume.length?this._charsToConsume.shift()!==a&&(this._charsToAnnounce+=
a):this._charsToAnnounce+=a,"\n"===a&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=m.tooMuchOutput)),p.isMac&&this._liveRegion.textContent&&0<this._liveRegion.textContent.length&&!this._liveRegion.parentNode&&setTimeout(function(){b._accessibilityTreeRoot.appendChild(b._liveRegion)},0))},a.prototype._clearLiveRegion=function(){this._liveRegion.textContent="";this._liveRegionLineCount=0;p.isMac&&this._liveRegion.parentNode&&this._accessibilityTreeRoot.removeChild(this._liveRegion)},
a.prototype._onKey=function(a){this._clearLiveRegion();this._charsToConsume.push(a)},a.prototype._refreshRows=function(a,b){this._renderRowsDebouncer.refresh(a,b,this._terminal.rows)},a.prototype._renderRows=function(a,b){for(var g=this._terminal.buffer,f=g.lines.length.toString();a<=b;a++){var n=g.translateBufferLineToString(g.ydisp+a,!0),c=(g.ydisp+a+1).toString(),l=this._rowElements[a];l&&(l.textContent=0===n.length?m.blankLine:n,l.setAttribute("aria-posinset",c),l.setAttribute("aria-setsize",
f))}this._announceCharacters()},a.prototype._refreshRowsDimensions=function(){if(this._dimensions.actualCellHeight){this._rowElements.length!==this._terminal.rows&&this._onResize(this._terminal.rows);for(var a=0;a<this._terminal.rows;a++)this._refreshRowDimensions(this._rowElements[a])}},a.prototype.setDimensions=function(a){this._dimensions=a;this._refreshRowsDimensions()},a.prototype._refreshRowDimensions=function(a){a.style.height=this._dimensions.actualCellHeight+"px"},a.prototype._announceCharacters=
function(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")},a);d.AccessibilityManager=b},{"./Strings":16,"./common/Lifecycle":24,"./common/Platform":25,"./ui/Lifecycle":59,"./ui/RenderDebouncer":60,"./ui/ScreenDprMonitor":61}],2:[function(b,h,d){function a(a,b){this._terminal=a;this._hasScrollback=b;this.savedCurAttrData=m.DEFAULT_ATTR_DATA.clone();this.markers=[];this._nullCell=m.CellData.fromCharData([0,m.NULL_CELL_CHAR,m.NULL_CELL_WIDTH,
m.NULL_CELL_CODE]);this._whitespaceCell=m.CellData.fromCharData([0,m.WHITESPACE_CELL_CHAR,m.WHITESPACE_CELL_WIDTH,m.WHITESPACE_CELL_CODE]);this._cols=this._terminal.cols;this._rows=this._terminal.rows;this.clear()}function c(a,b,n,c,l,d){void 0===n&&(n=0);void 0===c&&(c=a.lines.length);void 0===l&&(l=0);void 0===d&&(d=0);this._buffer=a;this._trimRight=b;this._startIndex=n;this._endIndex=c;this._startOverscan=l;this._endOverscan=d;0>this._startIndex&&(this._startIndex=0);this._endIndex>this._buffer.lines.length&&
(this._endIndex=this._buffer.lines.length);this._current=this._startIndex}Object.defineProperty(d,"__esModule",{value:!0});var k=b("./common/CircularList"),m=b("./core/buffer/BufferLine"),p=b("./core/buffer/BufferReflow"),q=b("./core/buffer/Marker");d.MAX_BUFFER_SIZE=4294967295;b=(a.prototype.getNullCell=function(a){return a?(this._nullCell.fg=a.fg,this._nullCell.bg=a.bg):(this._nullCell.fg=0,this._nullCell.bg=0),this._nullCell},a.prototype.getWhitespaceCell=function(a){return a?(this._whitespaceCell.fg=
a.fg,this._whitespaceCell.bg=a.bg):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0),this._whitespaceCell},a.prototype.getBlankLine=function(a,b){return new m.BufferLine(this._terminal.cols,this.getNullCell(a),b)},Object.defineProperty(a.prototype,"hasScrollback",{get:function(){return this._hasScrollback&&this.lines.maxLength>this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isCursorInViewport",{get:function(){var a=this.ybase+this.y-this.ydisp;return 0<=a&&a<this._rows},
enumerable:!0,configurable:!0}),a.prototype._getCorrectBufferLength=function(a){if(!this._hasScrollback)return a;a+=this._terminal.options.scrollback;return a>d.MAX_BUFFER_SIZE?d.MAX_BUFFER_SIZE:a},a.prototype.fillViewportRows=function(a){if(0===this.lines.length){void 0===a&&(a=m.DEFAULT_ATTR_DATA);for(var b=this._rows;b--;)this.lines.push(this.getBlankLine(a))}},a.prototype.clear=function(){this.x=this.y=this.ybase=this.ydisp=0;this.lines=new k.CircularList(this._getCorrectBufferLength(this._rows));
this.scrollTop=0;this.scrollBottom=this._rows-1;this.setupTabStops()},a.prototype.resize=function(a,b){var g=this.getNullCell(m.DEFAULT_ATTR_DATA),f=this._getCorrectBufferLength(b);if(f>this.lines.maxLength&&(this.lines.maxLength=f),0<this.lines.length){if(this._cols<a)for(var c=0;c<this.lines.length;c++)this.lines.get(c).resize(a,g);c=0;if(this._rows<b)for(var l=this._rows;l<b;l++)this.lines.length<b+this.ybase&&(0<this.ybase&&this.lines.length<=this.ybase+this.y+c+1?(this.ybase--,c++,0<this.ydisp&&
this.ydisp--):this.lines.push(new m.BufferLine(a,g)));else for(l=this._rows;b<l;l--)this.lines.length>b+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));f<this.lines.maxLength&&(l=this.lines.length-f,0<l&&(this.lines.trimStart(l),this.ybase=Math.max(this.ybase-l,0),this.ydisp=Math.max(this.ydisp-l,0)),this.lines.maxLength=f);this.x=Math.min(this.x,a-1);this.y=Math.min(this.y,b-1);c&&(this.y+=c);this.savedY=Math.min(this.savedY,b-1);this.savedX=Math.min(this.savedX,
a-1);this.scrollTop=0}if(this.scrollBottom=b-1,this._isReflowEnabled&&(this._reflow(a,b),this._cols>a))for(c=0;c<this.lines.length;c++)this.lines.get(c).resize(a,g);this._cols=a;this._rows=b},Object.defineProperty(a.prototype,"_isReflowEnabled",{get:function(){return this._hasScrollback&&!this._terminal.options.windowsMode},enumerable:!0,configurable:!0}),a.prototype._reflow=function(a,b){this._cols!==a&&(a>this._cols?this._reflowLarger(a,b):this._reflowSmaller(a,b))},a.prototype._reflowLarger=function(a,
b){var g=p.reflowLargerGetLinesToRemove(this.lines,this._cols,a,this.ybase+this.y,this.getNullCell(m.DEFAULT_ATTR_DATA));0<g.length&&(g=p.reflowLargerCreateNewLayout(this.lines,g),p.reflowLargerApplyNewLayout(this.lines,g.layout),this._reflowLargerAdjustViewport(a,b,g.countRemoved))},a.prototype._reflowLargerAdjustViewport=function(a,b,n){for(var g=this.getNullCell(m.DEFAULT_ATTR_DATA);0<n--;)0===this.ybase?(0<this.y&&this.y--,this.lines.length<b&&this.lines.push(new m.BufferLine(a,g))):(this.ydisp===
this.ybase&&this.ydisp--,this.ybase--)},a.prototype._reflowSmaller=function(a,b){for(var g=this.getNullCell(m.DEFAULT_ATTR_DATA),f=[],c=0,l=this.lines.length-1;0<=l;l--){var d=this.lines.get(l);if(!(!d||!d.isWrapped&&d.getTrimmedLength()<=a)){for(var k=[d];d.isWrapped&&0<l;)d=this.lines.get(--l),k.unshift(d);d=this.ybase+this.y;if(!(l<=d&&d<l+k.length)){var q=k[k.length-1].getTrimmedLength(),h=p.reflowSmallerGetNewLineLengths(k,this._cols,a),C=h.length-k.length;var x=0===this.ybase&&this.y!==this.lines.length-
1?Math.max(0,this.y-this.lines.maxLength+C):Math.max(0,this.lines.length-this.lines.maxLength+C);var A=[];for(d=0;d<C;d++){var F=this.getBlankLine(m.DEFAULT_ATTR_DATA,!0);A.push(F)}0<A.length&&(f.push({start:l+k.length+c,newLines:A}),c+=A.length);k.push.apply(k,A);d=h.length-1;A=h[d];0===A&&(A=h[--d]);for(F=k.length-C-1;0<=F;){var G=Math.min(q,A);if(k[d].copyCellsFrom(k[F],q-G,A-G,G,!0),0==(A-=G)&&(A=h[--d]),0==(q-=G))F--,q=p.getWrappedLineTrimmedLength(k,Math.max(F,0),this._cols)}for(d=0;d<k.length;d++)h[d]<
a&&k[d].setCell(h[d],g);for(d=C-x;0<d--;)0===this.ybase?this.y<b-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+c)-b&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++)}}}if(0<f.length){a=[];g=[];for(d=0;d<this.lines.length;d++)g.push(this.lines.get(d));b=this.lines.length;l=b-1;k=0;h=f[k];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+c);C=0;for(d=Math.min(this.lines.maxLength-1,b+c-1);0<=d;d--)if(h&&h.start>
l+C){for(x=h.newLines.length-1;0<=x;x--)this.lines.set(d--,h.newLines[x]);d++;a.push({index:l+1,amount:h.newLines.length});C+=h.newLines.length;h=f[++k]}else this.lines.set(d,g[l--]);f=0;for(d=a.length-1;0<=d;d--)a[d].index+=f,this.lines.onInsertEmitter.fire(a[d]),f+=a[d].amount;c=Math.max(0,b+c-this.lines.maxLength);0<c&&this.lines.onTrimEmitter.fire(c)}},a.prototype.stringIndexToBufferIndex=function(a,b,c){for(void 0===c&&(c=!1);b;){var g=this.lines.get(a);if(!g)return[-1,-1];for(var f=c?g.getTrimmedLength():
g.length,n=0;n<f;++n)if(g.get(n)[m.CHAR_DATA_WIDTH_INDEX]&&(b-=g.get(n)[m.CHAR_DATA_CHAR_INDEX].length||1),0>b)return[a,n];a++}return[a,0]},a.prototype.translateBufferLineToString=function(a,b,c,l){void 0===c&&(c=0);return(a=this.lines.get(a))?a.translateToString(b,c,l):""},a.prototype.getWrappedRangeForLine=function(a){for(var b=a;0<b&&this.lines.get(b).isWrapped;)b--;for(;a+1<this.lines.length&&this.lines.get(a+1).isWrapped;)a++;return{first:b,last:a}},a.prototype.setupTabStops=function(a){for(null!=
a?this.tabs[a]||(a=this.prevStop(a)):(this.tabs={},a=0);a<this._cols;a+=this._terminal.options.tabStopWidth)this.tabs[a]=!0},a.prototype.prevStop=function(a){for(null==a&&(a=this.x);!this.tabs[--a]&&0<a;);return a>=this._cols?this._cols-1:0>a?0:a},a.prototype.nextStop=function(a){for(null==a&&(a=this.x);!this.tabs[++a]&&a<this._cols;);return a>=this._cols?this._cols-1:0>a?0:a},a.prototype.addMarker=function(a){var b=this,f=new q.Marker(a);return this.markers.push(f),f.register(this.lines.onTrim(function(a){f.line-=
a;0>f.line&&f.dispose()})),f.register(this.lines.onInsert(function(a){f.line>=a.index&&(f.line+=a.amount)})),f.register(this.lines.onDelete(function(a){f.line>=a.index&&f.line<a.index+a.amount&&f.dispose();f.line>a.index&&(f.line-=a.amount)})),f.register(f.onDispose(function(){return b._removeMarker(f)})),f},a.prototype._removeMarker=function(a){this.markers.splice(this.markers.indexOf(a),1)},a.prototype.iterator=function(a,b,c,d,m){return new l(this,a,b,c,d,m)},a);d.Buffer=b;var l=(c.prototype.hasNext=
function(){return this._current<this._endIndex},c.prototype.next=function(){var a=this._buffer.getWrappedRangeForLine(this._current);a.first<this._startIndex-this._startOverscan&&(a.first=this._startIndex-this._startOverscan);a.last>this._endIndex+this._endOverscan&&(a.last=this._endIndex+this._endOverscan);a.first=Math.max(a.first,0);a.last=Math.min(a.last,this._buffer.lines.length);for(var b="",c=a.first;c<=a.last;++c)b+=this._buffer.translateBufferLineToString(c,this._trimRight);return this._current=
a.last+1,{range:a,content:b}},c);d.BufferStringIterator=l},{"./common/CircularList":20,"./core/buffer/BufferLine":29,"./core/buffer/BufferReflow":30,"./core/buffer/Marker":31}],3:[function(b,h,d){function a(a){this._terminal=a;this._onBufferActivate=new k.EventEmitter2;this._normal=new c.Buffer(this._terminal,!0);this._normal.fillViewportRows();this._alt=new c.Buffer(this._terminal,!1);this._activeBuffer=this._normal;this.setupTabStops()}Object.defineProperty(d,"__esModule",{value:!0});var c=b("./Buffer"),
k=b("./common/EventEmitter2");b=(Object.defineProperty(a.prototype,"onBufferActivate",{get:function(){return this._onBufferActivate.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"alt",{get:function(){return this._alt},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"active",{get:function(){return this._activeBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"normal",{get:function(){return this._normal},enumerable:!0,configurable:!0}),
a.prototype.activateNormalBuffer=function(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))},a.prototype.activateAltBuffer=function(a){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(a),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,
inactiveBuffer:this._normal}))},a.prototype.resize=function(a,b){this._normal.resize(a,b);this._alt.resize(a,b)},a.prototype.setupTabStops=function(a){this._normal.setupTabStops(a);this._alt.setupTabStops(a)},a);d.BufferSet=b},{"./Buffer":2,"./common/EventEmitter2":23}],4:[function(b,h,d){function a(a,b){this._onCharSizeChanged=new c.EventEmitter2;this._document=a;this._parentElement=b;this._measureElement=this._document.createElement("span");this._measureElement.classList.add("xterm-char-measure-element");
this._measureElement.textContent="W";this._measureElement.setAttribute("aria-hidden","true");this._parentElement.appendChild(this._measureElement)}Object.defineProperty(d,"__esModule",{value:!0});var c=b("./common/EventEmitter2");b=(Object.defineProperty(a.prototype,"onCharSizeChanged",{get:function(){return this._onCharSizeChanged.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,
"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),a.prototype.measure=function(a){this._measureElement.style.fontFamily=a.fontFamily;this._measureElement.style.fontSize=a.fontSize+"px";a=this._measureElement.getBoundingClientRect();if(0!==a.width&&0!==a.height){var b=Math.ceil(a.height);this._width===a.width&&this._height===b||(this._width=a.width,this._height=b,this._onCharSizeChanged.fire())}},a);d.CharMeasure=b},{"./common/EventEmitter2":23}],5:[function(b,h,d){Object.defineProperty(d,
"__esModule",{value:!0});var a=b("./common/TypedArrayUtils");d.wcwidth=function(b){var c=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,
2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,
3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,
8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],d=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],h=0|b.control,q=new Uint8Array(65536);a.fill(q,1);q[0]=b.nul;a.fill(q,b.control,1,32);a.fill(q,b.control,127,160);a.fill(q,2,4352,4448);q[9001]=2;q[9002]=
2;a.fill(q,2,11904,42192);q[12351]=1;a.fill(q,2,44032,55204);a.fill(q,2,63744,64256);a.fill(q,2,65040,65050);a.fill(q,2,65072,65136);a.fill(q,2,65280,65377);a.fill(q,2,65504,65511);for(b=0;b<c.length;++b)a.fill(q,0,c[b][0],c[b][1]+1);return function(a){if(32>a)a=0|h;else if(127>a)a=1;else if(65536>a)a=q[a];else{var b;a:{var g=0,c=d.length-1;if(!(a<d[0][0]||a>d[c][1]))for(;g<=c;)if(a>d[b=g+c>>1][1])g=1+b;else{if(!(a<d[b][0])){b=!0;break a}c=b-1}b=!1}a=b?0:131072<=a&&196605>=a||196608<=a&&262141>=a?
2:1}return a}}({nul:0,control:0});d.getStringCellWidth=function(a){for(var b=0,c=a.length,h=0;h<c;++h){var q=a.charCodeAt(h);if(55296<=q&&56319>=q){if(++h>=c)return b+d.wcwidth(q);var l=a.charCodeAt(h);56320<=l&&57343>=l?q=1024*(q-55296)+l-56320+65536:b+=d.wcwidth(l)}b+=d.wcwidth(q)}return b}},{"./common/TypedArrayUtils":26}],6:[function(b,h,d){function a(a){return a.replace(/\r?\n/g,"\r")}function c(a,b){return b?"\u001b[200~"+a+"\u001b[201~":a}function k(a,b){var c=b.screenElement.getBoundingClientRect(),
d=a.clientX-c.left-10;a=a.clientY-c.top-10;b.textarea.style.position="absolute";b.textarea.style.width="20px";b.textarea.style.height="20px";b.textarea.style.left=d+"px";b.textarea.style.top=a+"px";b.textarea.style.zIndex="1000";b.textarea.focus();setTimeout(function(){b.textarea.style.position=null;b.textarea.style.width=null;b.textarea.style.height=null;b.textarea.style.left=null;b.textarea.style.top=null;b.textarea.style.zIndex=null},200)}Object.defineProperty(d,"__esModule",{value:!0});d.prepareTextForTerminal=
a;d.bracketTextForPaste=c;d.copyHandler=function(a,b,c){b.browser.isMSIE?window.clipboardData.setData("Text",c.selectionText):a.clipboardData.setData("text/plain",c.selectionText);a.preventDefault()};d.pasteHandler=function(b,d){function k(l){l=c(l=a(l),d.bracketedPasteMode);d.handler(l);d.textarea.value="";d.emit("paste",l);d.cancel(b)}b.stopPropagation();d.browser.isMSIE?window.clipboardData&&k(window.clipboardData.getData("Text")):b.clipboardData&&k(b.clipboardData.getData("text/plain"))};d.moveTextAreaUnderMouseCursor=
k;d.rightClickHandler=function(a,b,c,d){k(a,b);d&&!c.isClickInSelection(a)&&c.selectWordAtCursor(a);b.textarea.value=c.selectionText;b.textarea.select()}},{}],7:[function(b,h,d){function a(a,b,d){this._textarea=a;this._compositionView=b;this._terminal=d;this._isSendingComposition=this._isComposing=!1;this._compositionPosition={start:null,end:null}}Object.defineProperty(d,"__esModule",{value:!0});b=(a.prototype.compositionstart=function(){this._isComposing=!0;this._compositionPosition.start=this._textarea.value.length;
this._compositionView.textContent="";this._compositionView.classList.add("active")},a.prototype.compositionupdate=function(a){var b=this;this._compositionView.textContent=a.data;this.updateCompositionElements();setTimeout(function(){b._compositionPosition.end=b._textarea.value.length},0)},a.prototype.compositionend=function(){this._finalizeComposition(!0)},a.prototype.keydown=function(a){if(this._isComposing||this._isSendingComposition){if(229===a.keyCode||16===a.keyCode||17===a.keyCode||18===a.keyCode)return!1;
this._finalizeComposition(!1)}return 229!==a.keyCode||(this._handleAnyTextareaChanges(),!1)},a.prototype._finalizeComposition=function(a){var b=this;if(this._compositionView.classList.remove("active"),this._isComposing=!1,this._clearTextareaPosition(),a){var c=this._compositionPosition.start,d=this._compositionPosition.end;this._isSendingComposition=!0;setTimeout(function(){if(b._isSendingComposition){b._isSendingComposition=!1;var a=b._isComposing?b._textarea.value.substring(c,d):b._textarea.value.substring(c);
b._terminal.handler(a)}},0)}else this._isSendingComposition=!1,a=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end),this._terminal.handler(a)},a.prototype._handleAnyTextareaChanges=function(){var a=this,b=this._textarea.value;setTimeout(function(){if(!a._isComposing){var c=a._textarea.value.replace(b,"");0<c.length&&a._terminal.handler(c)}},0)},a.prototype.updateCompositionElements=function(a){var b=this;if(this._isComposing){if(this._terminal.buffer.isCursorInViewport){var c=
Math.ceil(this._terminal.charMeasure.height*this._terminal.options.lineHeight),d=this._terminal.buffer.y*c,q=this._terminal.buffer.x*this._terminal.charMeasure.width;this._compositionView.style.left=q+"px";this._compositionView.style.top=d+"px";this._compositionView.style.height=c+"px";this._compositionView.style.lineHeight=c+"px";this._compositionView.style.fontFamily=this._terminal.options.fontFamily;this._compositionView.style.fontSize=this._terminal.options.fontSize+"px";c=this._compositionView.getBoundingClientRect();
this._textarea.style.left=q+"px";this._textarea.style.top=d+"px";this._textarea.style.width=c.width+"px";this._textarea.style.height=c.height+"px";this._textarea.style.lineHeight=c.height+"px"}a||setTimeout(function(){return b.updateCompositionElements(!0)},0)}},a.prototype._clearTextareaPosition=function(){this._textarea.style.left="";this._textarea.style.top=""},a);d.CompositionHelper=b},{}],8:[function(b,h,d){function a(a,b){a=b-a;for(var g=Array(a);a--;)g[a]=--b;return g}function c(a){this.table=
"undefined"==typeof Uint8Array?Array(a):new Uint8Array(a)}function k(){}function m(a){void 0===a&&(a=d.VT500_TRANSITION_TABLE);var b=r.call(this)||this;return b.TRANSITIONS=a,b.initialState=0,b.currentState=b.initialState,b._osc="",b._params=[0],b._collect="",b._printHandlerFb=function(a,b,g){},b._executeHandlerFb=function(a){},b._csiHandlerFb=function(a,b,g){},b._escHandlerFb=function(a,b){},b._oscHandlerFb=function(a,b){},b._dcsHandlerFb=new u,b._errorHandlerFb=function(a){return a},b._printHandler=
b._printHandlerFb,b._executeHandlers=Object.create(null),b._csiHandlers=Object.create(null),b._escHandlers=Object.create(null),b._oscHandlers=Object.create(null),b._dcsHandlers=Object.create(null),b._activeDcsHandler=null,b._errorHandler=b._errorHandlerFb,b.setEscHandler("\\",function(){}),b}var p;h=this&&this.__extends||(p=function(a,b){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var g in b)b.hasOwnProperty(g)&&(a[g]=b[g])})(a,b)},
function(a,b){function g(){this.constructor=a}p(a,b);a.prototype=null===b?Object.create(b):(g.prototype=b.prototype,new g)});Object.defineProperty(d,"__esModule",{value:!0});var q=b("./common/Lifecycle"),l=b("./core/input/TextDecoder"),f=(c.prototype.add=function(a,b,g,f){this.table[b<<8|a]=(0|g)<<4|(void 0===f?b:f)},c.prototype.addMany=function(a,b,g,f){for(var c=0;c<a.length;c++)this.add(a[c],b,g,f)},c);d.TransitionTable=f;var g=a(32,127),n=a(0,24);n.push(25);n.push.apply(n,a(28,32));d.VT500_TRANSITION_TABLE=
function(){var b,c=new f(4095),d=a(0,14);for(b in d)for(var l=0;160>=l;++l)c.add(l,b,1,0);for(b in c.addMany(g,0,2,0),d)c.addMany([24,26,153,154],b,3,0),c.addMany(a(128,144),b,3,0),c.addMany(a(144,152),b,3,0),c.add(156,b,0,0),c.add(27,b,11,1),c.add(157,b,4,8),c.addMany([152,158,159],b,0,7),c.add(155,b,11,3),c.add(144,b,11,9);return c.addMany(n,0,3,0),c.addMany(n,1,3,1),c.add(127,1,0,1),c.addMany(n,8,0,8),c.addMany(n,3,3,3),c.add(127,3,0,3),c.addMany(n,4,3,4),c.add(127,4,0,4),c.addMany(n,6,3,6),c.addMany(n,
5,3,5),c.add(127,5,0,5),c.addMany(n,2,3,2),c.add(127,2,0,2),c.add(93,1,4,8),c.addMany(g,8,5,8),c.add(127,8,5,8),c.addMany([156,27,24,26,7],8,6,0),c.addMany(a(28,32),8,0,8),c.addMany([88,94,95],1,0,7),c.addMany(g,7,0,7),c.addMany(n,7,0,7),c.add(156,7,0,0),c.add(127,7,0,7),c.add(91,1,11,3),c.addMany(a(64,127),3,7,0),c.addMany(a(48,58),3,8,4),c.add(59,3,8,4),c.addMany([60,61,62,63],3,9,4),c.addMany(a(48,58),4,8,4),c.add(59,4,8,4),c.addMany(a(64,127),4,7,0),c.addMany([58,60,61,62,63],4,0,6),c.addMany(a(32,
64),6,0,6),c.add(127,6,0,6),c.addMany(a(64,127),6,0,0),c.add(58,3,0,6),c.addMany(a(32,48),3,9,5),c.addMany(a(32,48),5,9,5),c.addMany(a(48,64),5,0,6),c.addMany(a(64,127),5,7,0),c.addMany(a(32,48),4,9,5),c.addMany(a(32,48),1,9,2),c.addMany(a(32,48),2,9,2),c.addMany(a(48,127),2,10,0),c.addMany(a(48,80),1,10,0),c.addMany(a(81,88),1,10,0),c.addMany([89,90,92],1,10,0),c.addMany(a(96,127),1,10,0),c.add(80,1,11,9),c.addMany(n,9,0,9),c.add(127,9,0,9),c.addMany(a(28,32),9,0,9),c.addMany(a(32,48),9,9,12),c.add(58,
9,0,11),c.addMany(a(48,58),9,8,10),c.add(59,9,8,10),c.addMany([60,61,62,63],9,9,10),c.addMany(n,11,0,11),c.addMany(a(32,128),11,0,11),c.addMany(a(28,32),11,0,11),c.addMany(n,10,0,10),c.add(127,10,0,10),c.addMany(a(28,32),10,0,10),c.addMany(a(48,58),10,8,10),c.add(59,10,8,10),c.addMany([58,60,61,62,63],10,0,11),c.addMany(a(32,48),10,9,12),c.addMany(n,12,0,12),c.add(127,12,0,12),c.addMany(a(28,32),12,0,12),c.addMany(a(32,48),12,9,12),c.addMany(a(48,64),12,0,11),c.addMany(a(64,127),12,12,13),c.addMany(a(64,
127),10,12,13),c.addMany(a(64,127),9,12,13),c.addMany(n,13,13,13),c.addMany(g,13,13,13),c.add(127,13,0,13),c.addMany([27,156],13,14,0),c.add(160,8,5,8),c}();var u=(k.prototype.hook=function(a,b,g){},k.prototype.put=function(a,b,g){},k.prototype.unhook=function(){},k),r;b=(r=q.Disposable,h(m,r),m.prototype.dispose=function(){this._errorHandler=this._activeDcsHandler=this._dcsHandlers=this._oscHandlers=this._csiHandlers=this._escHandlers=this._executeHandlers=this._printHandler=this._errorHandlerFb=
this._dcsHandlerFb=this._oscHandlerFb=this._escHandlerFb=this._csiHandlerFb=this._executeHandlerFb=this._printHandlerFb=null},m.prototype.setPrintHandler=function(a){this._printHandler=a},m.prototype.clearPrintHandler=function(){this._printHandler=this._printHandlerFb},m.prototype.setExecuteHandler=function(a,b){this._executeHandlers[a.charCodeAt(0)]=b},m.prototype.clearExecuteHandler=function(a){this._executeHandlers[a.charCodeAt(0)]&&delete this._executeHandlers[a.charCodeAt(0)]},m.prototype.setExecuteHandlerFallback=
function(a){this._executeHandlerFb=a},m.prototype.addCsiHandler=function(a,b){a=a.charCodeAt(0);void 0===this._csiHandlers[a]&&(this._csiHandlers[a]=[]);var g=this._csiHandlers[a];return g.push(b),{dispose:function(){var a=g.indexOf(b);-1!==a&&g.splice(a,1)}}},m.prototype.setCsiHandler=function(a,b){this._csiHandlers[a.charCodeAt(0)]=[b]},m.prototype.clearCsiHandler=function(a){this._csiHandlers[a.charCodeAt(0)]&&delete this._csiHandlers[a.charCodeAt(0)]},m.prototype.setCsiHandlerFallback=function(a){this._csiHandlerFb=
a},m.prototype.setEscHandler=function(a,b){this._escHandlers[a]=b},m.prototype.clearEscHandler=function(a){this._escHandlers[a]&&delete this._escHandlers[a]},m.prototype.setEscHandlerFallback=function(a){this._escHandlerFb=a},m.prototype.addOscHandler=function(a,b){void 0===this._oscHandlers[a]&&(this._oscHandlers[a]=[]);var g=this._oscHandlers[a];return g.push(b),{dispose:function(){var a=g.indexOf(b);-1!==a&&g.splice(a,1)}}},m.prototype.setOscHandler=function(a,b){this._oscHandlers[a]=[b]},m.prototype.clearOscHandler=
function(a){this._oscHandlers[a]&&delete this._oscHandlers[a]},m.prototype.setOscHandlerFallback=function(a){this._oscHandlerFb=a},m.prototype.setDcsHandler=function(a,b){this._dcsHandlers[a]=b},m.prototype.clearDcsHandler=function(a){this._dcsHandlers[a]&&delete this._dcsHandlers[a]},m.prototype.setDcsHandlerFallback=function(a){this._dcsHandlerFb=a},m.prototype.setErrorHandler=function(a){this._errorHandler=a},m.prototype.clearErrorHandler=function(){this._errorHandler=this._errorHandlerFb},m.prototype.reset=
function(){this.currentState=this.initialState;this._osc="";this._params=[0];this._collect="";this._activeDcsHandler=null},m.prototype.parse=function(a,b){for(var g=0,f,c=!1,d=this.currentState,n=-1,k=-1,q=this._osc,m=this._collect,u=this._params,h=this.TRANSITIONS.table,r=this._activeDcsHandler,p=null,t=0;t<b;++t)if(g=a[t],0===d&&31<g&&128>g){for(n=~n?n:t;++t<b&&31<a[t]&&128>a[t];);t--}else if(4===d&&47<g&&57>g)u[u.length-1]=10*u[u.length-1]+g-48;else{switch((f=h[d<<8|(160>g?g:160)])>>4){case 2:n=
~n?n:t;break;case 3:~n&&(this._printHandler(a,n,t),n=-1);(p=this._executeHandlers[g])?p():this._executeHandlerFb(g);break;case 0:~n?(this._printHandler(a,n,t),n=-1):~k&&(r.put(a,k,t),k=-1);break;case 1:if(159<g)switch(d){case 0:n=~n?n:t;break;case 6:f|=6;break;case 11:f|=11;break;case 13:k=~k?k:t;f|=13;break;default:c=!0}else c=!0;if(c){if(this._errorHandler({position:t,code:g,currentState:d,print:n,dcs:k,osc:q,collect:m,params:u,abort:!1}).abort)return;c=!1}break;case 7:for(var z=(d=this._csiHandlers[g])?
d.length-1:-1;0<=z&&!1===d[z](u,m);z--);0>z&&this._csiHandlerFb(m,u,g);break;case 8:59===g?u.push(0):u[u.length-1]=10*u[u.length-1]+g-48;break;case 9:m+=String.fromCharCode(g);break;case 10:(p=this._escHandlers[m+String.fromCharCode(g)])?p(m,g):this._escHandlerFb(m,g);break;case 11:~n&&(this._printHandler(a,n,t),n=-1);u=[0];m=q="";k=-1;break;case 12:(r=(r=this._dcsHandlers[m+String.fromCharCode(g)])||this._dcsHandlerFb).hook(m,u,g);break;case 13:k=~k?k:t;break;case 14:r&&(~k&&r.put(a,k,t),r.unhook(),
r=null);27===g&&(f|=1);u=[0];m=q="";k=-1;break;case 4:~n&&(this._printHandler(a,n,t),n=-1);q="";break;case 5:for(d=t+1;;d++)if(b<=d||32>(g=a[d])||127<g&&159>=g){q+=l.utf32ToString(a,t,d);t=d-1;break}break;case 6:if(q&&24!==g&&26!==g)if(m=q.indexOf(";"),-1===m)this._oscHandlerFb(-1,q);else{k=parseInt(q.substring(0,m));q=q.substring(m+1);for(u=(m=this._oscHandlers[k])?m.length-1:-1;0<=u&&!1===m[u](q);u--);0>u&&this._oscHandlerFb(k,q)}27===g&&(f|=1);u=[0];m=q="";k=-1}d=15&f}0===d&&~n?this._printHandler(a,
n,b):13===d&&~k&&r&&r.put(a,k,b);this._osc=q;this._collect=m;this._params=u;this._activeDcsHandler=r;this.currentState=d},m);d.EscapeSequenceParser=b},{"./common/Lifecycle":24,"./core/input/TextDecoder":34}],9:[function(b,h,d){function a(a){this._terminal=a;this._data=new Uint32Array(0)}function c(a,b){function g(a){c._parser.setEscHandler("("+a,function(){return f.selectCharset("("+a)});c._parser.setEscHandler(")"+a,function(){return f.selectCharset(")"+a)});c._parser.setEscHandler("*"+a,function(){return f.selectCharset("*"+
a)});c._parser.setEscHandler("+"+a,function(){return f.selectCharset("+"+a)});c._parser.setEscHandler("-"+a,function(){return f.selectCharset("-"+a)});c._parser.setEscHandler("."+a,function(){return f.selectCharset("."+a)});c._parser.setEscHandler("/"+a,function(){return f.selectCharset("/"+a)})}void 0===b&&(b=new l.EscapeSequenceParser);var f=y.call(this)||this;f._terminal=a;f._parser=b;f._parseBuffer=new Uint32Array(4096);f._stringDecoder=new n.StringToUtf32;f._utf8Decoder=new n.Utf8ToUtf32;f._workCell=
new u.CellData;f._onCursorMove=new r.EventEmitter2;f._onData=new r.EventEmitter2;f._onLineFeed=new r.EventEmitter2;f._onScroll=new r.EventEmitter2;f.register(f._parser);f._parser.setCsiHandlerFallback(function(a,b,g){f._terminal.error("Unknown CSI code: ",{collect:a,params:b,flag:String.fromCharCode(g)})});f._parser.setEscHandlerFallback(function(a,b){f._terminal.error("Unknown ESC code: ",{collect:a,flag:String.fromCharCode(b)})});f._parser.setExecuteHandlerFallback(function(a){f._terminal.error("Unknown EXECUTE code: ",
{code:a})});f._parser.setOscHandlerFallback(function(a,b){f._terminal.error("Unknown OSC code: ",{identifier:a,data:b})});f._parser.setPrintHandler(function(a,b,g){return f.print(a,b,g)});f._parser.setCsiHandler("@",function(a,b){return f.insertChars(a)});f._parser.setCsiHandler("A",function(a,b){return f.cursorUp(a)});f._parser.setCsiHandler("B",function(a,b){return f.cursorDown(a)});f._parser.setCsiHandler("C",function(a,b){return f.cursorForward(a)});f._parser.setCsiHandler("D",function(a,b){return f.cursorBackward(a)});
f._parser.setCsiHandler("E",function(a,b){return f.cursorNextLine(a)});f._parser.setCsiHandler("F",function(a,b){return f.cursorPrecedingLine(a)});f._parser.setCsiHandler("G",function(a,b){return f.cursorCharAbsolute(a)});f._parser.setCsiHandler("H",function(a,b){return f.cursorPosition(a)});f._parser.setCsiHandler("I",function(a,b){return f.cursorForwardTab(a)});f._parser.setCsiHandler("J",function(a,b){return f.eraseInDisplay(a)});f._parser.setCsiHandler("K",function(a,b){return f.eraseInLine(a)});
f._parser.setCsiHandler("L",function(a,b){return f.insertLines(a)});f._parser.setCsiHandler("M",function(a,b){return f.deleteLines(a)});f._parser.setCsiHandler("P",function(a,b){return f.deleteChars(a)});f._parser.setCsiHandler("S",function(a,b){return f.scrollUp(a)});f._parser.setCsiHandler("T",function(a,b){return f.scrollDown(a,b)});f._parser.setCsiHandler("X",function(a,b){return f.eraseChars(a)});f._parser.setCsiHandler("Z",function(a,b){return f.cursorBackwardTab(a)});f._parser.setCsiHandler("`",
function(a,b){return f.charPosAbsolute(a)});f._parser.setCsiHandler("a",function(a,b){return f.hPositionRelative(a)});f._parser.setCsiHandler("b",function(a,b){return f.repeatPrecedingCharacter(a)});f._parser.setCsiHandler("c",function(a,b){return f.sendDeviceAttributes(a,b)});f._parser.setCsiHandler("d",function(a,b){return f.linePosAbsolute(a)});f._parser.setCsiHandler("e",function(a,b){return f.vPositionRelative(a)});f._parser.setCsiHandler("f",function(a,b){return f.hVPosition(a)});f._parser.setCsiHandler("g",
function(a,b){return f.tabClear(a)});f._parser.setCsiHandler("h",function(a,b){return f.setMode(a,b)});f._parser.setCsiHandler("l",function(a,b){return f.resetMode(a,b)});f._parser.setCsiHandler("m",function(a,b){return f.charAttributes(a)});f._parser.setCsiHandler("n",function(a,b){return f.deviceStatus(a,b)});f._parser.setCsiHandler("p",function(a,b){return f.softReset(a,b)});f._parser.setCsiHandler("q",function(a,b){return f.setCursorStyle(a,b)});f._parser.setCsiHandler("r",function(a,b){return f.setScrollRegion(a,
b)});f._parser.setCsiHandler("s",function(a,b){return f.saveCursor(a)});f._parser.setCsiHandler("u",function(a,b){return f.restoreCursor(a)});f._parser.setExecuteHandler(m.C0.BEL,function(){return f.bell()});f._parser.setExecuteHandler(m.C0.LF,function(){return f.lineFeed()});f._parser.setExecuteHandler(m.C0.VT,function(){return f.lineFeed()});f._parser.setExecuteHandler(m.C0.FF,function(){return f.lineFeed()});f._parser.setExecuteHandler(m.C0.CR,function(){return f.carriageReturn()});f._parser.setExecuteHandler(m.C0.BS,
function(){return f.backspace()});f._parser.setExecuteHandler(m.C0.HT,function(){return f.tab()});f._parser.setExecuteHandler(m.C0.SO,function(){return f.shiftOut()});f._parser.setExecuteHandler(m.C0.SI,function(){return f.shiftIn()});f._parser.setExecuteHandler(m.C1.IND,function(){return f.index()});f._parser.setExecuteHandler(m.C1.NEL,function(){return f.nextLine()});f._parser.setExecuteHandler(m.C1.HTS,function(){return f.tabSet()});f._parser.setOscHandler(0,function(a){return f.setTitle(a)});
f._parser.setOscHandler(2,function(a){return f.setTitle(a)});f._parser.setEscHandler("7",function(){return f.saveCursor([])});f._parser.setEscHandler("8",function(){return f.restoreCursor([])});f._parser.setEscHandler("D",function(){return f.index()});f._parser.setEscHandler("E",function(){return f.nextLine()});f._parser.setEscHandler("H",function(){return f.tabSet()});f._parser.setEscHandler("M",function(){return f.reverseIndex()});f._parser.setEscHandler("=",function(){return f.keypadApplicationMode()});
f._parser.setEscHandler(">",function(){return f.keypadNumericMode()});f._parser.setEscHandler("c",function(){return f.reset()});f._parser.setEscHandler("n",function(){return f.setgLevel(2)});f._parser.setEscHandler("o",function(){return f.setgLevel(3)});f._parser.setEscHandler("|",function(){return f.setgLevel(3)});f._parser.setEscHandler("}",function(){return f.setgLevel(2)});f._parser.setEscHandler("~",function(){return f.setgLevel(1)});f._parser.setEscHandler("%@",function(){return f.selectDefaultCharset()});
f._parser.setEscHandler("%G",function(){return f.selectDefaultCharset()});var c=this,d;for(d in p.CHARSETS)g(d);return f._parser.setErrorHandler(function(a){return f._terminal.error("Parsing error: ",a),a}),f._parser.setDcsHandler("$q",new t(f._terminal)),f}var k;h=this&&this.__extends||(k=function(a,b){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var g in b)b.hasOwnProperty(g)&&(a[g]=b[g])})(a,b)},function(a,b){function g(){this.constructor=
a}k(a,b);a.prototype=null===b?Object.create(b):(g.prototype=b.prototype,new g)});Object.defineProperty(d,"__esModule",{value:!0});var m=b("./common/data/EscapeSequences"),p=b("./core/data/Charsets"),q=b("./CharWidth"),l=b("./EscapeSequenceParser"),f=b("./common/Lifecycle"),g=b("./common/TypedArrayUtils"),n=b("./core/input/TextDecoder"),u=b("./core/buffer/BufferLine"),r=b("./common/EventEmitter2"),z={"(":0,")":1,"*":2,"+":3,"-":1,".":2},t=(a.prototype.hook=function(a,b,g){this._data=new Uint32Array(0)},
a.prototype.put=function(a,b,f){this._data=g.concat(this._data,a.subarray(b,f))},a.prototype.unhook=function(){var a=n.utf32ToString(this._data);switch(this._data=new Uint32Array(0),a){case '"q':return this._terminal.handler(m.C0.ESC+'P1$r0"q'+m.C0.ESC+"\\");case '"p':return this._terminal.handler(m.C0.ESC+'P1$r61"p'+m.C0.ESC+"\\");case "r":return this._terminal.handler(m.C0.ESC+"P1$r"+(this._terminal.buffer.scrollTop+1+";"+(this._terminal.buffer.scrollBottom+1)+"r")+m.C0.ESC+"\\");case "m":return this._terminal.handler(m.C0.ESC+
"P1$r0m"+m.C0.ESC+"\\");case " q":return a={block:2,underline:4,bar:6}[this._terminal.getOption("cursorStyle")],a-=this._terminal.getOption("cursorBlink"),this._terminal.handler(m.C0.ESC+"P1$r"+a+" q"+m.C0.ESC+"\\");default:this._terminal.error("Unknown DCS $q %s",a),this._terminal.handler(m.C0.ESC+"P0$r"+m.C0.ESC+"\\")}},a),y;b=(y=f.Disposable,h(c,y),Object.defineProperty(c.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,
"onData",{get:function(){return this._onData.event},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!0,configurable:!0}),c.prototype.dispose=function(){y.prototype.dispose.call(this);this._terminal=null},c.prototype.parse=function(a){if(this._terminal){var b=this._terminal.buffer,g=b.x,f=b.y;
this._terminal.debug&&this._terminal.log("data: "+a);this._parseBuffer.length<a.length&&(this._parseBuffer=new Uint32Array(a.length));this._parser.parse(this._parseBuffer,this._stringDecoder.decode(a,this._parseBuffer));(b=this._terminal.buffer).x===g&&b.y===f||this._onCursorMove.fire()}},c.prototype.parseUtf8=function(a){if(this._terminal){var b=this._terminal.buffer,g=b.x,f=b.y;this._terminal.debug&&this._terminal.log("data: "+a);this._parseBuffer.length<a.length&&(this._parseBuffer=new Uint32Array(a.length));
this._parser.parse(this._parseBuffer,this._utf8Decoder.decode(a,this._parseBuffer));(b=this._terminal.buffer).x===g&&b.y===f||this._terminal.emit("cursormove")}},c.prototype.print=function(a,b,g){var f,c=this._terminal.buffer,d=this._terminal.charset,l=this._terminal.options.screenReaderMode,k=this._terminal.cols,m=this._terminal.wraparoundMode,h=this._terminal.insertMode,r=this._terminal.curAttrData,p=c.lines.get(c.y+c.ybase);this._terminal.updateRange(c.y);for(var w=b;w<g;++w){if(f=a[w],b=q.wcwidth(f),
127>f&&d){var t=d[String.fromCharCode(f)];t&&(f=t.charCodeAt(0))}if(l&&this._terminal.emit("a11y.char",n.stringFromCodePoint(f)),b||!c.x){if(c.x+b-1>=k)if(m)c.x=0,c.y++,c.y>c.scrollBottom?(c.y--,this._terminal.scroll(!0)):c.lines.get(c.y).isWrapped=!0,p=c.lines.get(c.y+c.ybase);else if(2===b)continue;if(h&&(p.insertCells(c.x,b,c.getNullCell(r)),2===p.getWidth(k-1)&&p.setCellFromCodePoint(k-1,u.NULL_CELL_CODE,u.NULL_CELL_WIDTH,r.fg,r.bg)),p.setCellFromCodePoint(c.x++,f,b,r.fg,r.bg),0<b)for(;--b;)p.setCellFromCodePoint(c.x++,
0,0,r.fg,r.bg)}else p.getWidth(c.x-1)?p.addCodepointToCell(c.x-1,f):p.addCodepointToCell(c.x-2,f)}this._terminal.updateRange(c.y)},c.prototype.addCsiHandler=function(a,b){return this._parser.addCsiHandler(a,b)},c.prototype.addOscHandler=function(a,b){return this._parser.addOscHandler(a,b)},c.prototype.bell=function(){this._terminal.bell()},c.prototype.lineFeed=function(){var a=this._terminal.buffer;this._terminal.options.convertEol&&(a.x=0);a.y++;a.y>a.scrollBottom&&(a.y--,this._terminal.scroll());
a.x>=this._terminal.cols&&a.x--;this._onLineFeed.fire()},c.prototype.carriageReturn=function(){this._terminal.buffer.x=0},c.prototype.backspace=function(){0<this._terminal.buffer.x&&this._terminal.buffer.x--},c.prototype.tab=function(){var a=this._terminal.buffer.x;this._terminal.buffer.x=this._terminal.buffer.nextStop();this._terminal.options.screenReaderMode&&this._terminal.emit("a11y.tab",this._terminal.buffer.x-a)},c.prototype.shiftOut=function(){this._terminal.setgLevel(1)},c.prototype.shiftIn=
function(){this._terminal.setgLevel(0)},c.prototype.insertChars=function(a){this._terminal.buffer.lines.get(this._terminal.buffer.y+this._terminal.buffer.ybase).insertCells(this._terminal.buffer.x,a[0]||1,this._terminal.buffer.getNullCell(this._terminal.eraseAttrData()));this._terminal.updateRange(this._terminal.buffer.y)},c.prototype.cursorUp=function(a){a=a[0];1>a&&(a=1);this._terminal.buffer.y-=a;0>this._terminal.buffer.y&&(this._terminal.buffer.y=0)},c.prototype.cursorDown=function(a){a=a[0];
1>a&&(a=1);this._terminal.buffer.y+=a;this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1);this._terminal.buffer.x>=this._terminal.cols&&this._terminal.buffer.x--},c.prototype.cursorForward=function(a){a=a[0];1>a&&(a=1);this._terminal.buffer.x+=a;this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},c.prototype.cursorBackward=function(a){a=a[0];1>a&&(a=1);this._terminal.buffer.x>=this._terminal.cols&&this._terminal.buffer.x--;
this._terminal.buffer.x-=a;0>this._terminal.buffer.x&&(this._terminal.buffer.x=0)},c.prototype.cursorNextLine=function(a){a=a[0];1>a&&(a=1);this._terminal.buffer.y+=a;this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1);this._terminal.buffer.x=0},c.prototype.cursorPrecedingLine=function(a){a=a[0];1>a&&(a=1);this._terminal.buffer.y-=a;0>this._terminal.buffer.y&&(this._terminal.buffer.y=0);this._terminal.buffer.x=0},c.prototype.cursorCharAbsolute=function(a){a=
a[0];1>a&&(a=1);this._terminal.buffer.x=a-1},c.prototype.cursorPosition=function(a){var b=a[0]-1;a=2<=a.length?a[1]-1:0;0>b?b=0:b>=this._terminal.rows&&(b=this._terminal.rows-1);0>a?a=0:a>=this._terminal.cols&&(a=this._terminal.cols-1);this._terminal.buffer.x=a;this._terminal.buffer.y=b},c.prototype.cursorForwardTab=function(a){for(a=a[0]||1;a--;)this._terminal.buffer.x=this._terminal.buffer.nextStop()},c.prototype._eraseInBufferLine=function(a,b,g,f){void 0===f&&(f=!1);a=this._terminal.buffer.lines.get(this._terminal.buffer.ybase+
a);a.replaceCells(b,g,this._terminal.buffer.getNullCell(this._terminal.eraseAttrData()));f&&(a.isWrapped=!1)},c.prototype._resetBufferLine=function(a){this._eraseInBufferLine(a,0,this._terminal.cols,!0)},c.prototype.eraseInDisplay=function(a){switch(a[0]){case 0:a=this._terminal.buffer.y;this._terminal.updateRange(a);for(this._eraseInBufferLine(a++,this._terminal.buffer.x,this._terminal.cols,0===this._terminal.buffer.x);a<this._terminal.rows;a++)this._resetBufferLine(a);this._terminal.updateRange(a);
break;case 1:a=this._terminal.buffer.y;this._terminal.updateRange(a);this._eraseInBufferLine(a,0,this._terminal.buffer.x+1,!0);for(this._terminal.buffer.x+1>=this._terminal.cols&&(this._terminal.buffer.lines.get(a+1).isWrapped=!1);a--;)this._resetBufferLine(a);this._terminal.updateRange(0);break;case 2:a=this._terminal.rows;for(this._terminal.updateRange(a-1);a--;)this._resetBufferLine(a);this._terminal.updateRange(0);break;case 3:a=this._terminal.buffer.lines.length-this._terminal.rows,0<a&&(this._terminal.buffer.lines.trimStart(a),
this._terminal.buffer.ybase=Math.max(this._terminal.buffer.ybase-a,0),this._terminal.buffer.ydisp=Math.max(this._terminal.buffer.ydisp-a,0),this._onScroll.fire(0))}},c.prototype.eraseInLine=function(a){switch(a[0]){case 0:this._eraseInBufferLine(this._terminal.buffer.y,this._terminal.buffer.x,this._terminal.cols);break;case 1:this._eraseInBufferLine(this._terminal.buffer.y,0,this._terminal.buffer.x+1);break;case 2:this._eraseInBufferLine(this._terminal.buffer.y,0,this._terminal.cols)}this._terminal.updateRange(this._terminal.buffer.y)},
c.prototype.insertLines=function(a){a=a[0];1>a&&(a=1);for(var b=this._terminal.buffer,g=b.y+b.ybase,f=this._terminal.rows-1+b.ybase-(this._terminal.rows-1-b.scrollBottom)+1;a--;)b.lines.splice(f-1,1),b.lines.splice(g,0,b.getBlankLine(this._terminal.eraseAttrData()));this._terminal.updateRange(b.y);this._terminal.updateRange(b.scrollBottom)},c.prototype.deleteLines=function(a){a=a[0];1>a&&(a=1);var b=this._terminal.buffer,g=b.y+b.ybase;var f=this._terminal.rows-1-b.scrollBottom;for(f=this._terminal.rows-
1+b.ybase-f;a--;)b.lines.splice(g,1),b.lines.splice(f,0,b.getBlankLine(this._terminal.eraseAttrData()));this._terminal.updateRange(b.y);this._terminal.updateRange(b.scrollBottom)},c.prototype.deleteChars=function(a){this._terminal.buffer.lines.get(this._terminal.buffer.y+this._terminal.buffer.ybase).deleteCells(this._terminal.buffer.x,a[0]||1,this._terminal.buffer.getNullCell(this._terminal.eraseAttrData()));this._terminal.updateRange(this._terminal.buffer.y)},c.prototype.scrollUp=function(a){a=a[0]||
1;for(var b=this._terminal.buffer;a--;)b.lines.splice(b.ybase+b.scrollTop,1),b.lines.splice(b.ybase+b.scrollBottom,0,b.getBlankLine(u.DEFAULT_ATTR_DATA));this._terminal.updateRange(b.scrollTop);this._terminal.updateRange(b.scrollBottom)},c.prototype.scrollDown=function(a,b){if(2>a.length&&!b){a=a[0]||1;for(b=this._terminal.buffer;a--;)b.lines.splice(b.ybase+b.scrollBottom,1),b.lines.splice(b.ybase+b.scrollTop,0,b.getBlankLine(u.DEFAULT_ATTR_DATA));this._terminal.updateRange(b.scrollTop);this._terminal.updateRange(b.scrollBottom)}},
c.prototype.eraseChars=function(a){this._terminal.buffer.lines.get(this._terminal.buffer.y+this._terminal.buffer.ybase).replaceCells(this._terminal.buffer.x,this._terminal.buffer.x+(a[0]||1),this._terminal.buffer.getNullCell(this._terminal.eraseAttrData()))},c.prototype.cursorBackwardTab=function(a){a=a[0]||1;for(var b=this._terminal.buffer;a--;)b.x=b.prevStop()},c.prototype.charPosAbsolute=function(a){a=a[0];1>a&&(a=1);this._terminal.buffer.x=a-1;this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=
this._terminal.cols-1)},c.prototype.hPositionRelative=function(a){a=a[0];1>a&&(a=1);this._terminal.buffer.x+=a;this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},c.prototype.repeatPrecedingCharacter=function(a){var b=this._terminal.buffer,g=b.lines.get(b.ybase+b.y);g.loadCell(b.x-1,this._workCell);g.replaceCells(b.x,b.x+(a[0]||1),void 0!==this._workCell.content?this._workCell:b.getNullCell(u.DEFAULT_ATTR_DATA))},c.prototype.sendDeviceAttributes=function(a,
b){0<a[0]||(b?">"===b&&(this._terminal.is("xterm")?this._terminal.handler(m.C0.ESC+"[>0;276;0c"):this._terminal.is("rxvt-unicode")?this._terminal.handler(m.C0.ESC+"[>85;95;0c"):this._terminal.is("linux")?this._terminal.handler(a[0]+"c"):this._terminal.is("screen")&&this._terminal.handler(m.C0.ESC+"[>83;40003;0c")):this._terminal.is("xterm")||this._terminal.is("rxvt-unicode")||this._terminal.is("screen")?this._terminal.handler(m.C0.ESC+"[?1;2c"):this._terminal.is("linux")&&this._terminal.handler(m.C0.ESC+
"[?6c"))},c.prototype.linePosAbsolute=function(a){a=a[0];1>a&&(a=1);this._terminal.buffer.y=a-1;this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1)},c.prototype.vPositionRelative=function(a){a=a[0];1>a&&(a=1);this._terminal.buffer.y+=a;this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1);this._terminal.buffer.x>=this._terminal.cols&&this._terminal.buffer.x--},c.prototype.hVPosition=function(a){1>a[0]&&(a[0]=1);1>a[1]&&
(a[1]=1);this._terminal.buffer.y=a[0]-1;this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1);this._terminal.buffer.x=a[1]-1;this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},c.prototype.tabClear=function(a){a=a[0];0>=a?delete this._terminal.buffer.tabs[this._terminal.buffer.x]:3===a&&(this._terminal.buffer.tabs={})},c.prototype.setMode=function(a,b){if(1<a.length)for(b=0;b<a.length;b++)this.setMode([a[b]]);else if(b){if("?"===
b)switch(a[0]){case 1:this._terminal.applicationCursor=!0;break;case 2:this._terminal.setgCharset(0,p.DEFAULT_CHARSET);this._terminal.setgCharset(1,p.DEFAULT_CHARSET);this._terminal.setgCharset(2,p.DEFAULT_CHARSET);this._terminal.setgCharset(3,p.DEFAULT_CHARSET);break;case 3:this._terminal.savedCols=this._terminal.cols;this._terminal.resize(132,this._terminal.rows);break;case 6:this._terminal.originMode=!0;break;case 7:this._terminal.wraparoundMode=!0;break;case 66:this._terminal.log("Serial port requested application keypad.");
this._terminal.applicationKeypad=!0;this._terminal.viewport&&this._terminal.viewport.syncScrollArea();break;case 9:case 1E3:case 1002:case 1003:this._terminal.x10Mouse=9===a[0];this._terminal.vt200Mouse=1E3===a[0];this._terminal.normalMouse=1E3<a[0];this._terminal.mouseEvents=!0;this._terminal.element&&this._terminal.element.classList.add("enable-mouse-events");this._terminal.selectionManager&&this._terminal.selectionManager.disable();this._terminal.log("Binding to mouse events.");break;case 1004:this._terminal.sendFocus=
!0;break;case 1005:this._terminal.utfMouse=!0;break;case 1006:this._terminal.sgrMouse=!0;break;case 1015:this._terminal.urxvtMouse=!0;break;case 25:this._terminal.cursorHidden=!1;break;case 1048:this.saveCursor(a);break;case 1049:this.saveCursor(a);case 47:case 1047:this._terminal.buffers.activateAltBuffer(this._terminal.eraseAttrData());this._terminal.refresh(0,this._terminal.rows-1);this._terminal.viewport&&this._terminal.viewport.syncScrollArea();this._terminal.showCursor();break;case 2004:this._terminal.bracketedPasteMode=
!0}}else switch(a[0]){case 4:this._terminal.insertMode=!0}},c.prototype.resetMode=function(a,b){if(1<a.length)for(b=0;b<a.length;b++)this.resetMode([a[b]]);else if(b){if("?"===b)switch(a[0]){case 1:this._terminal.applicationCursor=!1;break;case 3:132===this._terminal.cols&&this._terminal.savedCols&&this._terminal.resize(this._terminal.savedCols,this._terminal.rows);delete this._terminal.savedCols;break;case 6:this._terminal.originMode=!1;break;case 7:this._terminal.wraparoundMode=!1;break;case 66:this._terminal.log("Switching back to normal keypad.");
this._terminal.applicationKeypad=!1;this._terminal.viewport&&this._terminal.viewport.syncScrollArea();break;case 9:case 1E3:case 1002:case 1003:this._terminal.x10Mouse=!1;this._terminal.vt200Mouse=!1;this._terminal.normalMouse=!1;this._terminal.mouseEvents=!1;this._terminal.element&&this._terminal.element.classList.remove("enable-mouse-events");this._terminal.selectionManager&&this._terminal.selectionManager.enable();break;case 1004:this._terminal.sendFocus=!1;break;case 1005:this._terminal.utfMouse=
!1;break;case 1006:this._terminal.sgrMouse=!1;break;case 1015:this._terminal.urxvtMouse=!1;break;case 25:this._terminal.cursorHidden=!0;break;case 1048:this.restoreCursor(a);break;case 1049:case 47:case 1047:this._terminal.buffers.activateNormalBuffer();1049===a[0]&&this.restoreCursor(a);this._terminal.refresh(0,this._terminal.rows-1);this._terminal.viewport&&this._terminal.viewport.syncScrollArea();this._terminal.showCursor();break;case 2004:this._terminal.bracketedPasteMode=!1}}else switch(a[0]){case 4:this._terminal.insertMode=
!1}},c.prototype.charAttributes=function(a){if(1===a.length&&0===a[0])return this._terminal.curAttrData.fg=u.DEFAULT_ATTR_DATA.fg,void(this._terminal.curAttrData.bg=u.DEFAULT_ATTR_DATA.bg);for(var b,g=a.length,f=this._terminal.curAttrData,c=0;c<g;c++)30<=(b=a[c])&&37>=b?(f.fg&=-50331904,f.fg=f.fg|16777216|b-30):40<=b&&47>=b?(f.bg&=-50331904,f.bg=f.bg|16777216|b-40):90<=b&&97>=b?(f.fg&=-50331904,f.fg=f.fg|16777224|b-90):100<=b&&107>=b?(f.bg&=-50331904,f.bg=f.bg|16777224|b-100):0===b?(f.fg=u.DEFAULT_ATTR_DATA.fg,
f.bg=u.DEFAULT_ATTR_DATA.bg):1===b?f.fg|=134217728:3===b?f.bg|=67108864:4===b?f.fg|=268435456:5===b?f.fg|=536870912:7===b?f.fg|=67108864:8===b?f.fg|=1073741824:2===b?f.bg|=134217728:22===b?(f.fg&=-134217729,f.bg&=-134217729):23===b?f.bg&=-67108865:24===b?f.fg&=-268435457:25===b?f.fg&=-536870913:27===b?f.fg&=-67108865:28===b?f.fg&=-1073741825:39===b?(f.fg&=-67108864,f.fg|=16777215&u.DEFAULT_ATTR_DATA.fg):49===b?(f.bg&=-67108864,f.bg|=16777215&u.DEFAULT_ATTR_DATA.bg):38===b?2===a[c+1]?(c+=2,f.fg|=50331648,
f.fg&=-16777216,f.fg|=u.AttributeData.fromColorRGB([a[c],a[c+1],a[c+2]]),c+=2):5===a[c+1]&&(b=255&a[c+=2],f.fg&=-50331904,f.fg=f.fg|33554432|b):48===b?2===a[c+1]?(c+=2,f.bg|=50331648,f.bg&=-16777216,f.bg|=u.AttributeData.fromColorRGB([a[c],a[c+1],a[c+2]]),c+=2):5===a[c+1]&&(b=255&a[c+=2],f.bg&=-50331904,f.bg=f.bg|33554432|b):100===b?(f.fg&=-67108864,f.fg|=16777215&u.DEFAULT_ATTR_DATA.fg,f.bg&=-67108864,f.bg|=16777215&u.DEFAULT_ATTR_DATA.bg):this._terminal.error("Unknown SGR attribute: %d.",b)},c.prototype.deviceStatus=
function(a,b){if(b){if("?"===b)switch(a[0]){case 6:a=this._terminal.buffer.y+1,b=this._terminal.buffer.x+1,this._onData.fire(m.C0.ESC+"[?"+a+";"+b+"R")}}else switch(a[0]){case 5:this._onData.fire(m.C0.ESC+"[0n");break;case 6:a=this._terminal.buffer.y+1,b=this._terminal.buffer.x+1,this._onData.fire(m.C0.ESC+"["+a+";"+b+"R")}},c.prototype.softReset=function(a,b){"!"===b&&(this._terminal.cursorHidden=!1,this._terminal.insertMode=!1,this._terminal.originMode=!1,this._terminal.wraparoundMode=!0,this._terminal.applicationKeypad=
!1,this._terminal.viewport&&this._terminal.viewport.syncScrollArea(),this._terminal.applicationCursor=!1,this._terminal.buffer.scrollTop=0,this._terminal.buffer.scrollBottom=this._terminal.rows-1,this._terminal.curAttrData=u.DEFAULT_ATTR_DATA.clone(),this._terminal.buffer.x=this._terminal.buffer.y=0,this._terminal.charset=null,this._terminal.glevel=0,this._terminal.charsets=[null])},c.prototype.setCursorStyle=function(a,b){if(" "===b){a=1>a[0]?1:a[0];switch(a){case 1:case 2:this._terminal.setOption("cursorStyle",
"block");break;case 3:case 4:this._terminal.setOption("cursorStyle","underline");break;case 5:case 6:this._terminal.setOption("cursorStyle","bar")}this._terminal.setOption("cursorBlink",1==a%2)}},c.prototype.setScrollRegion=function(a,b){b||(this._terminal.buffer.scrollTop=(a[0]||1)-1,this._terminal.buffer.scrollBottom=(a[1]&&a[1]<=this._terminal.rows?a[1]:this._terminal.rows)-1,this._terminal.buffer.x=0,this._terminal.buffer.y=0)},c.prototype.saveCursor=function(a){this._terminal.buffer.savedX=this._terminal.buffer.x;
this._terminal.buffer.savedY=this._terminal.buffer.y;this._terminal.buffer.savedCurAttrData.fg=this._terminal.curAttrData.fg;this._terminal.buffer.savedCurAttrData.bg=this._terminal.curAttrData.bg},c.prototype.restoreCursor=function(a){this._terminal.buffer.x=this._terminal.buffer.savedX||0;this._terminal.buffer.y=this._terminal.buffer.savedY||0;this._terminal.curAttrData.fg=this._terminal.buffer.savedCurAttrData.fg;this._terminal.curAttrData.bg=this._terminal.buffer.savedCurAttrData.bg},c.prototype.setTitle=
function(a){this._terminal.handleTitle(a)},c.prototype.nextLine=function(){this._terminal.buffer.x=0;this.index()},c.prototype.keypadApplicationMode=function(){this._terminal.log("Serial port requested application keypad.");this._terminal.applicationKeypad=!0;this._terminal.viewport&&this._terminal.viewport.syncScrollArea()},c.prototype.keypadNumericMode=function(){this._terminal.log("Switching back to normal keypad.");this._terminal.applicationKeypad=!1;this._terminal.viewport&&this._terminal.viewport.syncScrollArea()},
c.prototype.selectDefaultCharset=function(){this._terminal.setgLevel(0);this._terminal.setgCharset(0,p.DEFAULT_CHARSET)},c.prototype.selectCharset=function(a){2===a.length?"/"!==a[0]&&this._terminal.setgCharset(z[a[0]],p.CHARSETS[a[1]]||p.DEFAULT_CHARSET):this.selectDefaultCharset()},c.prototype.index=function(){this._terminal.index()},c.prototype.tabSet=function(){this._terminal.tabSet()},c.prototype.reverseIndex=function(){this._terminal.reverseIndex()},c.prototype.reset=function(){this._parser.reset();
this._terminal.reset()},c.prototype.setgLevel=function(a){this._terminal.setgLevel(a)},c);d.InputHandler=b},{"./CharWidth":5,"./EscapeSequenceParser":8,"./common/EventEmitter2":23,"./common/Lifecycle":24,"./common/TypedArrayUtils":26,"./common/data/EscapeSequences":28,"./core/buffer/BufferLine":29,"./core/data/Charsets":32,"./core/input/TextDecoder":34}],10:[function(b,h,d){function a(a){this._terminal=a;this._linkMatchers=[];this._nextLinkMatcherId=0;this._onLinkHover=new m.EventEmitter2;this._onLinkLeave=
new m.EventEmitter2;this._onLinkTooltip=new m.EventEmitter2;this._rowsToLinkify={start:null,end:null}}Object.defineProperty(d,"__esModule",{value:!0});var c=b("./MouseZoneManager"),k=b("./CharWidth"),m=b("./common/EventEmitter2");b=(Object.defineProperty(a.prototype,"onLinkHover",{get:function(){return this._onLinkHover.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onLinkLeave",{get:function(){return this._onLinkLeave.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,
"onLinkTooltip",{get:function(){return this._onLinkTooltip.event},enumerable:!0,configurable:!0}),a.prototype.attachToDom=function(a){this._mouseZoneManager=a},a.prototype.linkifyRows=function(b,c){var d=this;this._mouseZoneManager&&(null===this._rowsToLinkify.start?(this._rowsToLinkify.start=b,this._rowsToLinkify.end=c):(this._rowsToLinkify.start=Math.min(this._rowsToLinkify.start,b),this._rowsToLinkify.end=Math.max(this._rowsToLinkify.end,c)),this._mouseZoneManager.clearAll(b,c),this._rowsTimeoutId&&
clearTimeout(this._rowsTimeoutId),this._rowsTimeoutId=setTimeout(function(){return d._linkifyRows()},a.TIME_BEFORE_LINKIFY))},a.prototype._linkifyRows=function(){this._rowsTimeoutId=null;var b=this._terminal.buffer,c=b.ydisp+this._rowsToLinkify.start;if(!(c>=b.lines.length)){var d=Math.ceil(a.OVERSCAN_CHAR_LIMIT/this._terminal.cols);for(b=this._terminal.buffer.iterator(!1,c,b.ydisp+Math.min(this._rowsToLinkify.end,this._terminal.rows)+1,d,d);b.hasNext();)for(c=b.next(),d=0;d<this._linkMatchers.length;d++)this._doLinkifyRow(c.range.first,
c.content,this._linkMatchers[d]);this._rowsToLinkify.start=null;this._rowsToLinkify.end=null}},a.prototype.registerLinkMatcher=function(a,b,c){if(void 0===c&&(c={}),!b)throw Error("handler must be defined");a={id:this._nextLinkMatcherId++,regex:a,handler:b,matchIndex:c.matchIndex,validationCallback:c.validationCallback,hoverTooltipCallback:c.tooltipCallback,hoverLeaveCallback:c.leaveCallback,willLinkActivate:c.willLinkActivate,priority:c.priority||0};return this._addLinkMatcherToList(a),a.id},a.prototype._addLinkMatcherToList=
function(a){if(0!==this._linkMatchers.length){for(var b=this._linkMatchers.length-1;0<=b;b--)if(a.priority<=this._linkMatchers[b].priority)return void this._linkMatchers.splice(b+1,0,a);this._linkMatchers.splice(0,0,a)}else this._linkMatchers.push(a)},a.prototype.deregisterLinkMatcher=function(a){for(var b=0;b<this._linkMatchers.length;b++)if(this._linkMatchers[b].id===a)return this._linkMatchers.splice(b,1),!0;return!1},a.prototype._doLinkifyRow=function(a,b,c){for(var f,g=this,d=new RegExp(c.regex.source,
c.regex.flags+"g"),l=-1,k=function(){var n=f["number"!=typeof c.matchIndex?0:c.matchIndex];if(!n){if(m._terminal.debug)throw console.log({match:f,matcher:c}),Error("match found without corresponding matchIndex");return"break"}if(l=b.indexOf(n,l+1),d.lastIndex=l+n.length,0>l)return"break";var k=m._terminal.buffer.stringIndexToBufferIndex(a,l);if(0>k[0])return"break";var q,u=m._terminal.buffer.lines.get(k[0]).getFg(k[1]);u&&(q=u>>9&511);c.validationCallback?c.validationCallback(n,function(a){g._rowsTimeoutId||
a&&g._addLink(k[1],k[0]-g._terminal.buffer.ydisp,n,c,q)}):m._addLink(k[1],k[0]-m._terminal.buffer.ydisp,n,c,q)},m=this;null!==(f=d.exec(b))&&"break"!==k(););},a.prototype._addLink=function(a,b,d,f,g){var n=this,l=k.getStringCellWidth(d),m=a%this._terminal.cols,q=b+Math.floor(a/this._terminal.cols),h=(m+l)%this._terminal.cols,p=q+Math.floor((m+l)/this._terminal.cols);0===h&&(h=this._terminal.cols,p--);this._mouseZoneManager.add(new c.MouseZone(1+m,q+1,h+1,p+1,function(a){if(f.handler)return f.handler(a,
d);window.open(d,"_blank")},function(){n._onLinkHover.fire(n._createLinkHoverEvent(m,q,h,p,g));n._terminal.element.classList.add("xterm-cursor-pointer")},function(a){n._onLinkTooltip.fire(n._createLinkHoverEvent(m,q,h,p,g));f.hoverTooltipCallback&&f.hoverTooltipCallback(a,d)},function(){n._onLinkLeave.fire(n._createLinkHoverEvent(m,q,h,p,g));n._terminal.element.classList.remove("xterm-cursor-pointer");f.hoverLeaveCallback&&f.hoverLeaveCallback()},function(a){return!f.willLinkActivate||f.willLinkActivate(a,
d)}))},a.prototype._createLinkHoverEvent=function(a,b,c,f,g){return{x1:a,y1:b,x2:c,y2:f,cols:this._terminal.cols,fg:g}},a.TIME_BEFORE_LINKIFY=200,a.OVERSCAN_CHAR_LIMIT=2E3,a);d.Linkifier=b},{"./CharWidth":5,"./MouseZoneManager":12,"./common/EventEmitter2":23}],11:[function(b,h,d){function a(a){this._renderCoordinator=a}Object.defineProperty(d,"__esModule",{value:!0});b=(a.getCoordsRelativeToElement=function(a,b){b=b.getBoundingClientRect();return[a.clientX-b.left,a.clientY-b.top]},a.prototype.getCoords=
function(b,d,m,h,q,l){return m.width&&m.height?(b=a.getCoordsRelativeToElement(b,d))?(b[0]=Math.ceil((b[0]+(l?this._renderCoordinator.dimensions.actualCellWidth/2:0))/this._renderCoordinator.dimensions.actualCellWidth),b[1]=Math.ceil(b[1]/this._renderCoordinator.dimensions.actualCellHeight),b[0]=Math.min(Math.max(b[0],1),h+(l?1:0)),b[1]=Math.min(Math.max(b[1],1),q),b):null:null},a.prototype.getRawByteCoords=function(a,b,d,h,q){a=this.getCoords(a,b,d,h,q);return{x:a[0]+32,y:a[1]+32}},a);d.MouseHelper=
b},{}],12:[function(b,h,d){function a(a){var b=k.call(this)||this;return b._terminal=a,b._zones=[],b._areZonesActive=!1,b._tooltipTimeout=null,b._currentZone=null,b._lastHoverCoords=[null,null],b.register(p.addDisposableDomListener(b._terminal.element,"mousedown",function(a){return b._onMouseDown(a)})),b._mouseMoveListener=function(a){return b._onMouseMove(a)},b._mouseLeaveListener=function(a){return b._onMouseLeave(a)},b._clickListener=function(a){return b._onClick(a)},b}var c;h=this&&this.__extends||
(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f])})(a,b)},function(a,b){function f(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(f.prototype=b.prototype,new f)});Object.defineProperty(d,"__esModule",{value:!0});var k,m=b("./common/Lifecycle"),p=b("./ui/Lifecycle");b=(k=m.Disposable,h(a,k),a.prototype.dispose=function(){k.prototype.dispose.call(this);this._deactivate()},
a.prototype.add=function(a){this._zones.push(a);1===this._zones.length&&this._activate()},a.prototype.clearAll=function(a,b){if(0!==this._zones.length){b||(a=0,b=this._terminal.rows-1);for(var f=0;f<this._zones.length;f++){var g=this._zones[f];(g.y1>a&&g.y1<=b+1||g.y2>a&&g.y2<=b+1||g.y1<a&&g.y2>b+1)&&(this._currentZone&&this._currentZone===g&&(this._currentZone.leaveCallback(),this._currentZone=null),this._zones.splice(f--,1))}0===this._zones.length&&this._deactivate()}},a.prototype._activate=function(){this._areZonesActive||
(this._areZonesActive=!0,this._terminal.element.addEventListener("mousemove",this._mouseMoveListener),this._terminal.element.addEventListener("mouseleave",this._mouseLeaveListener),this._terminal.element.addEventListener("click",this._clickListener))},a.prototype._deactivate=function(){this._areZonesActive&&(this._areZonesActive=!1,this._terminal.element.removeEventListener("mousemove",this._mouseMoveListener),this._terminal.element.removeEventListener("mouseleave",this._mouseLeaveListener),this._terminal.element.removeEventListener("click",
this._clickListener))},a.prototype._onMouseMove=function(a){this._lastHoverCoords[0]===a.pageX&&this._lastHoverCoords[1]===a.pageY||(this._onHover(a),this._lastHoverCoords=[a.pageX,a.pageY])},a.prototype._onHover=function(a){var b=this,f=this._findZoneEventAt(a);f!==this._currentZone&&(this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=null,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout)),f&&((this._currentZone=f).hoverCallback&&f.hoverCallback(a),this._tooltipTimeout=
setTimeout(function(){return b._onTooltip(a)},500)))},a.prototype._onTooltip=function(a){this._tooltipTimeout=null;var b=this._findZoneEventAt(a);b&&b.tooltipCallback&&b.tooltipCallback(a)},a.prototype._onMouseDown=function(a){if(this._initialSelectionLength=this._terminal.getSelection().length,this._areZonesActive){var b=this._findZoneEventAt(a);b&&b.willLinkActivate(a)&&(a.preventDefault(),a.stopImmediatePropagation())}},a.prototype._onMouseLeave=function(a){this._currentZone&&(this._currentZone.leaveCallback(),
this._currentZone=null,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout))},a.prototype._onClick=function(a){var b=this._findZoneEventAt(a),f=this._terminal.getSelection().length;b&&f===this._initialSelectionLength&&(b.clickCallback(a),a.preventDefault(),a.stopImmediatePropagation())},a.prototype._findZoneEventAt=function(a){var b=this._terminal.mouseHelper.getCoords(a,this._terminal.screenElement,this._terminal.charMeasure,this._terminal.cols,this._terminal.rows);if(!b)return null;a=b[0];b=
b[1];for(var f=0;f<this._zones.length;f++){var g=this._zones[f];if(g.y1===g.y2){if(b===g.y1&&a>=g.x1&&a<g.x2)return g}else if(b===g.y1&&a>=g.x1||b===g.y2&&a<g.x2||b>g.y1&&b<g.y2)return g}return null},a);d.MouseZoneManager=b;d.MouseZone=function(a,b,f,g,c,d,k,m,h){this.x1=a;this.y1=b;this.x2=f;this.y2=g;this.clickCallback=c;this.hoverCallback=d;this.tooltipCallback=k;this.leaveCallback=m;this.willLinkActivate=h}},{"./common/Lifecycle":24,"./ui/Lifecycle":59}],13:[function(b,h,d){function a(a,b){this._terminal=
a;this._charMeasure=b;this._enabled=!0;this._workCell=new q.CellData;this._onLinuxMouseSelection=new l.EventEmitter2;this._onRedrawRequest=new l.EventEmitter2;this._onSelectionChange=new l.EventEmitter2;this._initListeners();this.enable();this._model=new m.SelectionModel(a);this._activeSelectionMode=0}Object.defineProperty(d,"__esModule",{value:!0});var c=b("./MouseHelper"),k=b("./common/Platform"),m=b("./SelectionModel"),p=b("./handlers/AltClickHandler"),q=b("./core/buffer/BufferLine"),l=b("./common/EventEmitter2");
b=String.fromCharCode(160);var f=new RegExp(b,"g");b=(Object.defineProperty(a.prototype,"onLinuxMouseSelection",{get:function(){return this._onLinuxMouseSelection.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onRedrawRequest",{get:function(){return this._onRedrawRequest.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this._removeMouseDownListeners()},
Object.defineProperty(a.prototype,"_buffer",{get:function(){return this._terminal.buffers.active},enumerable:!0,configurable:!0}),a.prototype._initListeners=function(){var a=this;this._mouseMoveListener=function(b){return a._onMouseMove(b)};this._mouseUpListener=function(b){return a._onMouseUp(b)};this.initBuffersListeners()},a.prototype.initBuffersListeners=function(){var a=this;this._trimListener=this._terminal.buffer.lines.onTrim(function(b){return a._onTrim(b)});this._terminal.buffers.onBufferActivate(function(b){return a._onBufferActivate(b)})},
a.prototype.disable=function(){this.clearSelection();this._enabled=!1},a.prototype.enable=function(){this._enabled=!0},Object.defineProperty(a.prototype,"selectionStart",{get:function(){return this._model.finalSelectionStart},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selectionEnd",{get:function(){return this._model.finalSelectionEnd},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"hasSelection",{get:function(){var a=this._model.finalSelectionStart,b=this._model.finalSelectionEnd;
return!(!a||!b||a[0]===b[0]&&a[1]===b[1])},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selectionText",{get:function(){var a=this._model.finalSelectionStart,b=this._model.finalSelectionEnd;if(!a||!b)return"";var c=[];if(3===this._activeSelectionMode){if(a[0]===b[0])return"";for(var d=a[1];d<=b[1];d++){var l=this._buffer.translateBufferLineToString(d,!0,a[0],b[0]);c.push(l)}}else{c.push(this._buffer.translateBufferLineToString(a[1],!0,a[0],a[1]===b[1]?b[0]:void 0));for(d=a[1]+
1;d<=b[1]-1;d++){var m=this._buffer.lines.get(d);l=this._buffer.translateBufferLineToString(d,!0);m.isWrapped?c[c.length-1]+=l:c.push(l)}a[1]!==b[1]&&(m=this._buffer.lines.get(b[1]),l=this._buffer.translateBufferLineToString(b[1],!0,0,b[0]),m.isWrapped?c[c.length-1]+=l:c.push(l))}return c.map(function(a){return a.replace(f," ")}).join(k.isMSWindows?"\r\n":"\n")},enumerable:!0,configurable:!0}),a.prototype.clearSelection=function(){this._model.clearSelection();this._removeMouseDownListeners();this.refresh();
this._onSelectionChange.fire()},a.prototype.refresh=function(a){var b=this;this._refreshAnimationFrame||(this._refreshAnimationFrame=window.requestAnimationFrame(function(){return b._refresh()}));k.isLinux&&a&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)},a.prototype._refresh=function(){this._refreshAnimationFrame=null;this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})},
a.prototype.isClickInSelection=function(a){a=this._getMouseBufferCoords(a);var b=this._model.finalSelectionStart,f=this._model.finalSelectionEnd;return!(!b||!f)&&this._areCoordsInSelection(a,b,f)},a.prototype._areCoordsInSelection=function(a,b,f){return a[1]>b[1]&&a[1]<f[1]||b[1]===f[1]&&a[1]===b[1]&&a[0]>=b[0]&&a[0]<f[0]||b[1]<f[1]&&a[1]===f[1]&&a[0]<f[0]||b[1]<f[1]&&a[1]===b[1]&&a[0]>=b[0]},a.prototype.selectWordAtCursor=function(a){(a=this._getMouseBufferCoords(a))&&(this._selectWordAt(a,!1),this._model.selectionEnd=
null,this.refresh(!0))},a.prototype.selectAll=function(){this._model.isSelectAllActive=!0;this.refresh();this._onSelectionChange.fire()},a.prototype.selectLines=function(a,b){this._model.clearSelection();a=Math.max(a,0);b=Math.min(b,this._terminal.buffer.lines.length-1);this._model.selectionStart=[0,a];this._model.selectionEnd=[this._terminal.cols,b];this.refresh();this._onSelectionChange.fire()},a.prototype._onTrim=function(a){this._model.onTrim(a)&&this.refresh()},a.prototype._getMouseBufferCoords=
function(a){return(a=this._terminal.mouseHelper.getCoords(a,this._terminal.screenElement,this._charMeasure,this._terminal.cols,this._terminal.rows,!0))?(a[0]--,a[1]--,a[1]+=this._terminal.buffer.ydisp,a):null},a.prototype._getMouseEventScrollAmount=function(a){a=c.MouseHelper.getCoordsRelativeToElement(a,this._terminal.screenElement)[1];var b=this._terminal.rows*Math.ceil(this._charMeasure.height*this._terminal.options.lineHeight);return 0<=a&&a<=b?0:(b<a&&(a-=b),a=Math.min(Math.max(a,-50),50),(a/=
50)/Math.abs(a)+Math.round(14*a))},a.prototype.shouldForceSelection=function(a){return k.isMac?a.altKey&&this._terminal.options.macOptionClickForcesSelection:a.shiftKey},a.prototype.onMouseDown=function(a){if(this._mouseDownTimeStamp=a.timeStamp,(2!==a.button||!this.hasSelection)&&0===a.button){if(!this._enabled){if(!this.shouldForceSelection(a))return;a.stopPropagation()}a.preventDefault();this._dragScrollAmount=0;this._enabled&&a.shiftKey?this._onIncrementalClick(a):1===a.detail?this._onSingleClick(a):
2===a.detail?this._onDoubleClick(a):3===a.detail&&this._onTripleClick(a);this._addMouseDownListeners();this.refresh(!0)}},a.prototype._addMouseDownListeners=function(){var a=this;this._terminal.element.ownerDocument.addEventListener("mousemove",this._mouseMoveListener);this._terminal.element.ownerDocument.addEventListener("mouseup",this._mouseUpListener);this._dragScrollIntervalTimer=setInterval(function(){return a._dragScroll()},50)},a.prototype._removeMouseDownListeners=function(){this._terminal.element.ownerDocument&&
(this._terminal.element.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._terminal.element.ownerDocument.removeEventListener("mouseup",this._mouseUpListener));clearInterval(this._dragScrollIntervalTimer);this._dragScrollIntervalTimer=null},a.prototype._onIncrementalClick=function(a){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(a))},a.prototype._onSingleClick=function(a){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=
!1,this._activeSelectionMode=this.shouldColumnSelect(a)?3:0,this._model.selectionStart=this._getMouseBufferCoords(a),this._model.selectionStart)this._model.selectionEnd=null,(a=this._buffer.lines.get(this._model.selectionStart[1]))&&(a.length>=this._model.selectionStart[0]||0===a.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++)},a.prototype._onDoubleClick=function(a){(a=this._getMouseBufferCoords(a))&&(this._activeSelectionMode=1,this._selectWordAt(a,!0))},a.prototype._onTripleClick=
function(a){(a=this._getMouseBufferCoords(a))&&(this._activeSelectionMode=2,this._selectLineAt(a[1]))},a.prototype.shouldColumnSelect=function(a){return a.altKey&&!(k.isMac&&this._terminal.options.macOptionClickForcesSelection)},a.prototype._onMouseMove=function(a){a.stopImmediatePropagation();var b=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;this._model.selectionEnd=this._getMouseBufferCoords(a);this._model.selectionEnd?(2===this._activeSelectionMode?this._model.selectionEnd[1]<
this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._terminal.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(a),3!==this._activeSelectionMode&&(0<this._dragScrollAmount?this._model.selectionEnd[0]=this._terminal.cols:0>this._dragScrollAmount&&(this._model.selectionEnd[0]=0)),this._model.selectionEnd[1]<this._buffer.lines.length&&0===this._buffer.lines.get(this._model.selectionEnd[1]).hasWidth(this._model.selectionEnd[0])&&
this._model.selectionEnd[0]++,b&&b[0]===this._model.selectionEnd[0]&&b[1]===this._model.selectionEnd[1]||this.refresh(!0)):this.refresh(!0)},a.prototype._dragScroll=function(){this._dragScrollAmount&&(this._terminal.scrollLines(this._dragScrollAmount,!1),0<this._dragScrollAmount?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._terminal.cols),this._model.selectionEnd[1]=Math.min(this._terminal.buffer.ydisp+this._terminal.rows,this._terminal.buffer.lines.length-1)):(3!==this._activeSelectionMode&&
(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=this._terminal.buffer.ydisp),this.refresh())},a.prototype._onMouseUp=function(a){var b=a.timeStamp-this._mouseDownTimeStamp;this._removeMouseDownListeners();1>=this.selectionText.length&&500>b?(new p.AltClickHandler(a,this._terminal)).move():this.hasSelection&&this._onSelectionChange.fire()},a.prototype._onBufferActivate=function(a){var b=this;this.clearSelection();this._trimListener&&this._trimListener.dispose();this._trimListener=a.activeBuffer.lines.onTrim(function(a){return b._onTrim(a)})},
a.prototype._convertViewportColToCharacterIndex=function(a,b){for(var f=b[0],g=0;b[0]>=g;g++){var c=a.loadCell(g,this._workCell).getChars().length;0===this._workCell.getWidth()?f--:1<c&&b[0]!==g&&(f+=c-1)}return f},a.prototype.setSelection=function(a,b,f){this._model.clearSelection();this._removeMouseDownListeners();this._model.selectionStart=[a,b];this._model.selectionStartLength=f;this.refresh()},a.prototype._getWordAt=function(a,b,f,c){if(void 0===f&&(f=!0),void 0===c&&(c=!0),a[0]>=this._terminal.cols)return null;
var g=this._buffer.lines.get(a[1]);if(!g)return null;var d=this._buffer.translateBufferLineToString(a[1],!1),n=this._convertViewportColToCharacterIndex(g,a),l=n,k=a[0]-n,m=0,q=0,h=0,u=0;if(" "===d.charAt(n)){for(;0<n&&" "===d.charAt(n-1);)n--;for(;l<d.length&&" "===d.charAt(l+1);)l++}else{var r=a[0],p=a[0];0===g.getWidth(r)&&(m++,r--);2===g.getWidth(p)&&(q++,p++);var D=g.getString(p).length;for(1<D&&(u+=D-1,l+=D-1);0<r&&0<n&&!this._isCharWordSeparator(g.loadCell(r-1,this._workCell));)g.loadCell(r-
1,this._workCell),D=this._workCell.getChars().length,0===this._workCell.getWidth()?(m++,r--):1<D&&(h+=D-1,n-=D-1),n--,r--;for(;p<g.length&&l+1<d.length&&!this._isCharWordSeparator(g.loadCell(p+1,this._workCell));)g.loadCell(p+1,this._workCell),r=this._workCell.getChars().length,2===this._workCell.getWidth()?(q++,p++):1<r&&(u+=r-1,l+=r-1),l++,p++}l++;k=n+k-m+h;m=Math.min(this._terminal.cols,l-n+m+q-h-u);if(!b&&""===d.slice(n,l).trim())return null;f&&0===k&&32!==g.getCodePoint(0)&&(b=this._buffer.lines.get(a[1]-
1))&&g.isWrapped&&32!==b.getCodePoint(this._terminal.cols-1)&&(b=this._getWordAt([this._terminal.cols-1,a[1]-1],!1,!0,!1))&&(b=this._terminal.cols-b.start,k-=b,m+=b);c&&k+m===this._terminal.cols&&32!==g.getCodePoint(this._terminal.cols-1)&&(c=this._buffer.lines.get(a[1]+1))&&c.isWrapped&&32!==c.getCodePoint(0)&&(a=this._getWordAt([0,a[1]+1],!1,!1,!0))&&(m+=a.length);return{start:k,length:m}},a.prototype._selectWordAt=function(a,b){if(b=this._getWordAt(a,b)){for(;0>b.start;)b.start+=this._terminal.cols,
a[1]--;this._model.selectionStart=[b.start,a[1]];this._model.selectionStartLength=b.length}},a.prototype._selectToWordAt=function(a){var b=this._getWordAt(a,!0);if(b){for(a=a[1];0>b.start;)b.start+=this._terminal.cols,a--;if(!this._model.areSelectionValuesReversed())for(;b.start+b.length>this._terminal.cols;)b.length-=this._terminal.cols,a++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?b.start:b.start+b.length,a]}},a.prototype._isCharWordSeparator=function(a){return 0!==a.getWidth()&&
0<=" ()[]{}'\"".indexOf(a.getChars())},a.prototype._selectLineAt=function(a){a=this._buffer.getWrappedRangeForLine(a);this._model.selectionStart=[0,a.first];this._model.selectionEnd=[this._terminal.cols,a.last];this._model.selectionStartLength=0},a);d.SelectionManager=b},{"./MouseHelper":11,"./SelectionModel":14,"./common/EventEmitter2":23,"./common/Platform":25,"./core/buffer/BufferLine":29,"./handlers/AltClickHandler":35}],14:[function(b,h,d){function a(a){this._terminal=a;this.clearSelection()}
Object.defineProperty(d,"__esModule",{value:!0});b=(a.prototype.clearSelection=function(){this.selectionEnd=this.selectionStart=null;this.isSelectAllActive=!1;this.selectionStartLength=0},Object.defineProperty(a.prototype,"finalSelectionStart",{get:function(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"finalSelectionEnd",{get:function(){if(this.isSelectAllActive)return[this._terminal.cols,
this._terminal.buffer.ybase+this._terminal.rows-1];if(!this.selectionStart)return null;if(this.selectionEnd&&!this.areSelectionValuesReversed())return this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]?[Math.max(this.selectionStart[0]+this.selectionStartLength,this.selectionEnd[0]),this.selectionEnd[1]]:this.selectionEnd;var a=this.selectionStart[0]+this.selectionStartLength;return a>this._terminal.cols?[a%this._terminal.cols,this.selectionStart[1]+Math.floor(a/this._terminal.cols)]:
[a,this.selectionStart[1]]},enumerable:!0,configurable:!0}),a.prototype.areSelectionValuesReversed=function(){var a=this.selectionStart,b=this.selectionEnd;return!(!a||!b)&&(a[1]>b[1]||a[1]===b[1]&&a[0]>b[0])},a.prototype.onTrim=function(a){return this.selectionStart&&(this.selectionStart[1]-=a),this.selectionEnd&&(this.selectionEnd[1]-=a),this.selectionEnd&&0>this.selectionEnd[1]?(this.clearSelection(),!0):(this.selectionStart&&0>this.selectionStart[1]&&(this.selectionStart[1]=0),!1)},a);d.SelectionModel=
b},{}],15:[function(b,h,d){function a(a){this._terminal=a}Object.defineProperty(d,"__esModule",{value:!0});d.DEFAULT_BELL_SOUND="data:audio/wav;base64,UklGRigBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQBAADpAFgCwAMlBZoG/wdmCcoKRAypDQ8PbRDBEQQTOxRtFYcWlBePGIUZXhoiG88bcBz7HHIdzh0WHlMeZx51HmkeUx4WHs8dah0AHXwc3hs9G4saxRnyGBIYGBcQFv8U4RPAEoYRQBACD70NWwwHC6gJOwjWBloF7gOBAhABkf8b/qv8R/ve+Xf4Ife79W/0JfPZ8Z/wde9N7ijtE+wU6xvqM+lb6H7nw+YX5mrlxuQz5Mzje+Ma49fioeKD4nXiYeJy4pHitOL04j/jn+MN5IPkFOWs5U3mDefM55/ogOl36m7rdOyE7abuyu8D8Unyj/Pg9D/2qfcb+Yn6/vuK/Qj/lAAlAg==";
b=(Object.defineProperty(a,"audioContext",{get:function(){if(!a._audioContext){var b=window.AudioContext||window.webkitAudioContext;if(!b)return console.warn("Web Audio API is not supported by this browser. Consider upgrading to the latest version"),null;a._audioContext=new b}return a._audioContext},enumerable:!0,configurable:!0}),a.prototype.playBellSound=function(){var b=a.audioContext;if(b){var d=b.createBufferSource();b.decodeAudioData(this._base64ToArrayBuffer(this._removeMimeType(this._terminal.options.bellSound)),
function(a){d.buffer=a;d.connect(b.destination);d.start(0)})}},a.prototype._base64ToArrayBuffer=function(a){a=window.atob(a);for(var b=a.length,c=new Uint8Array(b),d=0;d<b;d++)c[d]=a.charCodeAt(d);return c.buffer},a.prototype._removeMimeType=function(a){return a.split(",")[1]},a);d.SoundManager=b},{}],16:[function(b,h,d){Object.defineProperty(d,"__esModule",{value:!0});d.blankLine="Blank line";d.promptLabel="Terminal input";d.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},
{}],17:[function(b,h,d){function a(a){void 0===a&&(a={});var b=k.call(this)||this;return b.browser=w,b._blankLine=null,b._onCursorMove=new E.EventEmitter2,b._onData=new E.EventEmitter2,b._onKey=new E.EventEmitter2,b._onLineFeed=new E.EventEmitter2,b._onRender=new E.EventEmitter2,b._onResize=new E.EventEmitter2,b._onScroll=new E.EventEmitter2,b._onSelectionChange=new E.EventEmitter2,b._onTitleChange=new E.EventEmitter2,b.options=M.clone(a),b._setup(),b.onCursorMove(function(){return b.emit("cursormove")}),
b.onData(function(a){return b.emit("data",a)}),b.onKey(function(a){return b.emit("key",a.key,a.domEvent)}),b.onLineFeed(function(){return b.emit("linefeed")}),b.onRender(function(a){return b.emit("refresh",a)}),b.onResize(function(a){return b.emit("resize",a)}),b.onSelectionChange(function(){return b.emit("selection")}),b.onScroll(function(a){return b.emit("scroll",a)}),b.onTitleChange(function(a){return b.emit("title",a)}),b}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||
{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f])})(a,b)},function(a,b){function f(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(f.prototype=b.prototype,new f)});Object.defineProperty(d,"__esModule",{value:!0});var k,m=b("./BufferSet"),p=b("./Buffer"),q=b("./CompositionHelper"),l=b("./common/EventEmitter"),f=b("./Viewport"),g=b("./Clipboard"),n=b("./common/data/EscapeSequences"),u=b("./InputHandler"),r=
b("./renderer/Renderer"),z=b("./Linkifier"),t=b("./SelectionManager"),y=b("./CharMeasure"),w=b("./common/Platform"),v=b("./ui/Lifecycle"),C=b("./Strings"),x=b("./MouseHelper"),A=b("./SoundManager"),F=b("./MouseZoneManager"),G=b("./AccessibilityManager"),K=b("./renderer/atlas/CharAtlasCache"),D=b("./renderer/dom/DomRenderer"),L=b("./core/input/Keyboard"),M=b("./common/Clone"),E=b("./common/EventEmitter2"),I=b("./core/buffer/BufferLine"),J=b("./WindowsMode"),N=b("./ui/ColorManager"),O=b("./renderer/RenderCoordinator"),
B="undefined"!=typeof window?window.document:null,P=["cols","rows"],H={cols:80,rows:24,convertEol:!1,termName:"xterm",cursorBlink:!1,cursorStyle:"block",bellSound:A.DEFAULT_BELL_SOUND,bellStyle:"none",drawBoldTextInBrightColors:!0,enableBold:!0,experimentalCharAtlas:"static",fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,scrollback:1E3,screenKeys:!1,screenReaderMode:!1,debug:!1,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,
cancelEvents:!1,disableStdin:!1,useFlowControl:!1,allowTransparency:!1,tabStopWidth:8,theme:void 0,rightClickSelectsWord:w.isMac,rendererType:"canvas",windowsMode:!1};b=(k=l.EventEmitter,h(a,k),Object.defineProperty(a.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onData",{get:function(){return this._onData.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onKey",{get:function(){return this._onKey.event},
enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!0,
configurable:!0}),Object.defineProperty(a.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){k.prototype.dispose.call(this);this._windowsMode&&(this._windowsMode.dispose(),this._windowsMode=void 0);this._customKeyEventHandler=null;K.removeTerminalFromCache(this);this.handler=
function(){};this.write=function(){};this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)},a.prototype.destroy=function(){this.dispose()},a.prototype._setup=function(){var a=this;Object.keys(H).forEach(function(b){null!==a.options[b]&&void 0!==a.options[b]||(a.options[b]=H[b])});this._parent=B?B.body:null;this.cols=Math.max(this.options.cols,2);this.rows=Math.max(this.options.rows,1);this.options.handler&&this.onData(this.options.handler);this.cursorState=0;this.cursorHidden=
!1;this._customKeyEventHandler=null;this.insertMode=this.originMode=this.applicationCursor=this.applicationKeypad=!1;this.wraparoundMode=!0;this.bracketedPasteMode=!1;this.gcharset=this.charset=null;this.glevel=0;this.charsets=[null];this.curAttrData=I.DEFAULT_ATTR_DATA.clone();this._eraseAttrData=I.DEFAULT_ATTR_DATA.clone();this.params=[];this.currentParam=0;this.writeBuffer=[];this.writeBufferUtf8=[];this._userScrolling=this._xoffSentToCatchUp=this._writeInProgress=!1;this._inputHandler=new u.InputHandler(this);
this._inputHandler.onCursorMove(function(){return a._onCursorMove.fire()});this._inputHandler.onLineFeed(function(){return a._onLineFeed.fire()});this._inputHandler.onData(function(b){return a._onData.fire(b)});this.register(this._inputHandler);this.selectionManager=this.selectionManager||null;this.linkifier=this.linkifier||new z.Linkifier(this);this._mouseZoneManager=this._mouseZoneManager||null;this.soundManager=this.soundManager||new A.SoundManager(this);this.buffers=new m.BufferSet(this);this.selectionManager&&
(this.selectionManager.clearSelection(),this.selectionManager.initBuffersListeners());this.options.windowsMode&&(this._windowsMode=J.applyWindowsMode(this))},Object.defineProperty(a.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!0,configurable:!0}),a.prototype.eraseAttrData=function(){return this._eraseAttrData.bg&=-67108864,this._eraseAttrData.bg|=67108863&this.curAttrData.bg,this._eraseAttrData},a.prototype.focus=function(){this.textarea&&this.textarea.focus({preventScroll:!0})},
Object.defineProperty(a.prototype,"isFocused",{get:function(){return B.activeElement===this.textarea&&B.hasFocus()},enumerable:!0,configurable:!0}),a.prototype.getOption=function(a){if(!(a in H))throw Error('No option with key "'+a+'"');return this.options[a]},a.prototype.setOption=function(a,b){if(!(a in H))throw Error('No option with key "'+a+'"');if(-1!==P.indexOf(a)&&console.error('Option "'+a+'" can only be set in the constructor'),this.options[a]!==b){switch(a){case "bellStyle":b=b||"none";
break;case "cursorStyle":b=b||"block";break;case "fontWeight":b=b||"normal";break;case "fontWeightBold":b=b||"bold";break;case "lineHeight":if(1>b)return void console.warn(a+" cannot be less than 1, value: "+b);case "rendererType":b=b||"canvas";break;case "tabStopWidth":if(1>b)return void console.warn(a+" cannot be less than 1, value: "+b);break;case "theme":this._setTheme(b);break;case "scrollback":if(0>(b=Math.min(b,p.MAX_BUFFER_SIZE)))return void console.warn(a+" cannot be less than 0, value: "+
b);if(this.options[a]!==b){var f=this.rows+b;if(this.buffer.lines.length>f){f=this.buffer.lines.length-f;var g=0>this.buffer.ydisp-f;this.buffer.lines.trimStart(f);this.buffer.ybase=Math.max(this.buffer.ybase-f,0);this.buffer.ydisp=Math.max(this.buffer.ydisp-f,0);g&&this.refresh(0,this.rows-1)}}}switch(this.options[a]=b,a){case "fontFamily":case "fontSize":this._renderCoordinator&&(this._renderCoordinator.clear(),this.charMeasure.measure(this.options));break;case "drawBoldTextInBrightColors":case "experimentalCharAtlas":case "enableBold":case "letterSpacing":case "lineHeight":case "fontWeight":case "fontWeightBold":this._renderCoordinator&&
(this._renderCoordinator.clear(),this._renderCoordinator.onResize(this.cols,this.rows),this.refresh(0,this.rows-1));break;case "rendererType":this._renderCoordinator&&this._renderCoordinator.setRenderer(this._createRenderer());break;case "scrollback":this.buffers.resize(this.cols,this.rows);this.viewport&&this.viewport.syncScrollArea();break;case "screenReaderMode":b?!this._accessibilityManager&&this._renderCoordinator&&(this._accessibilityManager=new G.AccessibilityManager(this,this._renderCoordinator.dimensions)):
this._accessibilityManager&&(this._accessibilityManager.dispose(),this._accessibilityManager=null);break;case "tabStopWidth":this.buffers.setupTabStops();break;case "windowsMode":b?this._windowsMode||(this._windowsMode=J.applyWindowsMode(this)):this._windowsMode&&(this._windowsMode.dispose(),this._windowsMode=void 0)}this._renderCoordinator&&this._renderCoordinator.onOptionsChanged()}},a.prototype._onTextAreaFocus=function(a){this.sendFocus&&this.handler(n.C0.ESC+"[I");this.updateCursorStyle(a);this.element.classList.add("focus");
this.showCursor();this.emit("focus")},a.prototype.blur=function(){return this.textarea.blur()},a.prototype._onTextAreaBlur=function(){this.textarea.value="";this.refresh(this.buffer.y,this.buffer.y);this.sendFocus&&this.handler(n.C0.ESC+"[O");this.element.classList.remove("focus");this.emit("blur")},a.prototype._initGlobal=function(){function a(a){return g.pasteHandler(a,b)}var b=this;this._bindKeys();this.register(v.addDisposableDomListener(this.element,"copy",function(a){b.hasSelection()&&g.copyHandler(a,
b,b.selectionManager)}));this.register(v.addDisposableDomListener(this.textarea,"paste",a));this.register(v.addDisposableDomListener(this.element,"paste",a));w.isFirefox?this.register(v.addDisposableDomListener(this.element,"mousedown",function(a){2===a.button&&g.rightClickHandler(a,b,b.selectionManager,b.options.rightClickSelectsWord)})):this.register(v.addDisposableDomListener(this.element,"contextmenu",function(a){g.rightClickHandler(a,b,b.selectionManager,b.options.rightClickSelectsWord)}));w.isLinux&&
this.register(v.addDisposableDomListener(this.element,"auxclick",function(a){1===a.button&&g.moveTextAreaUnderMouseCursor(a,b)}))},a.prototype._bindKeys=function(){var a=this,b=this;this.register(v.addDisposableDomListener(this.element,"keydown",function(a){B.activeElement===this&&b._keyDown(a)},!0));this.register(v.addDisposableDomListener(this.element,"keypress",function(a){B.activeElement===this&&b._keyPress(a)},!0));this.register(v.addDisposableDomListener(this.element,"keyup",function(f){16!==
f.keyCode&&17!==f.keyCode&&18!==f.keyCode&&a.focus();b._keyUp(f)},!0));this.register(v.addDisposableDomListener(this.textarea,"keydown",function(b){return a._keyDown(b)},!0));this.register(v.addDisposableDomListener(this.textarea,"keypress",function(b){return a._keyPress(b)},!0));this.register(v.addDisposableDomListener(this.textarea,"compositionstart",function(){return a._compositionHelper.compositionstart()}));this.register(v.addDisposableDomListener(this.textarea,"compositionupdate",function(b){return a._compositionHelper.compositionupdate(b)}));
this.register(v.addDisposableDomListener(this.textarea,"compositionend",function(){return a._compositionHelper.compositionend()}));this.register(this.onRender(function(){return a._compositionHelper.updateCompositionElements()}));this.register(this.onRender(function(b){return a._queueLinkification(b.start,b.end)}))},a.prototype.open=function(a){var b=this;if(this._parent=a||this._parent,!this._parent)throw Error("Terminal requires a parent element.");this._context=this._parent.ownerDocument.defaultView;
this._document=this._parent.ownerDocument;this.element=this._document.createElement("div");this.element.dir="ltr";this.element.classList.add("terminal");this.element.classList.add("xterm");this.element.setAttribute("tabindex","0");this._parent.appendChild(this.element);a=B.createDocumentFragment();this._viewportElement=B.createElement("div");this._viewportElement.classList.add("xterm-viewport");a.appendChild(this._viewportElement);this._viewportScrollArea=B.createElement("div");this._viewportScrollArea.classList.add("xterm-scroll-area");
this._viewportElement.appendChild(this._viewportScrollArea);this.screenElement=B.createElement("div");this.screenElement.classList.add("xterm-screen");this._helperContainer=B.createElement("div");this._helperContainer.classList.add("xterm-helpers");this.screenElement.appendChild(this._helperContainer);a.appendChild(this.screenElement);this._mouseZoneManager=new F.MouseZoneManager(this);this.register(this._mouseZoneManager);this.register(this.onScroll(function(){return b._mouseZoneManager.clearAll()}));
this.linkifier.attachToDom(this._mouseZoneManager);this.textarea=B.createElement("textarea");this.textarea.classList.add("xterm-helper-textarea");this.textarea.setAttribute("aria-label",C.promptLabel);this.textarea.setAttribute("aria-multiline","false");this.textarea.setAttribute("autocorrect","off");this.textarea.setAttribute("autocapitalize","off");this.textarea.setAttribute("spellcheck","false");this.textarea.tabIndex=0;this.register(v.addDisposableDomListener(this.textarea,"focus",function(a){return b._onTextAreaFocus(a)}));
this.register(v.addDisposableDomListener(this.textarea,"blur",function(){return b._onTextAreaBlur()}));this._helperContainer.appendChild(this.textarea);this._compositionView=B.createElement("div");this._compositionView.classList.add("composition-view");this._compositionHelper=new q.CompositionHelper(this.textarea,this._compositionView,this);this._helperContainer.appendChild(this._compositionView);this.charMeasure=new y.CharMeasure(B,this._helperContainer);this.element.appendChild(a);this._theme=this.options.theme;
this._colorManager=new N.ColorManager(B,this.options.allowTransparency);this._colorManager.setTheme(this._theme);a=this._createRenderer();this._renderCoordinator=new O.RenderCoordinator(a,this.rows,this.screenElement);this._renderCoordinator.onRender(function(a){return b._onRender.fire(a)});this.onResize(function(a){return b._renderCoordinator.resize(a.cols,a.rows)});this.viewport=new f.Viewport(this,this._viewportElement,this._viewportScrollArea,this.charMeasure,this._renderCoordinator.dimensions);
this.viewport.onThemeChange(this._colorManager.colors);this.register(this.viewport);this.register(this.onCursorMove(function(){return b._renderCoordinator.onCursorMove()}));this.register(this.onResize(function(){return b._renderCoordinator.onResize(b.cols,b.rows)}));this.register(this.addDisposableListener("blur",function(){return b._renderCoordinator.onBlur()}));this.register(this.addDisposableListener("focus",function(){return b._renderCoordinator.onFocus()}));this.register(this.charMeasure.onCharSizeChanged(function(){return b._renderCoordinator.onCharSizeChanged()}));
this.register(this._renderCoordinator.onDimensionsChange(function(){return b.viewport.syncScrollArea()}));this.selectionManager=new t.SelectionManager(this,this.charMeasure);this.register(this.selectionManager.onSelectionChange(function(){return b._onSelectionChange.fire()}));this.register(v.addDisposableDomListener(this.element,"mousedown",function(a){return b.selectionManager.onMouseDown(a)}));this.register(this.selectionManager.onRedrawRequest(function(a){return b._renderCoordinator.onSelectionChanged(a.start,
a.end,a.columnSelectMode)}));this.register(this.selectionManager.onLinuxMouseSelection(function(a){b.textarea.value=a;b.textarea.focus();b.textarea.select()}));this.register(this.onScroll(function(){b.viewport.syncScrollArea();b.selectionManager.refresh()}));this.register(v.addDisposableDomListener(this._viewportElement,"scroll",function(){return b.selectionManager.refresh()}));this.mouseHelper=new x.MouseHelper(this._renderCoordinator);this.element.classList.toggle("enable-mouse-events",this.mouseEvents);
this.mouseEvents?this.selectionManager.disable():this.selectionManager.enable();this.options.screenReaderMode&&(this._accessibilityManager=new G.AccessibilityManager(this,this._renderCoordinator.dimensions),this._accessibilityManager.register(this._renderCoordinator.onDimensionsChange(function(a){return b._accessibilityManager.setDimensions(a)})));this.charMeasure.measure(this.options);this.refresh(0,this.rows-1);this._initGlobal();this.bindMouse()},a.prototype._createRenderer=function(){switch(this.options.rendererType){case "canvas":return new r.Renderer(this,
this._colorManager.colors);case "dom":return new D.DomRenderer(this,this._colorManager.colors);default:throw Error('Unrecognized rendererType "'+this.options.rendererType+'"');}},a.prototype._setTheme=function(a){this._theme=a;this._colorManager&&this._colorManager.setTheme(a);this._renderCoordinator&&this._renderCoordinator.setColors(this._colorManager.colors);this.viewport&&this.viewport.onThemeChange(this._colorManager.colors)},a.prototype.bindMouse=function(){function a(a){var b,g,c,n;switch(a.overrideType||
a.type){case "mousedown":var m=null!==a.button&&void 0!==a.button?+a.button:null!==a.which&&void 0!==a.which?a.which-1:null;w.isMSIE&&(m=1===m?0:4===m?1:m);break;case "mouseup":m=3;break;case "DOMMouseScroll":m=0>a.detail?64:65;break;case "wheel":m=0>a.deltaY?64:65}m=(b=a.shiftKey?4:0,g=a.metaKey?8:0,c=a.ctrlKey?16:0,n=b|g|c,d.vt200Mouse?n&=c:d.normalMouse||(n=0),32+(n<<2)+m);if(b=d.mouseHelper.getRawByteCoords(a,d.screenElement,d.charMeasure,d.cols,d.rows))switch(f(m,b),a.overrideType||a.type){case "mousedown":l=
m;break;case "mouseup":l=32}}function b(a,b){if(d.utfMouse){if(2047<b)return void a.push(2047)}else{if(255===b)return void a.push(0);127<b&&(b=127)}a.push(b)}function f(a,f){if(d._vt300Mouse){a&=3;f.x-=32;f.y-=32;var g=n.C0.ESC+"[24";if(0===a)g+="1";else if(1===a)g+="3";else if(2===a)g+="5";else{if(3===a)return;g+="0"}return g+="~["+f.x+","+f.y+"]\r",void d.handler(g)}if(d._decLocator)return a&=3,f.x-=32,f.y-=32,0===a?a=2:1===a?a=4:2===a?a=6:3===a&&(a=3),void d.handler(n.C0.ESC+"["+a+";"+(3===a?4:
0)+";"+f.y+";"+f.x+";"+f.page||"0&w");if(d.urxvtMouse)return f.x-=32,f.y-=32,f.x++,f.y++,void d.handler(n.C0.ESC+"["+a+";"+f.x+";"+f.y+"M");if(d.sgrMouse)return f.x-=32,f.y-=32,void d.handler(n.C0.ESC+"[<"+((3==(3&a)?-4&a:a)-32)+";"+f.x+";"+f.y+(3==(3&a)?"m":"M"));g=[];b(g,a);b(g,f.x);b(g,f.y);d.handler(n.C0.ESC+"[M"+String.fromCharCode.apply(String,g))}var g=this,c=this.element,d=this,l=32;this.register(v.addDisposableDomListener(c,"mousedown",function(b){if(b.preventDefault(),g.focus(),g.mouseEvents&&
!g.selectionManager.shouldForceSelection(b)){if(a(b),g.vt200Mouse)return b.overrideType="mouseup",a(b),g.cancel(b);var c;g.normalMouse&&(c=function(a){if(g.normalMouse){var b=l;(a=d.mouseHelper.getRawByteCoords(a,d.screenElement,d.charMeasure,d.cols,d.rows))&&f(b+32,a)}},g._document.addEventListener("mousemove",c));var n=function(b){return g.normalMouse&&!g.x10Mouse&&a(b),c&&(g._document.removeEventListener("mousemove",c),c=null),g._document.removeEventListener("mouseup",n),g.cancel(b)};return g._document.addEventListener("mouseup",
n),g.cancel(b)}}));this.register(v.addDisposableDomListener(c,"wheel",function(b){if(g.mouseEvents)g.x10Mouse||g._vt300Mouse||g._decLocator||(a(b),b.preventDefault());else if(!g.buffer.hasScrollback){var f=g.viewport.getLinesScrolled(b);if(0!==f){b=n.C0.ESC+(g.applicationCursor?"O":"[")+(0>b.deltaY?"A":"B");for(var c="",d=0;d<Math.abs(f);d++)c+=b;g.handler(c)}}}));this.register(v.addDisposableDomListener(c,"wheel",function(a){if(!g.mouseEvents)return g.viewport.onWheel(a),g.cancel(a)}));this.register(v.addDisposableDomListener(c,
"touchstart",function(a){if(!g.mouseEvents)return g.viewport.onTouchStart(a),g.cancel(a)}));this.register(v.addDisposableDomListener(c,"touchmove",function(a){if(!g.mouseEvents)return g.viewport.onTouchMove(a),g.cancel(a)}))},a.prototype.refresh=function(a,b){this._renderCoordinator&&this._renderCoordinator.refreshRows(a,b)},a.prototype._queueLinkification=function(a,b){this.linkifier&&this.linkifier.linkifyRows(a,b)},a.prototype.updateCursorStyle=function(a){this.selectionManager&&this.selectionManager.shouldColumnSelect(a)?
this.element.classList.add("column-select"):this.element.classList.remove("column-select")},a.prototype.showCursor=function(){this.cursorState||(this.cursorState=1,this.refresh(this.buffer.y,this.buffer.y))},a.prototype.scroll=function(a){void 0===a&&(a=!1);var b=this._blankLine;var f=this.eraseAttrData();b&&b.length===this.cols&&b.getFg(0)===f.fg&&b.getBg(0)===f.bg||(b=this.buffer.getBlankLine(f,a),this._blankLine=b);b.isWrapped=a;f=this.buffer.ybase+this.buffer.scrollTop;a=this.buffer.ybase+this.buffer.scrollBottom;
0===this.buffer.scrollTop?(f=this.buffer.lines.isFull,a===this.buffer.lines.length-1?f?this.buffer.lines.recycle().copyFrom(b):this.buffer.lines.push(b.clone()):this.buffer.lines.splice(a+1,0,b.clone()),f?this._userScrolling&&(this.buffer.ydisp=Math.max(this.buffer.ydisp-1,0)):(this.buffer.ybase++,this._userScrolling||this.buffer.ydisp++)):(this.buffer.lines.shiftElements(f+1,a-f+1-1,-1),this.buffer.lines.set(a,b.clone()));this._userScrolling||(this.buffer.ydisp=this.buffer.ybase);this.updateRange(this.buffer.scrollTop);
this.updateRange(this.buffer.scrollBottom);this._onScroll.fire(this.buffer.ydisp)},a.prototype.scrollLines=function(a,b){if(0>a){if(0===this.buffer.ydisp)return;this._userScrolling=!0}else a+this.buffer.ydisp>=this.buffer.ybase&&(this._userScrolling=!1);var f=this.buffer.ydisp;this.buffer.ydisp=Math.max(Math.min(this.buffer.ydisp+a,this.buffer.ybase),0);f!==this.buffer.ydisp&&(b||this._onScroll.fire(this.buffer.ydisp),this.refresh(0,this.rows-1))},a.prototype.scrollPages=function(a){this.scrollLines(a*
(this.rows-1))},a.prototype.scrollToTop=function(){this.scrollLines(-this.buffer.ydisp)},a.prototype.scrollToBottom=function(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)},a.prototype.scrollToLine=function(a){a-=this.buffer.ydisp;0!=a&&this.scrollLines(a)},a.prototype.writeUtf8=function(a){var b=this;this._isDisposed||a&&(this.writeBufferUtf8.push(a),this.options.useFlowControl&&!this._xoffSentToCatchUp&&5<=this.writeBufferUtf8.length&&(this.handler(n.C0.DC3),this._xoffSentToCatchUp=!0),
!this._writeInProgress&&0<this.writeBufferUtf8.length&&(this._writeInProgress=!0,setTimeout(function(){b._innerWriteUtf8()})))},a.prototype._innerWriteUtf8=function(a){var b=this;void 0===a&&(a=0);this._isDisposed&&(this.writeBufferUtf8=[]);for(var f=Date.now();this.writeBufferUtf8.length>a;){var g=this.writeBufferUtf8[a];if(a++,this._xoffSentToCatchUp&&this.writeBufferUtf8.length===a&&(this.handler(n.C0.DC1),this._xoffSentToCatchUp=!1),this._refreshStart=this.buffer.y,this._refreshEnd=this.buffer.y,
this._inputHandler.parseUtf8(g),this.updateRange(this.buffer.y),this.refresh(this._refreshStart,this._refreshEnd),12<=Date.now()-f)break}this.writeBufferUtf8.length>a?(50<a&&(this.writeBufferUtf8=this.writeBufferUtf8.slice(a),a=0),setTimeout(function(){return b._innerWriteUtf8(a)},0)):(this._writeInProgress=!1,this.writeBufferUtf8=[])},a.prototype.write=function(a){var b=this;this._isDisposed||a&&(this.writeBuffer.push(a),this.options.useFlowControl&&!this._xoffSentToCatchUp&&5<=this.writeBuffer.length&&
(this.handler(n.C0.DC3),this._xoffSentToCatchUp=!0),!this._writeInProgress&&0<this.writeBuffer.length&&(this._writeInProgress=!0,setTimeout(function(){b._innerWrite()})))},a.prototype._innerWrite=function(a){var b=this;void 0===a&&(a=0);this._isDisposed&&(this.writeBuffer=[]);for(var f=Date.now();this.writeBuffer.length>a;){var g=this.writeBuffer[a];if(a++,this._xoffSentToCatchUp&&this.writeBuffer.length===a&&(this.handler(n.C0.DC1),this._xoffSentToCatchUp=!1),this._refreshStart=this.buffer.y,this._refreshEnd=
this.buffer.y,this._inputHandler.parse(g),this.updateRange(this.buffer.y),this.refresh(this._refreshStart,this._refreshEnd),12<=Date.now()-f)break}this.writeBuffer.length>a?(50<a&&(this.writeBuffer=this.writeBuffer.slice(a),a=0),setTimeout(function(){return b._innerWrite(a)},0)):(this._writeInProgress=!1,this.writeBuffer=[])},a.prototype.writeln=function(a){this.write(a+"\r\n")},a.prototype.attachCustomKeyEventHandler=function(a){this._customKeyEventHandler=a},a.prototype.addCsiHandler=function(a,
b){return this._inputHandler.addCsiHandler(a,b)},a.prototype.addOscHandler=function(a,b){return this._inputHandler.addOscHandler(a,b)},a.prototype.registerLinkMatcher=function(a,b,f){a=this.linkifier.registerLinkMatcher(a,b,f);return this.refresh(0,this.rows-1),a},a.prototype.deregisterLinkMatcher=function(a){this.linkifier.deregisterLinkMatcher(a)&&this.refresh(0,this.rows-1)},a.prototype.registerCharacterJoiner=function(a){a=this._renderCoordinator.registerCharacterJoiner(a);return this.refresh(0,
this.rows-1),a},a.prototype.deregisterCharacterJoiner=function(a){this._renderCoordinator.deregisterCharacterJoiner(a)&&this.refresh(0,this.rows-1)},Object.defineProperty(a.prototype,"markers",{get:function(){return this.buffer.markers},enumerable:!0,configurable:!0}),a.prototype.addMarker=function(a){if(this.buffer===this.buffers.normal)return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+a)},a.prototype.hasSelection=function(){return!!this.selectionManager&&this.selectionManager.hasSelection},
a.prototype.select=function(a,b,f){this.selectionManager.setSelection(a,b,f)},a.prototype.getSelection=function(){return this.selectionManager?this.selectionManager.selectionText:""},a.prototype.getSelectionPosition=function(){if(this.selectionManager.hasSelection)return{startColumn:this.selectionManager.selectionStart[0],startRow:this.selectionManager.selectionStart[1],endColumn:this.selectionManager.selectionEnd[0],endRow:this.selectionManager.selectionEnd[1]}},a.prototype.clearSelection=function(){this.selectionManager&&
this.selectionManager.clearSelection()},a.prototype.selectAll=function(){this.selectionManager&&this.selectionManager.selectAll()},a.prototype.selectLines=function(a,b){this.selectionManager&&this.selectionManager.selectLines(a,b)},a.prototype._keyDown=function(a){if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(a))return!1;if(!this._compositionHelper.keydown(a))return this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;var b=L.evaluateKeyboardEvent(a,this.applicationCursor,
this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(a),3!==b.type&&2!==b.type)return 1===b.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,a)||(b.cancel&&this.cancel(a,!0),!b.key||(this.emit("keydown",a),this._onKey.fire({key:b.key,domEvent:a}),this.showCursor(),this.handler(b.key),this.cancel(a,!0)));var f=this.rows-1;return this.scrollLines(2===b.type?-f:f),this.cancel(a,!0)},a.prototype._isThirdLevelShift=function(a,b){a=a.isMac&&!this.options.macOptionIsMeta&&
b.altKey&&!b.ctrlKey&&!b.metaKey||a.isMSWindows&&b.altKey&&b.ctrlKey&&!b.metaKey;return"keypress"===b.type?a:a&&(!b.keyCode||47<b.keyCode)},a.prototype.setgLevel=function(a){this.glevel=a;this.charset=this.charsets[a]},a.prototype.setgCharset=function(a,b){this.charsets[a]=b;this.glevel===a&&(this.charset=b)},a.prototype._keyUp=function(a){this.updateCursorStyle(a)},a.prototype._keyPress=function(a){if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(a))return!1;if(this.cancel(a),a.charCode)var b=
a.charCode;else if(null===a.which||void 0===a.which)b=a.keyCode;else{if(0===a.which||0===a.charCode)return!1;b=a.which}return!(!b||(a.altKey||a.ctrlKey||a.metaKey)&&!this._isThirdLevelShift(this.browser,a)||(b=String.fromCharCode(b),this.emit("keypress",b,a),this._onKey.fire({key:b,domEvent:a}),this.showCursor(),this.handler(b),0))},a.prototype.bell=function(){var a=this;this.emit("bell");this._soundBell()&&this.soundManager.playBellSound();this._visualBell()&&(this.element.classList.add("visual-bell-active"),
clearTimeout(this._visualBellTimer),this._visualBellTimer=window.setTimeout(function(){a.element.classList.remove("visual-bell-active")},200))},a.prototype.log=function(a,b){this.options.debug&&this._context.console&&this._context.console.log&&this._context.console.log(a,b)},a.prototype.error=function(a,b){this.options.debug&&this._context.console&&this._context.console.error&&this._context.console.error(a,b)},a.prototype.resize=function(a,b){isNaN(a)||isNaN(b)||(a!==this.cols||b!==this.rows?(2>a&&
(a=2),1>b&&(b=1),this.buffers.resize(a,b),this.cols=a,this.rows=b,this.buffers.setupTabStops(this.cols),this.charMeasure&&this.charMeasure.measure(this.options),this.refresh(0,this.rows-1),this._onResize.fire({cols:a,rows:b})):!this.charMeasure||this.charMeasure.width&&this.charMeasure.height||this.charMeasure.measure(this.options))},a.prototype.updateRange=function(a){a<this._refreshStart&&(this._refreshStart=a);a>this._refreshEnd&&(this._refreshEnd=a)},a.prototype.maxRange=function(){this._refreshStart=
0;this._refreshEnd=this.rows-1},a.prototype.clear=function(){if(0!==this.buffer.ybase||0!==this.buffer.y){this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y));this.buffer.lines.length=1;this.buffer.ydisp=0;this.buffer.ybase=0;this.buffer.y=0;for(var a=1;a<this.rows;a++)this.buffer.lines.push(this.buffer.getBlankLine(I.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1);this._onScroll.fire(this.buffer.ydisp)}},a.prototype.is=function(a){return 0===(this.options.termName+"").indexOf(a)},
a.prototype.handler=function(a){this.options.disableStdin||(this.selectionManager&&this.selectionManager.hasSelection&&this.selectionManager.clearSelection(),this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),this._onData.fire(a))},a.prototype.handleTitle=function(a){this._onTitleChange.fire(a)},a.prototype.index=function(){this.buffer.y++;this.buffer.y>this.buffer.scrollBottom&&(this.buffer.y--,this.scroll());this.buffer.x>=this.cols&&this.buffer.x--},a.prototype.reverseIndex=function(){this.buffer.y===
this.buffer.scrollTop?(this.buffer.lines.shiftElements(this.buffer.y+this.buffer.ybase,this.buffer.scrollBottom-this.buffer.scrollTop,1),this.buffer.lines.set(this.buffer.y+this.buffer.ybase,this.buffer.getBlankLine(this.eraseAttrData())),this.updateRange(this.buffer.scrollTop),this.updateRange(this.buffer.scrollBottom)):this.buffer.y--},a.prototype.reset=function(){this.options.rows=this.rows;this.options.cols=this.cols;var a=this._customKeyEventHandler,b=this._inputHandler,f=this.cursorState,g=
this.writeBuffer,c=this.writeBufferUtf8,d=this._writeInProgress,n=this._xoffSentToCatchUp,l=this._userScrolling;this._setup();this._customKeyEventHandler=a;this._inputHandler=b;this.cursorState=f;this.writeBuffer=g;this.writeBufferUtf8=c;this._writeInProgress=d;this._xoffSentToCatchUp=n;this._userScrolling=l;this.refresh(0,this.rows-1);this.viewport&&this.viewport.syncScrollArea()},a.prototype.tabSet=function(){this.buffer.tabs[this.buffer.x]=!0},a.prototype.cancel=function(a,b){if(this.options.cancelEvents||
b)return a.preventDefault(),a.stopPropagation(),!1},a.prototype._visualBell=function(){return!1},a.prototype._soundBell=function(){return"sound"===this.options.bellStyle},a);d.Terminal=b},{"./AccessibilityManager":1,"./Buffer":2,"./BufferSet":3,"./CharMeasure":4,"./Clipboard":6,"./CompositionHelper":7,"./InputHandler":9,"./Linkifier":10,"./MouseHelper":11,"./MouseZoneManager":12,"./SelectionManager":13,"./SoundManager":15,"./Strings":16,"./Viewport":18,"./WindowsMode":19,"./common/Clone":21,"./common/EventEmitter":22,
"./common/EventEmitter2":23,"./common/Platform":25,"./common/data/EscapeSequences":28,"./core/buffer/BufferLine":29,"./core/input/Keyboard":33,"./renderer/RenderCoordinator":43,"./renderer/Renderer":44,"./renderer/atlas/CharAtlasCache":48,"./renderer/dom/DomRenderer":56,"./ui/ColorManager":58,"./ui/Lifecycle":59}],18:[function(b,h,d){function a(a,b,f,g,c){var d=k.call(this)||this;return d._terminal=a,d._viewportElement=b,d._scrollArea=f,d._charMeasure=g,d._dimensions=c,d.scrollBarWidth=0,d._currentRowHeight=
0,d._lastRecordedBufferLength=0,d._lastRecordedViewportHeight=0,d._lastRecordedBufferHeight=0,d._lastScrollTop=0,d._wheelPartialScroll=0,d._refreshAnimationFrame=null,d._ignoreNextScrollEvent=!1,d.scrollBarWidth=d._viewportElement.offsetWidth-d._scrollArea.offsetWidth||15,d.register(p.addDisposableDomListener(d._viewportElement,"scroll",d._onScroll.bind(d))),setTimeout(function(){return d.syncScrollArea()},0),d}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,b){a.__proto__=b}||function(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f])})(a,b)},function(a,b){function f(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(f.prototype=b.prototype,new f)});Object.defineProperty(d,"__esModule",{value:!0});var k,m=b("./common/Lifecycle"),p=b("./ui/Lifecycle");b=(k=m.Disposable,h(a,k),a.prototype.onDimensionsChance=function(a){this._dimensions=a},a.prototype.onThemeChange=function(a){this._viewportElement.style.backgroundColor=
a.background.css},a.prototype._refresh=function(){var a=this;null===this._refreshAnimationFrame&&(this._refreshAnimationFrame=requestAnimationFrame(function(){return a._innerRefresh()}))},a.prototype._innerRefresh=function(){if(0<this._charMeasure.height){this._currentRowHeight=this._dimensions.scaledCellHeight/window.devicePixelRatio;this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;var a=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-
this._dimensions.canvasHeight);this._lastRecordedBufferHeight!==a&&(this._lastRecordedBufferHeight=a,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}a=this._terminal.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==a&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=a);this._refreshAnimationFrame=null},a.prototype.syncScrollArea=function(){if(this._lastRecordedBufferLength!==this._terminal.buffer.lines.length)return this._lastRecordedBufferLength=
this._terminal.buffer.lines.length,void this._refresh();this._lastRecordedViewportHeight===this._dimensions.canvasHeight?this._lastScrollTop===this._terminal.buffer.ydisp*this._currentRowHeight&&this._lastScrollTop===this._viewportElement.scrollTop&&this._dimensions.scaledCellHeight/window.devicePixelRatio===this._currentRowHeight||this._refresh():this._refresh()},a.prototype._onScroll=function(a){if(this._lastScrollTop=this._viewportElement.scrollTop,this._viewportElement.offsetParent)this._ignoreNextScrollEvent?
this._ignoreNextScrollEvent=!1:this._terminal.scrollLines(Math.round(this._lastScrollTop/this._currentRowHeight)-this._terminal.buffer.ydisp,!0)},a.prototype.onWheel=function(a){var b=this._getPixelsScrolled(a);0!==b&&(this._viewportElement.scrollTop+=b,a.preventDefault())},a.prototype._getPixelsScrolled=function(a){if(0===a.deltaY)return 0;var b=a.deltaY;return a.deltaMode===WheelEvent.DOM_DELTA_LINE?b*=this._currentRowHeight:a.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(b*=this._currentRowHeight*this._terminal.rows),
b},a.prototype.getLinesScrolled=function(a){if(0===a.deltaY)return 0;var b=a.deltaY;return a.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(b/=this._currentRowHeight+0,this._wheelPartialScroll+=b,b=Math.floor(Math.abs(this._wheelPartialScroll))*(0<this._wheelPartialScroll?1:-1),this._wheelPartialScroll%=1):a.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(b*=this._terminal.rows),b},a.prototype.onTouchStart=function(a){this._lastTouchY=a.touches[0].pageY},a.prototype.onTouchMove=function(a){var b=this._lastTouchY-
a.touches[0].pageY;this._lastTouchY=a.touches[0].pageY;0!=b&&(this._viewportElement.scrollTop+=b,a.preventDefault())},a);d.Viewport=b},{"./common/Lifecycle":24,"./ui/Lifecycle":59}],19:[function(b,h,d){Object.defineProperty(d,"__esModule",{value:!0});var a=b("./core/buffer/BufferLine");d.applyWindowsMode=function(b){return b.onLineFeed(function(){var c=b.buffer.lines.get(b.buffer.ybase+b.buffer.y-1).get(b.cols-1);b.buffer.lines.get(b.buffer.ybase+b.buffer.y).isWrapped=c[a.CHAR_DATA_CODE_INDEX]!==
a.NULL_CELL_CODE&&c[a.CHAR_DATA_CODE_INDEX]!==a.WHITESPACE_CELL_CODE})}},{"./core/buffer/BufferLine":29}],20:[function(b,h,d){function a(a){this._maxLength=a;this.onDeleteEmitter=new c.EventEmitter2;this.onInsertEmitter=new c.EventEmitter2;this.onTrimEmitter=new c.EventEmitter2;this._array=Array(this._maxLength);this._length=this._startIndex=0}Object.defineProperty(d,"__esModule",{value:!0});var c=b("./EventEmitter2");b=(Object.defineProperty(a.prototype,"onDelete",{get:function(){return this.onDeleteEmitter.event},
enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onInsert",{get:function(){return this.onInsertEmitter.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTrim",{get:function(){return this.onTrimEmitter.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"maxLength",{get:function(){return this._maxLength},set:function(a){if(this._maxLength!==a){for(var b=Array(a),c=0;c<Math.min(a,this.length);c++)b[c]=this._array[this._getCyclicIndex(c)];
this._array=b;this._maxLength=a;this._startIndex=0}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"length",{get:function(){return this._length},set:function(a){if(a>this._length)for(var b=this._length;b<a;b++)this._array[b]=void 0;this._length=a},enumerable:!0,configurable:!0}),a.prototype.get=function(a){return this._array[this._getCyclicIndex(a)]},a.prototype.set=function(a,b){this._array[this._getCyclicIndex(a)]=b},a.prototype.push=function(a){this._array[this._getCyclicIndex(this._length)]=
a;this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++},a.prototype.recycle=function(){if(this._length!==this._maxLength)throw Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]},Object.defineProperty(a.prototype,"isFull",{get:function(){return this._length===this._maxLength},enumerable:!0,configurable:!0}),
a.prototype.pop=function(){return this._array[this._getCyclicIndex(this._length-- -1)]},a.prototype.splice=function(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];if(b){for(d=a;d<this._length-b;d++)this._array[this._getCyclicIndex(d)]=this._array[this._getCyclicIndex(d+b)];this._length-=b}for(d=this._length-1;a<=d;d--)this._array[this._getCyclicIndex(d+c.length)]=this._array[this._getCyclicIndex(d)];for(d=0;d<c.length;d++)this._array[this._getCyclicIndex(a+d)]=c[d];this._length+
c.length>this._maxLength?(c=this._length+c.length-this._maxLength,this._startIndex+=c,this._length=this._maxLength,this.onTrimEmitter.fire(c)):this._length+=c.length},a.prototype.trimStart=function(a){a>this._length&&(a=this._length);this._startIndex+=a;this._length-=a;this.onTrimEmitter.fire(a)},a.prototype.shiftElements=function(a,b,c){if(!(0>=b)){if(0>a||a>=this._length)throw Error("start argument out of range");if(0>a+c)throw Error("Cannot shift elements in list beyond index 0");if(0<c){for(var d=
b-1;0<=d;d--)this.set(a+d+c,this.get(a+d));a=a+b+c-this._length;if(0<a)for(this._length+=a;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(d=0;d<b;d++)this.set(a+d+c,this.get(a+d))}},a.prototype._getCyclicIndex=function(a){return(this._startIndex+a)%this._maxLength},a);d.CircularList=b},{"./EventEmitter2":23}],21:[function(b,h,d){Object.defineProperty(d,"__esModule",{value:!0});d.clone=function m(b,d){if(void 0===d&&(d=5),"object"!=typeof b)return b;
if(null===b)return null;var c=Array.isArray(b)?[]:{},k;for(k in b)c[k]=1>=d?b[k]:m(b[k],d-1);return c}},{}],22:[function(b,h,d){function a(){var a=k.call(this)||this;return a._events=a._events||{},a}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f])})(a,b)},function(a,b){function d(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):
(d.prototype=b.prototype,new d)});Object.defineProperty(d,"__esModule",{value:!0});var k;b=(k=b("./Lifecycle").Disposable,h(a,k),a.prototype.on=function(a,b){this._events[a]=this._events[a]||[];this._events[a].push(b)},a.prototype.addDisposableListener=function(a,b){var c=this;this.on(a,b);var d=!1;return{dispose:function(){d||(c.off(a,b),d=!0)}}},a.prototype.off=function(a,b){if(this._events[a]){a=this._events[a];for(var c=a.length;c--;)if(a[c]===b)return void a.splice(c,1)}},a.prototype.removeAllListeners=
function(a){this._events[a]&&delete this._events[a]},a.prototype.emit=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];if(this._events[a]){c=this._events[a];for(var d=0;d<c.length;d++)c[d].apply(this,b)}},a.prototype.emitMayRemoveListeners=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];if(this._events[a]){c=this._events[a];for(var d=c.length,f=0;f<c.length;f++)c[f].apply(this,b),f-=d-c.length,d=c.length}},a.prototype.listeners=function(a){return this._events[a]||
[]},a.prototype.dispose=function(){k.prototype.dispose.call(this);this._events={}},a);d.EventEmitter=b},{"./Lifecycle":24}],23:[function(b,h,d){function a(){this._listeners=[]}Object.defineProperty(d,"__esModule",{value:!0});b=(Object.defineProperty(a.prototype,"event",{get:function(){var a=this;return this._event||(this._event=function(b){return a._listeners.push(b),{dispose:function(){for(var c=0;c<a._listeners.length;c++)if(a._listeners[c]===b)return void a._listeners.splice(c,1)}}}),this._event},
enumerable:!0,configurable:!0}),a.prototype.fire=function(a){for(var b=[],c=0;c<this._listeners.length;c++)b.push(this._listeners[c]);for(c=0;c<b.length;c++)b[c].call(void 0,a)},a);d.EventEmitter2=b},{}],24:[function(b,h,d){function a(){this._disposables=[];this._isDisposed=!1}Object.defineProperty(d,"__esModule",{value:!0});b=(a.prototype.dispose=function(){this._isDisposed=!0;this._disposables.forEach(function(a){return a.dispose()});this._disposables.length=0},a.prototype.register=function(a){this._disposables.push(a)},
a.prototype.unregister=function(a){a=this._disposables.indexOf(a);-1!==a&&this._disposables.splice(a,1)},a);d.Disposable=b},{}],25:[function(b,h,d){Object.defineProperty(d,"__esModule",{value:!0});h=(b="undefined"==typeof navigator)?"node":navigator.userAgent;b=b?"node":navigator.platform;d.isFirefox=!!~h.indexOf("Firefox");d.isSafari=/^((?!chrome|android).)*safari/i.test(h);d.isMSIE=!!~h.indexOf("MSIE")||!!~h.indexOf("Trident");h=0<=["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(b);d.isMac=h;
d.isIpad="iPad"===b;d.isIphone="iPhone"===b;h=0<=["Windows","Win16","Win32","WinCE"].indexOf(b);d.isMSWindows=h;d.isLinux=0<=b.indexOf("Linux")},{}],26:[function(b,h,d){function a(a,b,d,h){if(void 0===d&&(d=0),void 0===h&&(h=a.length),d>=a.length)return a;d=(a.length+d)%a.length;for(h=h>=a.length?a.length:(a.length+h)%a.length;d<h;++d)a[d]=b;return a}Object.defineProperty(d,"__esModule",{value:!0});d.fill=function(b,d,m,h){return b.fill?b.fill(d,m,h):a(b,d,m,h)};d.fillFallback=a;d.concat=function(a,
b){var c=new a.constructor(a.length+b.length);return c.set(a),c.set(b,a.length),c}},{}],27:[function(b,h,d){Object.defineProperty(d,"__esModule",{value:!0});d.DEFAULT_COLOR=256},{}],28:[function(b,h,d){Object.defineProperty(d,"__esModule",{value:!0});(b=d.C0||(d.C0={})).NUL="\x00";b.SOH="\u0001";b.STX="\u0002";b.ETX="\u0003";b.EOT="\u0004";b.ENQ="\u0005";b.ACK="\u0006";b.BEL="\u0007";b.BS="\b";b.HT="\t";b.LF="\n";b.VT="\v";b.FF="\f";b.CR="\r";b.SO="\u000e";b.SI="\u000f";b.DLE="\u0010";b.DC1="\u0011";
b.DC2="\u0012";b.DC3="\u0013";b.DC4="\u0014";b.NAK="\u0015";b.SYN="\u0016";b.ETB="\u0017";b.CAN="\u0018";b.EM="\u0019";b.SUB="\u001a";b.ESC="\u001b";b.FS="\u001c";b.GS="\u001d";b.RS="\u001e";b.US="\u001f";b.SP=" ";b.DEL="\u007f";(d=d.C1||(d.C1={})).PAD="\u0080";d.HOP="\u0081";d.BPH="\u0082";d.NBH="\u0083";d.IND="\u0084";d.NEL="\u0085";d.SSA="\u0086";d.ESA="\u0087";d.HTS="\u0088";d.HTJ="\u0089";d.VTS="\u008a";d.PLD="\u008b";d.PLU="\u008c";d.RI="\u008d";d.SS2="\u008e";d.SS3="\u008f";d.DCS="\u0090";
d.PU1="\u0091";d.PU2="\u0092";d.STS="\u0093";d.CCH="\u0094";d.MW="\u0095";d.SPA="\u0096";d.EPA="\u0097";d.SOS="\u0098";d.SGCI="\u0099";d.SCI="\u009a";d.CSI="\u009b";d.ST="\u009c";d.OSC="\u009d";d.PM="\u009e";d.APC="\u009f"},{}],29:[function(b,h,d){function a(){this.bg=this.fg=0}function c(){var a=null!==q&&q.apply(this,arguments)||this;return a.content=0,a.fg=0,a.bg=0,a.combinedData="",a}function k(a,b,c){void 0===c&&(c=!1);this.isWrapped=c;this._combined={};this._data=new Uint32Array(3*a);b=b||l.fromCharData([0,
d.NULL_CELL_CHAR,d.NULL_CELL_WIDTH,d.NULL_CELL_CODE]);for(c=0;c<a;++c)this.setCell(c,b);this.length=a}var m;h=this&&this.__extends||(m=function(a,b){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f])})(a,b)},function(a,b){function f(){this.constructor=a}m(a,b);a.prototype=null===b?Object.create(b):(f.prototype=b.prototype,new f)});Object.defineProperty(d,"__esModule",{value:!0});var p=b("../input/TextDecoder");
b=b("../../common/Types");d.DEFAULT_ATTR=256|b.DEFAULT_COLOR<<9;d.CHAR_DATA_ATTR_INDEX=0;d.CHAR_DATA_CHAR_INDEX=1;d.CHAR_DATA_WIDTH_INDEX=2;d.CHAR_DATA_CODE_INDEX=3;d.NULL_CELL_CHAR="";d.NULL_CELL_WIDTH=1;d.NULL_CELL_CODE=0;d.WHITESPACE_CELL_CHAR=" ";d.WHITESPACE_CELL_WIDTH=1;d.WHITESPACE_CELL_CODE=32;b=(a.toColorRGB=function(a){return[a>>>16&255,a>>>8&255,255&a]},a.fromColorRGB=function(a){return(255&a[0])<<16|(255&a[1])<<8|255&a[2]},a.prototype.clone=function(){var b=new a;return b.fg=this.fg,b.bg=
this.bg,b},a.prototype.isInverse=function(){return 67108864&this.fg},a.prototype.isBold=function(){return 134217728&this.fg},a.prototype.isUnderline=function(){return 268435456&this.fg},a.prototype.isBlink=function(){return 536870912&this.fg},a.prototype.isInvisible=function(){return 1073741824&this.fg},a.prototype.isItalic=function(){return 67108864&this.bg},a.prototype.isDim=function(){return 134217728&this.bg},a.prototype.getFgColorMode=function(){return 50331648&this.fg},a.prototype.getBgColorMode=
function(){return 50331648&this.bg},a.prototype.isFgRGB=function(){return 50331648==(50331648&this.fg)},a.prototype.isBgRGB=function(){return 50331648==(50331648&this.bg)},a.prototype.isFgPalette=function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)},a.prototype.isBgPalette=function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)},a.prototype.isFgDefault=function(){return 0==(50331648&this.fg)},a.prototype.isBgDefault=function(){return 0==(50331648&this.bg)},
a.prototype.getFgColor=function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}},a.prototype.getBgColor=function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}},a);d.AttributeData=b;d.DEFAULT_ATTR_DATA=Object.freeze(new b);var q,l=(h(c,q=b),c.fromCharData=function(a){var b=new c;return b.setFromCharData(a),b},c.prototype.isCombined=function(){return 2097152&
this.content},c.prototype.getWidth=function(){return this.content>>22},c.prototype.getChars=function(){return 2097152&this.content?this.combinedData:2097151&this.content?p.stringFromCodePoint(2097151&this.content):""},c.prototype.getCode=function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content},c.prototype.setFromCharData=function(a){this.fg=a[d.CHAR_DATA_ATTR_INDEX];this.bg=0;var b=!1;if(2<a[d.CHAR_DATA_CHAR_INDEX].length)b=!0;else if(2===
a[d.CHAR_DATA_CHAR_INDEX].length){var f=a[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=f&&56319>=f){var c=a[d.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=c&&57343>=c?this.content=1024*(f-55296)+c-56320+65536|a[d.CHAR_DATA_WIDTH_INDEX]<<22:b=!0}else b=!0}else this.content=a[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|a[d.CHAR_DATA_WIDTH_INDEX]<<22;b&&(this.combinedData=a[d.CHAR_DATA_CHAR_INDEX],this.content=2097152|a[d.CHAR_DATA_WIDTH_INDEX]<<22)},c.prototype.getAsCharData=function(){return[this.fg,this.getChars(),
this.getWidth(),this.getCode()]},c);d.CellData=l;h=(k.prototype.get=function(a){var b=this._data[3*a],f=2097151&b;return[this._data[3*a+1],2097152&b?this._combined[a]:f?p.stringFromCodePoint(f):"",b>>22,2097152&b?this._combined[a].charCodeAt(this._combined[a].length-1):f]},k.prototype.set=function(a,b){this._data[3*a+1]=b[d.CHAR_DATA_ATTR_INDEX];1<b[d.CHAR_DATA_CHAR_INDEX].length?(this._combined[a]=b[1],this._data[3*a]=2097152|a|b[d.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*a]=b[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|
b[d.CHAR_DATA_WIDTH_INDEX]<<22},k.prototype.getWidth=function(a){return this._data[3*a]>>22},k.prototype.hasWidth=function(a){return 12582912&this._data[3*a]},k.prototype.getFg=function(a){return this._data[3*a+1]},k.prototype.getBg=function(a){return this._data[3*a+2]},k.prototype.hasContent=function(a){return 4194303&this._data[3*a]},k.prototype.getCodePoint=function(a){var b=this._data[3*a];return 2097152&b?this._combined[a].charCodeAt(this._combined[a].length-1):2097151&b},k.prototype.isCombined=
function(a){return 2097152&this._data[3*a]},k.prototype.getString=function(a){var b=this._data[3*a];return 2097152&b?this._combined[a]:2097151&b?p.stringFromCodePoint(2097151&b):""},k.prototype.loadCell=function(a,b){var f=3*a;return b.content=this._data[0+f],b.fg=this._data[1+f],b.bg=this._data[2+f],2097152&b.content&&(b.combinedData=this._combined[a]),b},k.prototype.setCell=function(a,b){2097152&b.content&&(this._combined[a]=b.combinedData);this._data[3*a]=b.content;this._data[3*a+1]=b.fg;this._data[3*
a+2]=b.bg},k.prototype.setCellFromCodePoint=function(a,b,c,d,l){this._data[3*a]=b|c<<22;this._data[3*a+1]=d;this._data[3*a+2]=l},k.prototype.addCodepointToCell=function(a,b){var f=this._data[3*a];2097152&f?this._combined[a]+=p.stringFromCodePoint(b):(2097151&f?(this._combined[a]=p.stringFromCodePoint(2097151&f)+p.stringFromCodePoint(b),f&=-2097152,f|=2097152):f=b|4194304,this._data[3*a]=f)},k.prototype.insertCells=function(a,b,c){if(a%=this.length,b<this.length-a){for(var f=new l,g=this.length-a-
b-1;0<=g;--g)this.setCell(a+b+g,this.loadCell(a+g,f));for(g=0;g<b;++g)this.setCell(a+g,c)}else for(g=a;g<this.length;++g)this.setCell(g,c)},k.prototype.deleteCells=function(a,b,c){if(a%=this.length,b<this.length-a){for(var f=new l,g=0;g<this.length-a-b;++g)this.setCell(a+g,this.loadCell(a+b+g,f));g=this.length-b}else g=a;for(;g<this.length;++g)this.setCell(g,c)},k.prototype.replaceCells=function(a,b,c){for(;a<b&&a<this.length;)this.setCell(a++,c)},k.prototype.resize=function(a,b){if(a!==this.length){if(a>
this.length){var f=new Uint32Array(3*a);this.length&&(3*a<this._data.length?f.set(this._data.subarray(0,3*a)):f.set(this._data));this._data=f;for(f=this.length;f<a;++f)this.setCell(f,b)}else if(a)for((f=new Uint32Array(3*a)).set(this._data.subarray(0,3*a)),this._data=f,b=Object.keys(this._combined),f=0;f<b.length;f++){var c=parseInt(b[f],10);a<=c&&delete this._combined[c]}else this._data=new Uint32Array(0),this._combined={};this.length=a}},k.prototype.fill=function(a){this._combined={};for(var b=
0;b<this.length;++b)this.setCell(b,a)},k.prototype.copyFrom=function(a){for(var b in this.length!==a.length?this._data=new Uint32Array(a._data):this._data.set(a._data),this.length=a.length,this._combined={},a._combined)this._combined[b]=a._combined[b];this.isWrapped=a.isWrapped},k.prototype.clone=function(){var a=new k(0),b;for(b in a._data=new Uint32Array(this._data),a.length=this.length,this._combined)a._combined[b]=this._combined[b];return a.isWrapped=this.isWrapped,a},k.prototype.getTrimmedLength=
function(){for(var a=this.length-1;0<=a;--a)if(4194303&this._data[3*a])return a+(this._data[3*a]>>22);return 0},k.prototype.copyCellsFrom=function(a,b,c,d,l){var f=a._data;if(l)for(var g=d-1;0<=g;g--)for(l=0;3>l;l++)this._data[3*(c+g)+l]=f[3*(b+g)+l];else for(g=0;g<d;g++)for(l=0;3>l;l++)this._data[3*(c+g)+l]=f[3*(b+g)+l];d=Object.keys(a._combined);for(l=0;l<d.length;l++)f=parseInt(d[l],10),b<=f&&(this._combined[f-b+c]=a._combined[f])},k.prototype.translateToString=function(a,b,c){void 0===a&&(a=!1);
void 0===b&&(b=0);void 0===c&&(c=this.length);a&&(c=Math.min(c,this.getTrimmedLength()));for(a="";b<c;){var f=this._data[3*b],g=2097151&f;a+=2097152&f?this._combined[b]:g?p.stringFromCodePoint(g):d.WHITESPACE_CELL_CHAR;b+=f>>22||1}return a},k);d.BufferLine=h},{"../../common/Types":27,"../input/TextDecoder":34}],30:[function(b,h,d){function a(a,b,d){if(b===a.length-1)return a[b].getTrimmedLength();var c=!a[b].hasContent(d-1)&&1===a[b].getWidth(d-1);a=2===a[b+1].getWidth(0);return c&&a?d-1:d}Object.defineProperty(d,
"__esModule",{value:!0});d.reflowLargerGetLinesToRemove=function(b,d,m,h,q){for(var c=[],f=0;f<b.length-1;f++){var g=f,n=b.get(++g);if(n.isWrapped){for(var k=[b.get(f)];g<b.length&&n.isWrapped;)k.push(n),n=b.get(++g);if(!(f<=h&&h<g)){g=0;n=a(k,g,d);for(var r=1,p=0;r<k.length;){var t=a(k,r,d),y=Math.min(t-p,m-n);k[g].copyCellsFrom(k[r],p,n,y,!1);(n+=y)===m&&(g++,n=0);(p+=y)===t&&(r++,p=0);0===n&&0!==g&&2===k[g-1].getWidth(m-1)&&(k[g].copyCellsFrom(k[g-1],m-1,n++,1,!1),k[g-1].setCell(m-1,q))}k[g].replaceCells(n,
m,q);n=0;for(r=k.length-1;0<r&&(g<r||0===k[r].getTrimmedLength());r--)n++;0<n&&(c.push(f+k.length-n),c.push(n))}f+=k.length-1}}return c};d.reflowLargerCreateNewLayout=function(a,b){for(var c=[],d=0,k=b[d],l=0,f=0;f<a.length;f++)k===f?(k=b[++d],a.onDeleteEmitter.fire({index:f-l,amount:k}),f+=k-1,l+=k,k=b[++d]):c.push(f);return{layout:c,countRemoved:l}};d.reflowLargerApplyNewLayout=function(a,b){for(var c=[],d=0;d<b.length;d++)c.push(a.get(b[d]));for(d=0;d<c.length;d++)a.set(d,c[d]);a.length=b.length};
d.reflowSmallerGetNewLineLengths=function(b,d,m){for(var c=[],k=b.map(function(f,c){return a(b,c,d)}).reduce(function(a,b){return a+b}),l=0,f=0,g=0;g<k;){if(k-g<m){c.push(k-g);break}l+=m;var n=a(b,f,d);n<l&&(l-=n,f++);(n=2===b[f].getWidth(l-1))&&l--;n=n?m-1:m;c.push(n);g+=n}return c};d.getWrappedLineTrimmedLength=a},{}],31:[function(b,h,d){function a(b){var c=k.call(this)||this;return c.line=b,c._id=a._nextId++,c.isDisposed=!1,c._onDispose=new m.EventEmitter2,c}var c;h=this&&this.__extends||(c=function(a,
b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f])})(a,b)},function(a,b){function d(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(d.prototype=b.prototype,new d)});Object.defineProperty(d,"__esModule",{value:!0});var k,m=b("../../common/EventEmitter2");b=(k=b("../../common/Lifecycle").Disposable,h(a,k),Object.defineProperty(a.prototype,"id",{get:function(){return this._id},
enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onDispose",{get:function(){return this._onDispose.event},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._onDispose.fire())},a._nextId=1,a);d.Marker=b},{"../../common/EventEmitter2":23,"../../common/Lifecycle":24}],32:[function(b,h,d){Object.defineProperty(d,"__esModule",{value:!0});d.CHARSETS={};d.DEFAULT_CHARSET=d.CHARSETS.B;d.CHARSETS[0]={"`":"\u25c6",a:"\u2592",b:"\t",c:"\f",
d:"\r",e:"\n",f:"\u00b0",g:"\u00b1",h:"\u2424",i:"\v",j:"\u2518",k:"\u2510",l:"\u250c",m:"\u2514",n:"\u253c",o:"\u23ba",p:"\u23bb",q:"\u2500",r:"\u23bc",s:"\u23bd",t:"\u251c",u:"\u2524",v:"\u2534",w:"\u252c",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03c0","|":"\u2260","}":"\u00a3","~":"\u00b7"};d.CHARSETS.A={"#":"\u00a3"};d.CHARSETS.B=null;d.CHARSETS[4]={"#":"\u00a3","@":"\u00be","[":"ij","\\":"\u00bd","]":"|","{":"\u00a8","|":"f","}":"\u00bc","~":"\u00b4"};d.CHARSETS.C=d.CHARSETS[5]={"[":"\u00c4",
"\\":"\u00d6","]":"\u00c5","^":"\u00dc","`":"\u00e9","{":"\u00e4","|":"\u00f6","}":"\u00e5","~":"\u00fc"};d.CHARSETS.R={"#":"\u00a3","@":"\u00e0","[":"\u00b0","\\":"\u00e7","]":"\u00a7","{":"\u00e9","|":"\u00f9","}":"\u00e8","~":"\u00a8"};d.CHARSETS.Q={"@":"\u00e0","[":"\u00e2","\\":"\u00e7","]":"\u00ea","^":"\u00ee","`":"\u00f4","{":"\u00e9","|":"\u00f9","}":"\u00e8","~":"\u00fb"};d.CHARSETS.K={"@":"\u00a7","[":"\u00c4","\\":"\u00d6","]":"\u00dc","{":"\u00e4","|":"\u00f6","}":"\u00fc","~":"\u00df"};
d.CHARSETS.Y={"#":"\u00a3","@":"\u00a7","[":"\u00b0","\\":"\u00e7","]":"\u00e9","`":"\u00f9","{":"\u00e0","|":"\u00f2","}":"\u00e8","~":"\u00ec"};d.CHARSETS.E=d.CHARSETS[6]={"@":"\u00c4","[":"\u00c6","\\":"\u00d8","]":"\u00c5","^":"\u00dc","`":"\u00e4","{":"\u00e6","|":"\u00f8","}":"\u00e5","~":"\u00fc"};d.CHARSETS.Z={"#":"\u00a3","@":"\u00a7","[":"\u00a1","\\":"\u00d1","]":"\u00bf","{":"\u00b0","|":"\u00f1","}":"\u00e7"};d.CHARSETS.H=d.CHARSETS[7]={"@":"\u00c9","[":"\u00c4","\\":"\u00d6","]":"\u00c5",
"^":"\u00dc","`":"\u00e9","{":"\u00e4","|":"\u00f6","}":"\u00e5","~":"\u00fc"};d.CHARSETS["="]={"#":"\u00f9","@":"\u00e0","[":"\u00e9","\\":"\u00e7","]":"\u00ea","^":"\u00ee",_:"\u00e8","`":"\u00f4","{":"\u00e4","|":"\u00f6","}":"\u00fc","~":"\u00fb"}},{}],33:[function(b,h,d){Object.defineProperty(d,"__esModule",{value:!0});var a=b("../../common/data/EscapeSequences"),c={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],
186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};d.evaluateKeyboardEvent=function(b,d,h,q){var l={type:0,cancel:!1,key:void 0},f=(b.shiftKey?1:0)|(b.altKey?2:0)|(b.ctrlKey?4:0)|(b.metaKey?8:0);switch(b.keyCode){case 0:"UIKeyInputUpArrow"===b.key?l.key=d?a.C0.ESC+"OA":a.C0.ESC+"[A":"UIKeyInputLeftArrow"===b.key?l.key=d?a.C0.ESC+"OD":a.C0.ESC+"[D":"UIKeyInputRightArrow"===b.key?l.key=d?a.C0.ESC+
"OC":a.C0.ESC+"[C":"UIKeyInputDownArrow"===b.key&&(l.key=d?a.C0.ESC+"OB":a.C0.ESC+"[B");break;case 8:if(b.shiftKey){l.key=a.C0.BS;break}if(b.altKey){l.key=a.C0.ESC+a.C0.DEL;break}l.key=a.C0.DEL;break;case 9:if(b.shiftKey){l.key=a.C0.ESC+"[Z";break}l.key=a.C0.HT;l.cancel=!0;break;case 13:l.key=a.C0.CR;l.cancel=!0;break;case 27:l.key=a.C0.ESC;l.cancel=!0;break;case 37:f?(l.key=a.C0.ESC+"[1;"+(1+f)+"D",l.key===a.C0.ESC+"[1;3D"&&(l.key=h?a.C0.ESC+"b":a.C0.ESC+"[1;5D")):l.key=d?a.C0.ESC+"OD":a.C0.ESC+
"[D";break;case 39:f?(l.key=a.C0.ESC+"[1;"+(1+f)+"C",l.key===a.C0.ESC+"[1;3C"&&(l.key=h?a.C0.ESC+"f":a.C0.ESC+"[1;5C")):l.key=d?a.C0.ESC+"OC":a.C0.ESC+"[C";break;case 38:f?(l.key=a.C0.ESC+"[1;"+(1+f)+"A",l.key===a.C0.ESC+"[1;3A"&&(l.key=a.C0.ESC+"[1;5A")):l.key=d?a.C0.ESC+"OA":a.C0.ESC+"[A";break;case 40:f?(l.key=a.C0.ESC+"[1;"+(1+f)+"B",l.key===a.C0.ESC+"[1;3B"&&(l.key=a.C0.ESC+"[1;5B")):l.key=d?a.C0.ESC+"OB":a.C0.ESC+"[B";break;case 45:b.shiftKey||b.ctrlKey||(l.key=a.C0.ESC+"[2~");break;case 46:l.key=
f?a.C0.ESC+"[3;"+(1+f)+"~":a.C0.ESC+"[3~";break;case 36:l.key=f?a.C0.ESC+"[1;"+(1+f)+"H":d?a.C0.ESC+"OH":a.C0.ESC+"[H";break;case 35:l.key=f?a.C0.ESC+"[1;"+(1+f)+"F":d?a.C0.ESC+"OF":a.C0.ESC+"[F";break;case 33:b.shiftKey?l.type=2:l.key=a.C0.ESC+"[5~";break;case 34:b.shiftKey?l.type=3:l.key=a.C0.ESC+"[6~";break;case 112:l.key=f?a.C0.ESC+"[1;"+(1+f)+"P":a.C0.ESC+"OP";break;case 113:l.key=f?a.C0.ESC+"[1;"+(1+f)+"Q":a.C0.ESC+"OQ";break;case 114:l.key=f?a.C0.ESC+"[1;"+(1+f)+"R":a.C0.ESC+"OR";break;case 115:l.key=
f?a.C0.ESC+"[1;"+(1+f)+"S":a.C0.ESC+"OS";break;case 116:l.key=f?a.C0.ESC+"[15;"+(1+f)+"~":a.C0.ESC+"[15~";break;case 117:l.key=f?a.C0.ESC+"[17;"+(1+f)+"~":a.C0.ESC+"[17~";break;case 118:l.key=f?a.C0.ESC+"[18;"+(1+f)+"~":a.C0.ESC+"[18~";break;case 119:l.key=f?a.C0.ESC+"[19;"+(1+f)+"~":a.C0.ESC+"[19~";break;case 120:l.key=f?a.C0.ESC+"[20;"+(1+f)+"~":a.C0.ESC+"[20~";break;case 121:l.key=f?a.C0.ESC+"[21;"+(1+f)+"~":a.C0.ESC+"[21~";break;case 122:l.key=f?a.C0.ESC+"[23;"+(1+f)+"~":a.C0.ESC+"[23~";break;
case 123:l.key=f?a.C0.ESC+"[24;"+(1+f)+"~":a.C0.ESC+"[24~";break;default:!b.ctrlKey||b.shiftKey||b.altKey||b.metaKey?h&&!q||!b.altKey||b.metaKey?h&&!b.altKey&&!b.ctrlKey&&b.metaKey?65===b.keyCode&&(l.type=1):b.key&&!b.ctrlKey&&!b.altKey&&!b.metaKey&&48<=b.keyCode&&1===b.key.length?l.key=b.key:b.key&&b.ctrlKey&&"_"===b.key&&(l.key=a.C0.US):(d=(d=c[b.keyCode])&&d[b.shiftKey?1:0])?l.key=a.C0.ESC+d:65<=b.keyCode&&90>=b.keyCode&&(l.key=a.C0.ESC+String.fromCharCode(b.ctrlKey?b.keyCode-64:b.keyCode+32)):
65<=b.keyCode&&90>=b.keyCode?l.key=String.fromCharCode(b.keyCode-64):32===b.keyCode?l.key=String.fromCharCode(0):51<=b.keyCode&&55>=b.keyCode?l.key=String.fromCharCode(b.keyCode-51+27):56===b.keyCode?l.key=String.fromCharCode(127):219===b.keyCode?l.key=String.fromCharCode(27):220===b.keyCode?l.key=String.fromCharCode(28):221===b.keyCode&&(l.key=String.fromCharCode(29))}return l}},{"../../common/data/EscapeSequences":28}],34:[function(b,h,d){function a(){this._interim=0}function c(){this.interim=new Uint8Array(3)}
Object.defineProperty(d,"__esModule",{value:!0});d.stringFromCodePoint=function(a){return 65535<a?(a-=65536,String.fromCharCode(55296+(a>>10))+String.fromCharCode(a%1024+56320)):String.fromCharCode(a)};d.utf32ToString=function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=a.length);for(var d="";b<c;++b){var l=a[b];65535<l?(l-=65536,d+=String.fromCharCode(55296+(l>>10))+String.fromCharCode(l%1024+56320)):d+=String.fromCharCode(l)}return d};b=(a.prototype.clear=function(){this._interim=0},a.prototype.decode=
function(a,b){var c=a.length;if(!c)return 0;var d=0,l=0;for(this._interim&&(56320<=(g=a.charCodeAt(l++))&&57343>=g?b[d++]=1024*(this._interim-55296)+g-56320+65536:(b[d++]=this._interim,b[d++]=g),this._interim=0);l<c;++l){var f=a.charCodeAt(l);if(55296<=f&&56319>=f){if(++l>=c)return this._interim=f,d;var g;56320<=(g=a.charCodeAt(l))&&57343>=g?b[d++]=1024*(f-55296)+g-56320+65536:(b[d++]=f,b[d++]=g)}else b[d++]=f}return d},a);d.StringToUtf32=b;b=(c.prototype.clear=function(){this.interim.fill(0)},c.prototype.decode=
function(a,b){var c=a.length;if(!c)return 0;var d,l,f,g,n=0,h=0,m=0;if(this.interim[0]){var k=!1,t=this.interim[0];t&=192==(224&t)?31:224==(240&t)?15:7;for(var y=0,w;(w=63&this.interim[++y])&&4>y;)t<<=6,t|=w;for(var v=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,C=v-y;m<C;){if(c<=m)return 0;if(128!=(192&(w=a[m++]))){m--;k=!0;break}t<<=6;t|=63&(this.interim[y++]=w)}k||(2==v?128>t?m--:b[n++]=t:3==v?2048>t||55296<=t&&57343>=t||(b[n++]=t):65536>h||1114111<h||(b[n++]=t));this.interim.fill(0)}for(k=
c-4;m<c;){for(;!(!(m<k)||128&(d=a[m])||128&(l=a[m+1])||128&(f=a[m+2])||128&(g=a[m+3]));)b[n++]=d,b[n++]=l,b[n++]=f,b[n++]=g,m+=4;if(128>(d=a[m++]))b[n++]=d;else if(192==(224&d)){if(c<=m)return this.interim[0]=d,n;128!=(192&(l=a[m++]))?m--:128>(h=(31&d)<<6|63&l)?m--:b[n++]=h}else if(224==(240&d)){if(c<=m)return this.interim[0]=d,n;if(128!=(192&(l=a[m++])))m--;else{if(c<=m)return this.interim[0]=d,this.interim[1]=l,n;128!=(192&(f=a[m++]))?m--:2048>(h=(15&d)<<12|(63&l)<<6|63&f)||55296<=h&&57343>=h||
(b[n++]=h)}}else if(240==(248&d)){if(c<=m)return this.interim[0]=d,n;if(128!=(192&(l=a[m++])))m--;else{if(c<=m)return this.interim[0]=d,this.interim[1]=l,n;if(128!=(192&(f=a[m++])))m--;else{if(c<=m)return this.interim[0]=d,this.interim[1]=l,this.interim[2]=f,n;128!=(192&(g=a[m++]))?m--:65536>(h=(7&d)<<18|(63&l)<<12|(63&f)<<6|63&g)||1114111<h||(b[n++]=h)}}}}return n},c);d.Utf8ToUtf32=b},{}],35:[function(b,h,d){function a(a,b){var c;this._mouseEvent=a;this._terminal=b;this._lines=this._terminal.buffer.lines;
this._startCol=this._terminal.buffer.x;this._startRow=this._terminal.buffer.y;(a=this._terminal.mouseHelper.getCoords(this._mouseEvent,this._terminal.element,this._terminal.charMeasure,this._terminal.cols,this._terminal.rows,!1))&&(c=a.map(function(a){return a-1}),this._endCol=c[0],this._endRow=c[1])}function c(a,b){a=Math.floor(a);for(var c="",d=0;d<a;d++)c+=b;return c}Object.defineProperty(d,"__esModule",{value:!0});var k=b("../common/data/EscapeSequences");b=(a.prototype.move=function(){this._mouseEvent.altKey&&
void 0!==this._endCol&&void 0!==this._endRow&&this._terminal.handler(this._arrowSequences())},a.prototype._arrowSequences=function(){return this._terminal.buffer.hasScrollback?this._moveHorizontallyOnly():this._resetStartingRow()+this._moveToRequestedRow()+this._moveToRequestedCol()},a.prototype._resetStartingRow=function(){return 0===this._moveToRequestedRow().length?"":c(this._bufferLine(this._startCol,this._startRow,this._startCol,this._startRow-this._wrappedRowsForRow(this._startRow),!1).length,
this._sequence("D"))},a.prototype._moveToRequestedRow=function(){var a=this._startRow-this._wrappedRowsForRow(this._startRow),b=this._endRow-this._wrappedRowsForRow(this._endRow);return c(Math.abs(a-b)-this._wrappedRowsCount(),this._sequence(this._verticalDirection()))},a.prototype._moveToRequestedCol=function(){var a=0<this._moveToRequestedRow().length?this._endRow-this._wrappedRowsForRow(this._endRow):this._startRow;var b=this._endRow,d=this._horizontalDirection();return c(this._bufferLine(this._startCol,
a,this._endCol,b,"C"===d).length,this._sequence(d))},a.prototype._moveHorizontallyOnly=function(){var a=this._horizontalDirection();return c(Math.abs(this._startCol-this._endCol),this._sequence(a))},a.prototype._wrappedRowsCount=function(){for(var a=0,b=this._startRow-this._wrappedRowsForRow(this._startRow),c=this._endRow-this._wrappedRowsForRow(this._endRow),d=0;d<Math.abs(b-c);d++){var f="A"===this._verticalDirection()?-1:1;this._lines.get(b+f*d).isWrapped&&a++}return a},a.prototype._wrappedRowsForRow=
function(a){for(var b=0,c=this._lines.get(a).isWrapped;c&&0<=a&&a<this._terminal.rows;)b++,a--,c=this._lines.get(a).isWrapped;return b},a.prototype._horizontalDirection=function(){var a;return a=0<this._moveToRequestedRow().length?this._endRow-this._wrappedRowsForRow(this._endRow):this._startRow,this._startCol<this._endCol&&a<=this._endRow||this._startCol>=this._endCol&&a<this._endRow?"C":"D"},a.prototype._verticalDirection=function(){return this._startRow>this._endRow?"A":"B"},a.prototype._bufferLine=
function(a,b,c,d,f){for(var g=a,l="";g!==c||b!==d;)g+=f?1:-1,f&&g>this._terminal.cols-1?(l+=this._terminal.buffer.translateBufferLineToString(b,!1,a,g),a=g=0,b++):!f&&0>g&&(l+=this._terminal.buffer.translateBufferLineToString(b,!1,0,a+1),a=g=this._terminal.cols-1,b--);return l+this._terminal.buffer.translateBufferLineToString(b,!1,a,g)},a.prototype._sequence=function(a){return k.C0.ESC+(this._terminal.applicationCursor?"O":"[")+a},a);d.AltClickHandler=b},{"../common/data/EscapeSequences":28}],36:[function(b,
h,d){function a(){this._addons=[]}Object.defineProperty(d,"__esModule",{value:!0});b=(a.prototype.dispose=function(){for(var a=this._addons.length-1;0<=a;a--)this._addons[a].instance.dispose()},a.prototype.loadAddon=function(a,b){var c=this,d={instance:b,dispose:b.dispose,isDisposed:!1};this._addons.push(d);b.dispose=function(){return c._wrappedAddonDispose(d)};b.activate(a)},a.prototype._wrappedAddonDispose=function(a){if(!a.isDisposed){for(var b=-1,c=0;c<this._addons.length;c++)if(this._addons[c]===
a){b=c;break}if(-1===b)throw Error("Could not dispose an addon that has not been loaded");a.isDisposed=!0;a.dispose.apply(a.instance);this._addons.splice(b,1)}},a);d.AddonManager=b},{}],37:[function(b,h,d){function a(a){this._core=new p.Terminal(a);this._addonManager=new l.AddonManager}function c(a){this._buffer=a}function k(a){this._line=a}function m(a,b){this._line=a;this._x=b}Object.defineProperty(d,"__esModule",{value:!0});var p=b("../Terminal"),q=b("../Strings"),l=b("./AddonManager");b=(Object.defineProperty(a.prototype,
"onCursorMove",{get:function(){return this._core.onCursorMove},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onLineFeed",{get:function(){return this._core.onLineFeed},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onSelectionChange",{get:function(){return this._core.onSelectionChange},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onData",{get:function(){return this._core.onData},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,
"onTitleChange",{get:function(){return this._core.onTitleChange},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onScroll",{get:function(){return this._core.onScroll},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onKey",{get:function(){return this._core.onKey},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onRender",{get:function(){return this._core.onRender},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onResize",{get:function(){return this._core.onResize},
enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"element",{get:function(){return this._core.element},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"textarea",{get:function(){return this._core.textarea},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rows",{get:function(){return this._core.rows},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"cols",{get:function(){return this._core.cols},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,
"buffer",{get:function(){return new f(this._core.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"markers",{get:function(){return this._core.markers},enumerable:!0,configurable:!0}),a.prototype.blur=function(){this._core.blur()},a.prototype.focus=function(){this._core.focus()},a.prototype.on=function(a,b){this._core.on(a,b)},a.prototype.off=function(a,b){this._core.off(a,b)},a.prototype.emit=function(a,b){this._core.emit(a,b)},a.prototype.addDisposableListener=function(a,
b){return this._core.addDisposableListener(a,b)},a.prototype.resize=function(a,b){this._core.resize(a,b)},a.prototype.writeln=function(a){this._core.writeln(a)},a.prototype.open=function(a){this._core.open(a)},a.prototype.attachCustomKeyEventHandler=function(a){this._core.attachCustomKeyEventHandler(a)},a.prototype.addCsiHandler=function(a,b){return this._core.addCsiHandler(a,b)},a.prototype.addOscHandler=function(a,b){return this._core.addOscHandler(a,b)},a.prototype.registerLinkMatcher=function(a,
b,f){return this._core.registerLinkMatcher(a,b,f)},a.prototype.deregisterLinkMatcher=function(a){this._core.deregisterLinkMatcher(a)},a.prototype.registerCharacterJoiner=function(a){return this._core.registerCharacterJoiner(a)},a.prototype.deregisterCharacterJoiner=function(a){this._core.deregisterCharacterJoiner(a)},a.prototype.addMarker=function(a){return this._core.addMarker(a)},a.prototype.hasSelection=function(){return this._core.hasSelection()},a.prototype.select=function(a,b,f){this._core.select(a,
b,f)},a.prototype.getSelection=function(){return this._core.getSelection()},a.prototype.getSelectionPosition=function(){return this._core.getSelectionPosition()},a.prototype.clearSelection=function(){this._core.clearSelection()},a.prototype.selectAll=function(){this._core.selectAll()},a.prototype.selectLines=function(a,b){this._core.selectLines(a,b)},a.prototype.dispose=function(){this._addonManager.dispose();this._core.dispose()},a.prototype.destroy=function(){this._core.destroy()},a.prototype.scrollLines=
function(a){this._core.scrollLines(a)},a.prototype.scrollPages=function(a){this._core.scrollPages(a)},a.prototype.scrollToTop=function(){this._core.scrollToTop()},a.prototype.scrollToBottom=function(){this._core.scrollToBottom()},a.prototype.scrollToLine=function(a){this._core.scrollToLine(a)},a.prototype.clear=function(){this._core.clear()},a.prototype.write=function(a){this._core.write(a)},a.prototype.writeUtf8=function(a){this._core.writeUtf8(a)},a.prototype.getOption=function(a){return this._core.getOption(a)},
a.prototype.setOption=function(a,b){this._core.setOption(a,b)},a.prototype.refresh=function(a,b){this._core.refresh(a,b)},a.prototype.reset=function(){this._core.reset()},a.applyAddon=function(b){b.apply(a)},a.prototype.loadAddon=function(a){return this._addonManager.loadAddon(this,a)},Object.defineProperty(a,"strings",{get:function(){return q},enumerable:!0,configurable:!0}),a);d.Terminal=b;var f=(Object.defineProperty(c.prototype,"cursorY",{get:function(){return this._buffer.y},enumerable:!0,configurable:!0}),
Object.defineProperty(c.prototype,"cursorX",{get:function(){return this._buffer.x},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"viewportY",{get:function(){return this._buffer.ydisp},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"baseY",{get:function(){return this._buffer.ybase},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"length",{get:function(){return this._buffer.lines.length},enumerable:!0,configurable:!0}),c.prototype.getLine=function(a){if(a=
this._buffer.lines.get(a))return new g(a)},c),g=(Object.defineProperty(k.prototype,"isWrapped",{get:function(){return this._line.isWrapped},enumerable:!0,configurable:!0}),k.prototype.getCell=function(a){if(!(0>a||a>=this._line.length))return new n(this._line,a)},k.prototype.translateToString=function(a,b,f){return this._line.translateToString(a,b,f)},k),n=(Object.defineProperty(m.prototype,"char",{get:function(){return this._line.getString(this._x)},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,
"width",{get:function(){return this._line.getWidth(this._x)},enumerable:!0,configurable:!0}),m)},{"../Strings":16,"../Terminal":17,"./AddonManager":36}],38:[function(b,h,d){function a(a,b,f,c,d){this._container=a;this._alpha=c;this._colors=d;this._scaledCharTop=this._scaledCharLeft=this._scaledCellHeight=this._scaledCellWidth=this._scaledCharHeight=this._scaledCharWidth=0;this._currentGlyphIdentifier={chars:"",code:0,bg:0,fg:0,bold:!1,dim:!1,italic:!1};this._canvas=document.createElement("canvas");
this._canvas.classList.add("xterm-"+b+"-layer");this._canvas.style.zIndex=f.toString();this._initCanvas();this._container.appendChild(this._canvas)}Object.defineProperty(d,"__esModule",{value:!0});var c=b("../common/Types"),k=b("./atlas/Types"),m=b("./atlas/CharAtlasCache"),p=b("../core/buffer/BufferLine");b=(a.prototype.dispose=function(){this._container.removeChild(this._canvas);this._charAtlas&&this._charAtlas.dispose()},a.prototype._initCanvas=function(){this._ctx=this._canvas.getContext("2d",
{alpha:this._alpha});this._alpha||this.clearAll()},a.prototype.onOptionsChanged=function(a){},a.prototype.onBlur=function(a){},a.prototype.onFocus=function(a){},a.prototype.onCursorMove=function(a){},a.prototype.onGridChanged=function(a,b,f){},a.prototype.onSelectionChanged=function(a,b,f,c){},a.prototype.setColors=function(a,b){this._refreshCharAtlas(a,b)},a.prototype.setTransparency=function(a,b){if(b!==this._alpha){var f=this._canvas;this._alpha=b;this._canvas=this._canvas.cloneNode();this._initCanvas();
this._container.replaceChild(this._canvas,f);this._refreshCharAtlas(a,this._colors);this.onGridChanged(a,0,a.rows-1)}},a.prototype._refreshCharAtlas=function(a,b){0>=this._scaledCharWidth&&0>=this._scaledCharHeight||(this._charAtlas=m.acquireCharAtlas(a,b,this._scaledCharWidth,this._scaledCharHeight),this._charAtlas.warmUp())},a.prototype.resize=function(a,b){this._scaledCellWidth=b.scaledCellWidth;this._scaledCellHeight=b.scaledCellHeight;this._scaledCharWidth=b.scaledCharWidth;this._scaledCharHeight=
b.scaledCharHeight;this._scaledCharLeft=b.scaledCharLeft;this._scaledCharTop=b.scaledCharTop;this._canvas.width=b.scaledCanvasWidth;this._canvas.height=b.scaledCanvasHeight;this._canvas.style.width=b.canvasWidth+"px";this._canvas.style.height=b.canvasHeight+"px";this._alpha||this.clearAll();this._refreshCharAtlas(a,this._colors)},a.prototype.fillCells=function(a,b,f,c){this._ctx.fillRect(a*this._scaledCellWidth,b*this._scaledCellHeight,f*this._scaledCellWidth,c*this._scaledCellHeight)},a.prototype.fillBottomLineAtCells=
function(a,b,f){void 0===f&&(f=1);this._ctx.fillRect(a*this._scaledCellWidth,(b+1)*this._scaledCellHeight-window.devicePixelRatio-1,f*this._scaledCellWidth,window.devicePixelRatio)},a.prototype.fillLeftLineAtCell=function(a,b){this._ctx.fillRect(a*this._scaledCellWidth,b*this._scaledCellHeight,window.devicePixelRatio,this._scaledCellHeight)},a.prototype.strokeRectAtCell=function(a,b,f,c){this._ctx.lineWidth=window.devicePixelRatio;this._ctx.strokeRect(a*this._scaledCellWidth+window.devicePixelRatio/
2,b*this._scaledCellHeight+window.devicePixelRatio/2,f*this._scaledCellWidth-window.devicePixelRatio,c*this._scaledCellHeight-window.devicePixelRatio)},a.prototype.clearAll=function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))},a.prototype.clearCells=function(a,b,f,c){this._alpha?this._ctx.clearRect(a*this._scaledCellWidth,b*this._scaledCellHeight,f*this._scaledCellWidth,
c*this._scaledCellHeight):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(a*this._scaledCellWidth,b*this._scaledCellHeight,f*this._scaledCellWidth,c*this._scaledCellHeight))},a.prototype.fillCharTrueColor=function(a,b,f,c){this._ctx.font=this._getFont(a,!1,!1);this._ctx.textBaseline="middle";this._clipRow(a,c);this._ctx.fillText(b.getChars(),f*this._scaledCellWidth+this._scaledCharLeft,c*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight/2)},a.prototype.drawChars=
function(a,b,f,d){var g,l;b.isFgRGB()||b.isBgRGB()?this._drawUncachedChars(a,b,f,d):(b.isInverse()?(g=b.isBgDefault()?k.INVERTED_DEFAULT_COLOR:b.getBgColor(),l=b.isFgDefault()?k.INVERTED_DEFAULT_COLOR:b.getFgColor()):(l=b.isBgDefault()?c.DEFAULT_COLOR:b.getBgColor(),g=b.isFgDefault()?c.DEFAULT_COLOR:b.getFgColor()),g+=a.options.drawBoldTextInBrightColors&&b.isBold()&&8>g&&g!==k.INVERTED_DEFAULT_COLOR?8:0,this._currentGlyphIdentifier.chars=b.getChars()||p.WHITESPACE_CELL_CHAR,this._currentGlyphIdentifier.code=
b.getCode()||p.WHITESPACE_CELL_CODE,this._currentGlyphIdentifier.bg=l,this._currentGlyphIdentifier.fg=g,this._currentGlyphIdentifier.bold=b.isBold()&&a.options.enableBold,this._currentGlyphIdentifier.dim=!!b.isDim(),this._currentGlyphIdentifier.italic=!!b.isItalic(),this._charAtlas&&this._charAtlas.draw(this._ctx,this._currentGlyphIdentifier,f*this._scaledCellWidth+this._scaledCharLeft,d*this._scaledCellHeight+this._scaledCharTop)||this._drawUncachedChars(a,b,f,d))},a.prototype._drawUncachedChars=
function(a,b,f,c){if(this._ctx.save(),this._ctx.font=this._getFont(a,b.isBold()&&a.options.enableBold,!!b.isItalic()),this._ctx.textBaseline="middle",b.isInverse())b.isBgDefault()?this._ctx.fillStyle=this._colors.background.css:b.isBgRGB()?this._ctx.fillStyle="rgb("+p.AttributeData.toColorRGB(b.getBgColor()).join(",")+")":this._ctx.fillStyle=this._colors.ansi[b.getBgColor()].css;else if(b.isFgDefault())this._ctx.fillStyle=this._colors.foreground.css;else if(b.isFgRGB())this._ctx.fillStyle="rgb("+
p.AttributeData.toColorRGB(b.getFgColor()).join(",")+")";else{var d=b.getFgColor();a.options.drawBoldTextInBrightColors&&b.isBold()&&8>d&&(d+=8);this._ctx.fillStyle=this._colors.ansi[d].css}this._clipRow(a,c);b.isDim()&&(this._ctx.globalAlpha=k.DIM_OPACITY);this._ctx.fillText(b.getChars(),f*this._scaledCellWidth+this._scaledCharLeft,c*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight/2);this._ctx.restore()},a.prototype._clipRow=function(a,b){this._ctx.beginPath();this._ctx.rect(0,
b*this._scaledCellHeight,a.cols*this._scaledCellWidth,this._scaledCellHeight);this._ctx.clip()},a.prototype._getFont=function(a,b,f){return(f?"italic":"")+" "+(b?a.options.fontWeightBold:a.options.fontWeight)+" "+a.options.fontSize*window.devicePixelRatio+"px "+a.options.fontFamily},a);d.BaseRenderLayer=b},{"../common/Types":27,"../core/buffer/BufferLine":29,"./atlas/CharAtlasCache":48,"./atlas/Types":55}],39:[function(b,h,d){function a(a,b,f){var c=m.call(this)||this;return c.content=0,c.fg=a.fg,
c.bg=a.bg,c.combinedData=b,c._width=f,c}function c(a){this._terminal=a;this._characterJoiners=[];this._nextCharacterJoinerId=0;this._workCell=new p.CellData}var k;h=this&&this.__extends||(k=function(a,b){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f])})(a,b)},function(a,b){function f(){this.constructor=a}k(a,b);a.prototype=null===b?Object.create(b):(f.prototype=b.prototype,new f)});Object.defineProperty(d,
"__esModule",{value:!0});var m,p=b("../core/buffer/BufferLine");b=(m=p.AttributeData,h(a,m),a.prototype.isCombined=function(){return 2097152},a.prototype.getWidth=function(){return this._width},a.prototype.getChars=function(){return this.combinedData},a.prototype.getCode=function(){return 2097151},a.prototype.setFromCharData=function(a){throw Error("not implemented");},a.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},a);d.JoinedCellData=b;b=(c.prototype.registerCharacterJoiner=
function(a){a={id:this._nextCharacterJoinerId++,handler:a};return this._characterJoiners.push(a),a.id},c.prototype.deregisterCharacterJoiner=function(a){for(var b=0;b<this._characterJoiners.length;b++)if(this._characterJoiners[b].id===a)return this._characterJoiners.splice(b,1),!0;return!1},c.prototype.getJoinedCharacters=function(a){if(0===this._characterJoiners.length)return[];a=this._terminal.buffer.lines.get(a);if(0===a.length)return[];for(var b=[],f=a.translateToString(!0),c=0,d=0,h=0,m=a.getFg(0),
k=a.getBg(0),q=0;q<a.getTrimmedLength();q++)if(a.loadCell(q,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==m||this._workCell.bg!==k){if(1<q-c)for(c=this._getJoinedRanges(f,h,d,a,c),h=0;h<c.length;h++)b.push(c[h]);c=q;h=d;m=this._workCell.fg;k=this._workCell.bg}d+=this._workCell.getChars().length||p.WHITESPACE_CELL_CHAR.length}if(1<this._terminal.cols-c)for(c=this._getJoinedRanges(f,h,d,a,c),h=0;h<c.length;h++)b.push(c[h]);return b},c.prototype._getJoinedRanges=function(a,b,
f,d,n){a=a.substring(b,f);b=this._characterJoiners[0].handler(a);for(f=1;f<this._characterJoiners.length;f++)for(var g=this._characterJoiners[f].handler(a),l=0;l<g.length;l++)c._mergeRanges(b,g[l]);return this._stringRangesToCellRanges(b,d,n),b},c.prototype._stringRangesToCellRanges=function(a,b,f){var c=0,d=!1,l=0,h=a[c];if(h){for(;f<this._terminal.cols;f++){var m=b.getWidth(f),k=b.getString(f).length||p.WHITESPACE_CELL_CHAR.length;if(0!==m){if(!d&&h[0]<=l&&(h[0]=f,d=!0),h[1]<=l){if(h[1]=f,!(h=a[++c]))break;
d=h[0]<=l&&(h[0]=f,!0)}l+=k}}h&&(h[1]=this._terminal.cols)}},c._mergeRanges=function(a,b){for(var f=!1,c=0;c<a.length;c++){var d=a[c];if(f){if(b[1]<=d[0])return a[c-1][1]=b[1],a;if(b[1]<=d[1])return a[c-1][1]=Math.max(b[1],d[1]),a.splice(c,1),a;a.splice(c,1);c--}else{if(b[1]<=d[0])return a.splice(c,0,b),a;if(b[1]<=d[1])return d[0]=Math.min(b[0],d[0]),a;b[0]<d[1]&&(d[0]=Math.min(b[0],d[0]),f=!0)}}return f?a[a.length-1][1]=b[1]:a.push(b),a},c);d.CharacterJoinerRegistry=b},{"../core/buffer/BufferLine":29}],
40:[function(b,h,d){function a(a,b,c){a=m.call(this,a,"cursor",b,!0,c)||this;return a._cell=new q.CellData,a._state={x:null,y:null,isFocused:null,style:null,width:null},a._cursorRenderers={bar:a._renderBarCursor.bind(a),block:a._renderBlockCursor.bind(a),underline:a._renderUnderlineCursor.bind(a)},a}function c(a,b){this._renderCallback=b;this.isCursorVisible=!0;a.isFocused&&this._restartInterval()}var k;h=this&&this.__extends||(k=function(a,b){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,b){a.__proto__=b}||function(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f])})(a,b)},function(a,b){function f(){this.constructor=a}k(a,b);a.prototype=null===b?Object.create(b):(f.prototype=b.prototype,new f)});Object.defineProperty(d,"__esModule",{value:!0});var m,p=b("./BaseRenderLayer"),q=b("../core/buffer/BufferLine");b=(m=p.BaseRenderLayer,h(a,m),a.prototype.resize=function(a,b){m.prototype.resize.call(this,a,b);this._state={x:null,y:null,isFocused:null,style:null,width:null}},
a.prototype.reset=function(a){this._clearCursor();this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=null,this.onOptionsChanged(a))},a.prototype.onBlur=function(a){this._cursorBlinkStateManager&&this._cursorBlinkStateManager.pause();a.refresh(a.buffer.y,a.buffer.y)},a.prototype.onFocus=function(a){this._cursorBlinkStateManager?this._cursorBlinkStateManager.resume(a):a.refresh(a.buffer.y,a.buffer.y)},a.prototype.onOptionsChanged=function(a){var b=
this;a.options.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new l(a,function(){b._render(a,!0)})):(this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=null),a.refresh(a.buffer.y,a.buffer.y))},a.prototype.onCursorMove=function(a){this._cursorBlinkStateManager&&this._cursorBlinkStateManager.restartBlinkAnimation(a)},a.prototype.onGridChanged=function(a,b,c){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?
this._render(a,!1):this._cursorBlinkStateManager.restartBlinkAnimation(a)},a.prototype._render=function(a,b){if(a.cursorState&&!a.cursorHidden){b=a.buffer.ybase+a.buffer.y;var f=b-a.buffer.ydisp;if(0>f||f>=a.rows)this._clearCursor();else if(a.buffer.lines.get(b).loadCell(a.buffer.x,this._cell),void 0!==this._cell.content){if(!a.isFocused)return this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._renderBlurCursor(a,a.buffer.x,f,this._cell),this._ctx.restore(),this._state.x=
a.buffer.x,this._state.y=f,this._state.isFocused=!1,this._state.style=a.options.cursorStyle,void(this._state.width=this._cell.getWidth());if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===a.buffer.x&&this._state.y===f&&this._state.isFocused===a.isFocused&&this._state.style===a.options.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save();this._cursorRenderers[a.options.cursorStyle||"block"](a,
a.buffer.x,f,this._cell);this._ctx.restore();this._state.x=a.buffer.x;this._state.y=f;this._state.isFocused=!1;this._state.style=a.options.cursorStyle;this._state.width=this._cell.getWidth()}else this._clearCursor()}}else this._clearCursor()},a.prototype._clearCursor=function(){this._state&&(this.clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:null,y:null,isFocused:null,style:null,width:null})},a.prototype._renderBarCursor=function(a,b,c,d){this._ctx.save();this._ctx.fillStyle=
this._colors.cursor.css;this.fillLeftLineAtCell(b,c);this._ctx.restore()},a.prototype._renderBlockCursor=function(a,b,c,d){this._ctx.save();this._ctx.fillStyle=this._colors.cursor.css;this.fillCells(b,c,d.getWidth(),1);this._ctx.fillStyle=this._colors.cursorAccent.css;this.fillCharTrueColor(a,d,b,c);this._ctx.restore()},a.prototype._renderUnderlineCursor=function(a,b,c,d){this._ctx.save();this._ctx.fillStyle=this._colors.cursor.css;this.fillBottomLineAtCells(b,c);this._ctx.restore()},a.prototype._renderBlurCursor=
function(a,b,c,d){this._ctx.save();this._ctx.strokeStyle=this._colors.cursor.css;this.strokeRectAtCell(b,c,d.getWidth(),1);this._ctx.restore()},a);d.CursorRenderLayer=b;var l=(Object.defineProperty(c.prototype,"isPaused",{get:function(){return!(this._blinkStartTimeout||this._blinkInterval)},enumerable:!0,configurable:!0}),c.prototype.dispose=function(){this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=null);this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),
this._blinkStartTimeout=null);this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=null)},c.prototype.restartBlinkAnimation=function(a){var b=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=window.requestAnimationFrame(function(){b._renderCallback();b._animationFrame=null})))},c.prototype._restartInterval=function(a){var b=this;void 0===a&&(a=600);this._blinkInterval&&window.clearInterval(this._blinkInterval);
this._blinkStartTimeout=setTimeout(function(){if(b._animationTimeRestarted){var a=600-(Date.now()-b._animationTimeRestarted);if(b._animationTimeRestarted=null,0<a)return void b._restartInterval(a)}b.isCursorVisible=!1;b._animationFrame=window.requestAnimationFrame(function(){b._renderCallback();b._animationFrame=null});b._blinkInterval=setInterval(function(){if(b._animationTimeRestarted){var a=600-(Date.now()-b._animationTimeRestarted);return b._animationTimeRestarted=null,void b._restartInterval(a)}b.isCursorVisible=
!b.isCursorVisible;b._animationFrame=window.requestAnimationFrame(function(){b._renderCallback();b._animationFrame=null})},600)},a)},c.prototype.pause=function(){this.isCursorVisible=!0;this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=null);this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=null);this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=null)},c.prototype.resume=function(a){this._animationTimeRestarted=
null;this._restartInterval();this.restartBlinkAnimation(a)},c)},{"../core/buffer/BufferLine":29,"./BaseRenderLayer":38}],41:[function(b,h,d){function a(){this.cache=[]}Object.defineProperty(d,"__esModule",{value:!0});b=(a.prototype.resize=function(a,b){for(var c=0;c<a;c++){this.cache.length<=c&&this.cache.push([]);for(var d=this.cache[c].length;d<b;d++)this.cache[c].push(null);this.cache[c].length=b}this.cache.length=a},a.prototype.clear=function(){for(var a=0;a<this.cache.length;a++)for(var b=0;b<
this.cache[a].length;b++)this.cache[a][b]=null},a);d.GridCache=b},{}],42:[function(b,h,d){function a(a,b,c,d){var f=k.call(this,a,"link",b,!0,c)||this;return f._state=null,d.linkifier.onLinkHover(function(a){return f._onLinkHover(a)}),d.linkifier.onLinkLeave(function(a){return f._onLinkLeave(a)}),f}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f])})(a,
b)},function(a,b){function f(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(f.prototype=b.prototype,new f)});Object.defineProperty(d,"__esModule",{value:!0});var k,m=b("./BaseRenderLayer"),p=b("./atlas/Types"),q=b("./atlas/CharAtlasUtils");b=(k=m.BaseRenderLayer,h(a,k),a.prototype.resize=function(a,b){k.prototype.resize.call(this,a,b);this._state=null},a.prototype.reset=function(a){this._clearCurrentLink()},a.prototype._clearCurrentLink=function(){if(this._state){this.clearCells(this._state.x1,
this._state.y1,this._state.cols-this._state.x1,1);var a=this._state.y2-this._state.y1-1;0<a&&this.clearCells(0,this._state.y1+1,this._state.cols,a);this.clearCells(0,this._state.y2,this._state.x2,1);this._state=null}},a.prototype._onLinkHover=function(a){if(a.fg===p.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._colors.background.css:q.is256Color(a.fg)?this._ctx.fillStyle=this._colors.ansi[a.fg].css:this._ctx.fillStyle=this._colors.foreground.css,a.y1===a.y2)this.fillBottomLineAtCells(a.x1,a.y1,
a.x2-a.x1);else{this.fillBottomLineAtCells(a.x1,a.y1,a.cols-a.x1);for(var b=a.y1+1;b<a.y2;b++)this.fillBottomLineAtCells(0,b,a.cols);this.fillBottomLineAtCells(0,a.y2,a.x2)}this._state=a},a.prototype._onLinkLeave=function(a){this._clearCurrentLink()},a);d.LinkRenderLayer=b},{"./BaseRenderLayer":38,"./atlas/CharAtlasUtils":50,"./atlas/Types":55}],43:[function(b,h,d){function a(a,b,c){var d=k.call(this)||this;if(d._renderer=a,d._rowCount=b,d._isPaused=!1,d._needsFullRefresh=!1,d._canvasWidth=0,d._canvasHeight=
0,d._onDimensionsChange=new p.EventEmitter2,d._onRender=new p.EventEmitter2,d._onRefreshRequest=new p.EventEmitter2,d._renderDebouncer=new m.RenderDebouncer(function(a,b){return d._renderRows(a,b)}),d.register(d._renderDebouncer),d._screenDprMonitor=new l.ScreenDprMonitor,d._screenDprMonitor.setListener(function(){return d._renderer.onDevicePixelRatioChange()}),d.register(d._screenDprMonitor),d.register(f.addDisposableDomListener(window,"resize",function(){return d._renderer.onDevicePixelRatioChange()})),
"IntersectionObserver"in window){var g=new IntersectionObserver(function(a){return d._onIntersectionChange(a[a.length-1])},{threshold:0});g.observe(c);d.register({dispose:function(){return g.disconnect()}})}return d}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var f in b)b.hasOwnProperty(f)&&(a[f]=b[f])})(a,b)},function(a,b){function f(){this.constructor=a}c(a,b);a.prototype=null===b?
Object.create(b):(f.prototype=b.prototype,new f)});Object.defineProperty(d,"__esModule",{value:!0});var k,m=b("../ui/RenderDebouncer"),p=b("../common/EventEmitter2"),q=b("../common/Lifecycle"),l=b("../ui/ScreenDprMonitor"),f=b("../ui/Lifecycle");b=(k=q.Disposable,h(a,k),Object.defineProperty(a.prototype,"onDimensionsChange",{get:function(){return this._onDimensionsChange.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onRender",{get:function(){return this._onRender.event},
enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onRefreshRequest",{get:function(){return this._onRefreshRequest.event},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dimensions",{get:function(){return this._renderer.dimensions},enumerable:!0,configurable:!0}),a.prototype._onIntersectionChange=function(a){this._isPaused=0===a.intersectionRatio;!this._isPaused&&this._needsFullRefresh&&(this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)},a.prototype.refreshRows=
function(a,b){this._isPaused?this._needsFullRefresh=!0:this._renderDebouncer.refresh(a,b,this._rowCount)},a.prototype._renderRows=function(a,b){this._renderer.renderRows(a,b);this._onRender.fire({start:a,end:b})},a.prototype.resize=function(a,b){this._rowCount=b;this._fireOnCanvasResize()},a.prototype.changeOptions=function(){this._renderer.onOptionsChanged();this._fireOnCanvasResize()},a.prototype._fireOnCanvasResize=function(){this._renderer.dimensions.canvasWidth===this._canvasWidth&&this._renderer.dimensions.canvasHeight===
this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions)},a.prototype.setRenderer=function(a){this._renderer.dispose();this._renderer=a},a.prototype._fullRefresh=function(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount)},a.prototype.setColors=function(a){this._renderer.setColors(a);this._fullRefresh()},a.prototype.onDevicePixelRatioChange=function(){this._renderer.onDevicePixelRatioChange()},a.prototype.onResize=function(a,b){this._renderer.onResize(a,
b);this._fullRefresh()},a.prototype.onCharSizeChanged=function(){this._renderer.onCharSizeChanged()},a.prototype.onBlur=function(){this._renderer.onBlur()},a.prototype.onFocus=function(){this._renderer.onFocus()},a.prototype.onSelectionChanged=function(a,b,f){this._renderer.onSelectionChanged(a,b,f)},a.prototype.onCursorMove=function(){this._renderer.onCursorMove()},a.prototype.onOptionsChanged=function(){this._renderer.onOptionsChanged()},a.prototype.clear=function(){this._renderer.clear()},a.prototype.registerCharacterJoiner=
function(a){return this._renderer.registerCharacterJoiner(a)},a.prototype.deregisterCharacterJoiner=function(a){return this._renderer.deregisterCharacterJoiner(a)},a);d.RenderCoordinator=b},{"../common/EventEmitter2":23,"../common/Lifecycle":24,"../ui/Lifecycle":59,"../ui/RenderDebouncer":60,"../ui/ScreenDprMonitor":61}],44:[function(b,h,d){function a(a,b){var c=k.call(this)||this;c._terminal=a;c._colors=b;b=c._terminal.options.allowTransparency;return c._characterJoinerRegistry=new f.CharacterJoinerRegistry(a),
c._renderLayers=[new m.TextRenderLayer(c._terminal.screenElement,0,c._colors,c._characterJoinerRegistry,b),new p.SelectionRenderLayer(c._terminal.screenElement,1,c._colors),new l.LinkRenderLayer(c._terminal.screenElement,2,c._colors,c._terminal),new q.CursorRenderLayer(c._terminal.screenElement,3,c._colors)],c.dimensions={scaledCharWidth:null,scaledCharHeight:null,scaledCellWidth:null,scaledCellHeight:null,scaledCharLeft:null,scaledCharTop:null,scaledCanvasWidth:null,scaledCanvasHeight:null,canvasWidth:null,
canvasHeight:null,actualCellWidth:null,actualCellHeight:null},c._devicePixelRatio=window.devicePixelRatio,c._updateDimensions(),c.onOptionsChanged(),c}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function f(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(f.prototype=b.prototype,new f)});Object.defineProperty(d,
"__esModule",{value:!0});var k,m=b("./TextRenderLayer"),p=b("./SelectionRenderLayer"),q=b("./CursorRenderLayer"),l=b("./LinkRenderLayer"),f=b("../renderer/CharacterJoinerRegistry");b=(k=b("../common/Lifecycle").Disposable,h(a,k),a.prototype.dispose=function(){k.prototype.dispose.call(this);this._renderLayers.forEach(function(a){return a.dispose()})},a.prototype.onDevicePixelRatioChange=function(){this._devicePixelRatio!==window.devicePixelRatio&&(this._devicePixelRatio=window.devicePixelRatio,this.onResize(this._terminal.cols,
this._terminal.rows))},a.prototype.setColors=function(a){var b=this;this._colors=a;this._renderLayers.forEach(function(a){a.setColors(b._terminal,b._colors);a.reset(b._terminal)})},a.prototype.onResize=function(a,b){var c=this;this._updateDimensions();this._renderLayers.forEach(function(a){return a.resize(c._terminal,c.dimensions)});this._terminal.screenElement.style.width=this.dimensions.canvasWidth+"px";this._terminal.screenElement.style.height=this.dimensions.canvasHeight+"px"},a.prototype.onCharSizeChanged=
function(){this.onResize(this._terminal.cols,this._terminal.rows)},a.prototype.onBlur=function(){var a=this;this._runOperation(function(b){return b.onBlur(a._terminal)})},a.prototype.onFocus=function(){var a=this;this._runOperation(function(b){return b.onFocus(a._terminal)})},a.prototype.onSelectionChanged=function(a,b,c){var f=this;void 0===c&&(c=!1);this._runOperation(function(d){return d.onSelectionChanged(f._terminal,a,b,c)})},a.prototype.onCursorMove=function(){var a=this;this._runOperation(function(b){return b.onCursorMove(a._terminal)})},
a.prototype.onOptionsChanged=function(){var a=this;this._runOperation(function(b){return b.onOptionsChanged(a._terminal)})},a.prototype.clear=function(){var a=this;this._runOperation(function(b){return b.reset(a._terminal)})},a.prototype._runOperation=function(a){this._renderLayers.forEach(function(b){return a(b)})},a.prototype.renderRows=function(a,b){var c=this;this._renderLayers.forEach(function(f){return f.onGridChanged(c._terminal,a,b)})},a.prototype._updateDimensions=function(){this._terminal.charMeasure.width&&
this._terminal.charMeasure.height&&(this.dimensions.scaledCharWidth=Math.floor(this._terminal.charMeasure.width*window.devicePixelRatio),this.dimensions.scaledCharHeight=Math.ceil(this._terminal.charMeasure.height*window.devicePixelRatio),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._terminal.options.lineHeight),this.dimensions.scaledCharTop=1===this._terminal.options.lineHeight?0:Math.round((this.dimensions.scaledCellHeight-this.dimensions.scaledCharHeight)/2),
this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._terminal.options.letterSpacing),this.dimensions.scaledCharLeft=Math.floor(this._terminal.options.letterSpacing/2),this.dimensions.scaledCanvasHeight=this._terminal.rows*this.dimensions.scaledCellHeight,this.dimensions.scaledCanvasWidth=this._terminal.cols*this.dimensions.scaledCellWidth,this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/
window.devicePixelRatio),this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._terminal.rows,this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._terminal.cols)},a.prototype.registerCharacterJoiner=function(a){return this._characterJoinerRegistry.registerCharacterJoiner(a)},a.prototype.deregisterCharacterJoiner=function(a){return this._characterJoinerRegistry.deregisterCharacterJoiner(a)},a);d.Renderer=b},{"../common/Lifecycle":24,"../renderer/CharacterJoinerRegistry":39,
"./CursorRenderLayer":40,"./LinkRenderLayer":42,"./SelectionRenderLayer":45,"./TextRenderLayer":46}],45:[function(b,h,d){function a(a,b,c){a=k.call(this,a,"selection",b,!0,c)||this;return a._clearState(),a}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function d(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):
(d.prototype=b.prototype,new d)});Object.defineProperty(d,"__esModule",{value:!0});var k;b=(k=b("./BaseRenderLayer").BaseRenderLayer,h(a,k),a.prototype._clearState=function(){this._state={start:null,end:null,columnSelectMode:null,ydisp:null}},a.prototype.resize=function(a,b){k.prototype.resize.call(this,a,b);this._clearState()},a.prototype.reset=function(a){this._state.start&&this._state.end&&(this._clearState(),this.clearAll())},a.prototype.onSelectionChanged=function(a,b,c,d){if(this._didStateChange(b,
c,d,a.buffer.ydisp))if(this.clearAll(),b&&c){var f=b[1]-a.buffer.ydisp,g=c[1]-a.buffer.ydisp,h=Math.max(f,0),l=Math.min(g,a.rows-1);h>=a.rows||0>l||((this._ctx.fillStyle=this._colors.selection.css,d)?(f=b[0],this.fillCells(f,h,c[0]-f,l-h+1)):(f=f===h?b[0]:0,this.fillCells(f,h,(h===l?c[0]:a.cols)-f,1),(this.fillCells(0,h+1,a.cols,Math.max(l-h-1,0)),h!==l)&&this.fillCells(0,l,g===l?c[0]:a.cols,1)),this._state.start=[b[0],b[1]],this._state.end=[c[0],c[1]],this._state.columnSelectMode=d,this._state.ydisp=
a.buffer.ydisp)}else this._clearState()},a.prototype._didStateChange=function(a,b,c,d){return!this._areCoordinatesEqual(a,this._state.start)||!this._areCoordinatesEqual(b,this._state.end)||c!==this._state.columnSelectMode||d!==this._state.ydisp},a.prototype._areCoordinatesEqual=function(a,b){return!(!a||!b)&&a[0]===b[0]&&a[1]===b[1]},a);d.SelectionRenderLayer=b},{"./BaseRenderLayer":38}],46:[function(b,h,d){function a(a,b,c,d,h){a=k.call(this,a,"text",b,h,c)||this;return a._characterOverlapCache=
{},a._workCell=new q.CellData,a._state=new m.GridCache,a._characterJoinerRegistry=d,a}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function d(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(d.prototype=b.prototype,new d)});Object.defineProperty(d,"__esModule",{value:!0});var k,m=b("./GridCache"),p=b("./BaseRenderLayer"),
q=b("../core/buffer/BufferLine"),l=b("./CharacterJoinerRegistry");b=(k=p.BaseRenderLayer,h(a,k),a.prototype.resize=function(a,b){k.prototype.resize.call(this,a,b);var c=this._getFont(a,!1,!1);this._characterWidth===b.scaledCharWidth&&this._characterFont===c||(this._characterWidth=b.scaledCharWidth,this._characterFont=c,this._characterOverlapCache={});this._state.clear();this._state.resize(a.cols,a.rows)},a.prototype.reset=function(a){this._state.clear();this.clearAll()},a.prototype._forEachCell=function(a,
b,c,d,h){for(;b<=c;b++){var f=b+a.buffer.ydisp,g=a.buffer.lines.get(f);f=d?d.getJoinedCharacters(f):[];for(var k=0;k<a.cols;k++){g.loadCell(k,this._workCell);var n=this._workCell,m=!1,r=k;0!==n.getWidth()&&(0<f.length&&k===f[0][0]&&(m=!0,r=f.shift(),n=new l.JoinedCellData(this._workCell,g.translateToString(!0,r[0],r[1]),r[1]-r[0]),r=r[1]-1),!m&&this._isOverlapping(n)&&r<g.length-1&&g.getCodePoint(r+1)===q.NULL_CELL_CODE&&(n.content&=-12582913,n.content|=8388608),h(n,k,b),k=r)}}},a.prototype._drawBackground=
function(a,b,c){var d=this,f=this._ctx,g=a.cols,h=0,l=0,k=null;f.save();this._forEachCell(a,b,c,null,function(a,b,c){var n=null;a.isInverse()?n=a.isFgDefault()?d._colors.foreground.css:a.isFgRGB()?"rgb("+q.AttributeData.toColorRGB(a.getFgColor()).join(",")+")":d._colors.ansi[a.getFgColor()].css:a.isBgRGB()?n="rgb("+q.AttributeData.toColorRGB(a.getBgColor()).join(",")+")":a.isBgPalette()&&(n=d._colors.ansi[a.getBgColor()].css);null===k&&(h=b,l=c);c!==l?(f.fillStyle=k,d.fillCells(h,l,g-h,1),h=b,l=c):
k!==n&&(f.fillStyle=k,d.fillCells(h,l,b-h,1),h=b,l=c);k=n});null!==k&&(f.fillStyle=k,this.fillCells(h,l,g-h,1));f.restore()},a.prototype._drawForeground=function(a,b,c){var d=this;this._forEachCell(a,b,c,this._characterJoinerRegistry,function(b,c,f){if(!b.isInvisible()&&(d.drawChars(a,b,c,f),b.isUnderline())){if(d._ctx.save(),b.isInverse())b.isBgDefault()?d._ctx.fillStyle=d._colors.background.css:b.isBgRGB()?d._ctx.fillStyle="rgb("+q.AttributeData.toColorRGB(b.getBgColor()).join(",")+")":d._ctx.fillStyle=
d._colors.ansi[b.getBgColor()].css;else if(b.isFgDefault())d._ctx.fillStyle=d._colors.foreground.css;else if(b.isFgRGB())d._ctx.fillStyle="rgb("+q.AttributeData.toColorRGB(b.getFgColor()).join(",")+")";else{var g=b.getFgColor();a.options.drawBoldTextInBrightColors&&b.isBold()&&8>g&&(g+=8);d._ctx.fillStyle=d._colors.ansi[g].css}d.fillBottomLineAtCells(c,f,b.getWidth());d._ctx.restore()}})},a.prototype.onGridChanged=function(a,b,c){0!==this._state.cache.length&&(this._charAtlas&&this._charAtlas.beginFrame(),
this.clearCells(0,b,a.cols,c-b+1),this._drawBackground(a,b,c),this._drawForeground(a,b,c))},a.prototype.onOptionsChanged=function(a){this.setTransparency(a,a.options.allowTransparency)},a.prototype._isOverlapping=function(a){if(1!==a.getWidth()||256>a.getCode())return!1;a=a.getChars();if(this._characterOverlapCache.hasOwnProperty(a))return this._characterOverlapCache[a];this._ctx.save();this._ctx.font=this._characterFont;var b=Math.floor(this._ctx.measureText(a).width)>this._characterWidth;return this._ctx.restore(),
this._characterOverlapCache[a]=b},a);d.TextRenderLayer=b},{"../core/buffer/BufferLine":29,"./BaseRenderLayer":38,"./CharacterJoinerRegistry":39,"./GridCache":41}],47:[function(b,h,d){function a(){this._didWarmUp=!1}Object.defineProperty(d,"__esModule",{value:!0});b=(a.prototype.dispose=function(){},a.prototype.warmUp=function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)},a.prototype._doWarmUp=function(){},a.prototype.beginFrame=function(){},a);d.default=b},{}],48:[function(b,h,d){Object.defineProperty(d,
"__esModule",{value:!0});var a=b("./CharAtlasUtils");h=b("./DynamicCharAtlas");var c=b("./NoneCharAtlas");b=b("./StaticCharAtlas");var k={none:c.default,static:b.default,dynamic:h.default},m=[];d.acquireCharAtlas=function(b,c,d,f){c=a.generateConfig(d,f,b,c);for(d=0;d<m.length;d++)if(f=(g=m[d]).ownedBy.indexOf(b),0<=f){if(a.configEquals(g.config,c))return g.atlas;1===g.ownedBy.length?(g.atlas.dispose(),m.splice(d,1)):g.ownedBy.splice(f,1);break}for(d=0;d<m.length;d++){var g=m[d];if(a.configEquals(g.config,
c))return g.ownedBy.push(b),g.atlas}b={atlas:new k[b.options.experimentalCharAtlas](document,c),config:c,ownedBy:[b]};return m.push(b),b.atlas};d.removeTerminalFromCache=function(a){for(var b=0;b<m.length;b++){var c=m[b].ownedBy.indexOf(a);if(-1!==c){1===m[b].ownedBy.length?(m[b].atlas.dispose(),m.splice(b,1)):m[b].ownedBy.splice(c,1);break}}}},{"./CharAtlasUtils":50,"./DynamicCharAtlas":51,"./NoneCharAtlas":53,"./StaticCharAtlas":54}],49:[function(b,h,d){function a(a,b){var c=!0,d=b.rgba>>>24,g=
b.rgba>>>16&255;b=b.rgba>>>8&255;for(var h=0;h<a.data.length;h+=4)a.data[h]===d&&a.data[h+1]===g&&a.data[h+2]===b?a.data[h+3]=0:c=!1;return c}function c(a,b){return a+" "+b.fontSize*b.devicePixelRatio+"px "+b.fontFamily}Object.defineProperty(d,"__esModule",{value:!0});var k=b("../../common/Platform"),m=b("./Types");d.generateStaticCharAtlasTexture=function(b,d,h){var f=h.scaledCharWidth+m.CHAR_ATLAS_CELL_SPACING,g=h.scaledCharHeight+m.CHAR_ATLAS_CELL_SPACING;d=d(255*f,34*g);var n=d.getContext("2d",
{alpha:h.allowTransparency});n.fillStyle=h.colors.background.css;n.fillRect(0,0,d.width,d.height);n.save();n.fillStyle=h.colors.foreground.css;n.font=c(h.fontWeight,h);n.textBaseline="middle";for(var l=0;256>l;l++)n.save(),n.beginPath(),n.rect(l*f,0,f,g),n.clip(),n.fillText(String.fromCharCode(l),l*f,g/2),n.restore();n.save();n.font=c(h.fontWeightBold,h);for(l=0;256>l;l++)n.save(),n.beginPath(),n.rect(l*f,g,f,g),n.clip(),n.fillText(String.fromCharCode(l),l*f,1.5*g),n.restore();n.restore();n.font=
c(h.fontWeight,h);for(var r=0;16>r;r++){var p=(r+2)*g;for(l=0;256>l;l++)n.save(),n.beginPath(),n.rect(l*f,p,f,g),n.clip(),n.fillStyle=h.colors.ansi[r].css,n.fillText(String.fromCharCode(l),l*f,p+g/2),n.restore()}n.font=c(h.fontWeightBold,h);for(r=0;16>r;r++)for(p=(r+2+16)*g,l=0;256>l;l++)n.save(),n.beginPath(),n.rect(l*f,p,f,g),n.clip(),n.fillStyle=h.colors.ansi[r].css,n.fillText(String.fromCharCode(l),l*f,p+g/2),n.restore();if(n.restore(),!("createImageBitmap"in b)||k.isFirefox||k.isSafari)return d;
f=n.getImageData(0,0,d.width,d.height);return a(f,h.colors.background),b.createImageBitmap(f)};d.clearColor=a},{"../../common/Platform":25,"./Types":55}],50:[function(b,h,d){Object.defineProperty(d,"__esModule",{value:!0});var a=b("../../common/Types");d.generateConfig=function(a,b,d,h){h={foreground:h.foreground,background:h.background,cursor:null,cursorAccent:null,selection:null,ansi:h.ansi.slice(0,16)};return{type:d.options.experimentalCharAtlas,devicePixelRatio:window.devicePixelRatio,scaledCharWidth:a,
scaledCharHeight:b,fontFamily:d.options.fontFamily,fontSize:d.options.fontSize,fontWeight:d.options.fontWeight,fontWeightBold:d.options.fontWeightBold,allowTransparency:d.options.allowTransparency,colors:h}};d.configEquals=function(a,b){for(var c=0;c<a.colors.ansi.length;c++)if(a.colors.ansi[c].rgba!==b.colors.ansi[c].rgba)return!1;return a.type===b.type&&a.devicePixelRatio===b.devicePixelRatio&&a.fontFamily===b.fontFamily&&a.fontSize===b.fontSize&&a.fontWeight===b.fontWeight&&a.fontWeightBold===
b.fontWeightBold&&a.allowTransparency===b.allowTransparency&&a.scaledCharWidth===b.scaledCharWidth&&a.scaledCharHeight===b.scaledCharHeight&&a.colors.foreground===b.colors.foreground&&a.colors.background===b.colors.background};d.is256Color=function(b){return b<a.DEFAULT_COLOR}},{"../../common/Types":27}],51:[function(b,h,d){function a(a){return a.code<<21|a.bg<<12|a.fg<<3|(a.bold?0:4)+(a.dim?0:2)+(a.italic?0:1)}function c(a,b){var c=u.call(this)||this;c._config=b;c._drawToCacheCount=0;c._glyphsWaitingOnBitmap=
[];c._bitmapCommitTimeout=null;c._bitmap=null;c._cacheCanvas=a.createElement("canvas");c._cacheCanvas.width=1024;c._cacheCanvas.height=1024;c._cacheCtx=c._cacheCanvas.getContext("2d",{alpha:!0});a=a.createElement("canvas");a.width=c._config.scaledCharWidth;a.height=c._config.scaledCharHeight;c._tmpCtx=a.getContext("2d",{alpha:c._config.allowTransparency});c._width=Math.floor(1024/c._config.scaledCharWidth);c._height=Math.floor(1024/c._config.scaledCharHeight);a=c._width*c._height;return c._cacheMap=
new f.default(a),c._cacheMap.prealloc(a),c}var k;h=this&&this.__extends||(k=function(a,b){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}k(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(d,"__esModule",{value:!0});var m=b("./Types"),p=b("./BaseCharAtlas"),q=b("../../ui/ColorManager"),l=
b("./CharAtlasGenerator"),f=b("./LRUMap"),g=b("../../common/Platform"),n={css:"rgba(0, 0, 0, 0)",rgba:0};d.getGlyphCacheKey=a;var u;b=(u=p.default,h(c,u),c.prototype.dispose=function(){null!==this._bitmapCommitTimeout&&(window.clearTimeout(this._bitmapCommitTimeout),this._bitmapCommitTimeout=null)},c.prototype.beginFrame=function(){this._drawToCacheCount=0},c.prototype.draw=function(b,c,d,f){if(32===c.code)return!0;if(!this._canCache(c))return!1;var g=a(c),h=this._cacheMap.get(g);return null!=h?(this._drawFromCache(b,
h,d,f),!0):100>this._drawToCacheCount?(h=this._cacheMap.size<this._cacheMap.capacity?this._cacheMap.size:this._cacheMap.peek().index,c=this._drawToCache(c,h),this._cacheMap.set(g,c),this._drawFromCache(b,c,d,f),!0):!1},c.prototype._canCache=function(a){return 256>a.code},c.prototype._toCoordinateX=function(a){return a%this._width*this._config.scaledCharWidth},c.prototype._toCoordinateY=function(a){return Math.floor(a/this._width)*this._config.scaledCharHeight},c.prototype._drawFromCache=function(a,
b,c,d){if(!b.isEmpty){var f=this._toCoordinateX(b.index),g=this._toCoordinateY(b.index);a.drawImage(b.inBitmap?this._bitmap:this._cacheCanvas,f,g,this._config.scaledCharWidth,this._config.scaledCharHeight,c,d,this._config.scaledCharWidth,this._config.scaledCharHeight)}},c.prototype._getColorFromAnsiIndex=function(a){return a<this._config.colors.ansi.length?this._config.colors.ansi[a]:q.DEFAULT_ANSI_COLORS[a]},c.prototype._getBackgroundColor=function(a){return this._config.allowTransparency?n:a.bg===
m.INVERTED_DEFAULT_COLOR?this._config.colors.foreground:256>a.bg?this._getColorFromAnsiIndex(a.bg):this._config.colors.background},c.prototype._getForegroundColor=function(a){return a.fg===m.INVERTED_DEFAULT_COLOR?this._config.colors.background:256>a.fg?this._getColorFromAnsiIndex(a.fg):this._config.colors.foreground},c.prototype._drawToCache=function(a,b){this._drawToCacheCount++;this._tmpCtx.save();var c=this._getBackgroundColor(a);this._tmpCtx.globalCompositeOperation="copy";this._tmpCtx.fillStyle=
c.css;this._tmpCtx.fillRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight);this._tmpCtx.globalCompositeOperation="source-over";this._tmpCtx.font=(a.italic?"italic":"")+" "+(a.bold?this._config.fontWeightBold:this._config.fontWeight)+" "+this._config.fontSize*this._config.devicePixelRatio+"px "+this._config.fontFamily;this._tmpCtx.textBaseline="middle";this._tmpCtx.fillStyle=this._getForegroundColor(a).css;a.dim&&(this._tmpCtx.globalAlpha=m.DIM_OPACITY);this._tmpCtx.fillText(a.chars,
0,this._config.scaledCharHeight/2);this._tmpCtx.restore();a=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight);var d=!1;this._config.allowTransparency||(d=l.clearColor(a,c));c=this._toCoordinateX(b);var f=this._toCoordinateY(b);this._cacheCtx.putImageData(a,c,f);b={index:b,isEmpty:d,inBitmap:!1};return this._addGlyphToBitmap(b),b},c.prototype._addGlyphToBitmap=function(a){var b=this;"createImageBitmap"in window&&!g.isFirefox&&!g.isSafari&&(this._glyphsWaitingOnBitmap.push(a),
null===this._bitmapCommitTimeout&&(this._bitmapCommitTimeout=window.setTimeout(function(){return b._generateBitmap()},100)))},c.prototype._generateBitmap=function(){var a=this,b=this._glyphsWaitingOnBitmap;this._glyphsWaitingOnBitmap=[];window.createImageBitmap(this._cacheCanvas).then(function(c){a._bitmap=c;for(c=0;c<b.length;c++)b[c].inBitmap=!0});this._bitmapCommitTimeout=null},c);d.default=b},{"../../common/Platform":25,"../../ui/ColorManager":58,"./BaseCharAtlas":47,"./CharAtlasGenerator":49,
"./LRUMap":52,"./Types":55}],52:[function(b,h,d){function a(a){this.capacity=a;this._map={};this._tail=this._head=null;this._nodePool=[];this.size=0}Object.defineProperty(d,"__esModule",{value:!0});b=(a.prototype._unlinkNode=function(a){var b=a.prev,c=a.next;a===this._head&&(this._head=c);a===this._tail&&(this._tail=b);null!==b&&(b.next=c);null!==c&&(c.prev=b)},a.prototype._appendNode=function(a){var b=this._tail;null!==b&&(b.next=a);a.prev=b;a.next=null;this._tail=a;null===this._head&&(this._head=
a)},a.prototype.prealloc=function(a){for(var b=this._nodePool,c=0;c<a;c++)b.push({prev:null,next:null,key:null,value:null})},a.prototype.get=function(a){a=this._map[a];return void 0!==a?(this._unlinkNode(a),this._appendNode(a),a.value):null},a.prototype.peekValue=function(a){a=this._map[a];return void 0!==a?a.value:null},a.prototype.peek=function(){var a=this._head;return null===a?null:a.value},a.prototype.set=function(a,b){var c=this._map[a];if(void 0!==c)c=this._map[a],this._unlinkNode(c),c.value=
b;else if(this.size>=this.capacity)c=this._head,this._unlinkNode(c),delete this._map[c.key],c.key=a,c.value=b,this._map[a]=c;else{var d=this._nodePool;0<d.length?((c=d.pop()).key=a,c.value=b):c={prev:null,next:null,key:a,value:b};this._map[a]=c;this.size++}this._appendNode(c)},a);d.default=b},{}],53:[function(b,h,d){function a(a,b){return k.call(this)||this}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||
function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function d(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(d.prototype=b.prototype,new d)});Object.defineProperty(d,"__esModule",{value:!0});var k;b=(k=b("./BaseCharAtlas").default,h(a,k),a.prototype.draw=function(a,b,c,d){return!1},a);d.default=b},{"./BaseCharAtlas":47}],54:[function(b,h,d){function a(a,b){var c=k.call(this)||this;return c._document=a,c._config=b,c._canvasFactory=function(a,b){var d=
c._document.createElement("canvas");return d.width=a,d.height=b,d},c}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function d(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(d.prototype=b.prototype,new d)});Object.defineProperty(d,"__esModule",{value:!0});var k,m=b("./Types"),p=b("./CharAtlasGenerator"),
q=b("./BaseCharAtlas"),l=b("./CharAtlasUtils"),f=b("../../common/Types");b=(k=q.default,h(a,k),a.prototype._doWarmUp=function(){var a=this,b=p.generateStaticCharAtlasTexture(window,this._canvasFactory,this._config);b instanceof HTMLCanvasElement?this._texture=b:b.then(function(b){a._texture=b})},a.prototype._isCached=function(a,b){b=16>a.fg;var c=a.fg===f.DEFAULT_COLOR,d=a.bg===f.DEFAULT_COLOR;return 256>a.code&&(b||c)&&d&&!a.italic},a.prototype.draw=function(a,b,c,d){if(null===this._texture||void 0===
this._texture)return!1;var g=0;if(l.is256Color(b.fg)?g=2+b.fg+(b.bold?16:0):b.fg===f.DEFAULT_COLOR&&b.bold&&(g=1),!this._isCached(b,g))return!1;a.save();var h=this._config.scaledCharWidth+m.CHAR_ATLAS_CELL_SPACING,k=this._config.scaledCharHeight+m.CHAR_ATLAS_CELL_SPACING;return b.dim&&(a.globalAlpha=m.DIM_OPACITY),a.drawImage(this._texture,b.code*h,g*k,h,this._config.scaledCharHeight,c,d,h,this._config.scaledCharHeight),a.restore(),!0},a);d.default=b},{"../../common/Types":27,"./BaseCharAtlas":47,
"./CharAtlasGenerator":49,"./CharAtlasUtils":50,"./Types":55}],55:[function(b,h,d){Object.defineProperty(d,"__esModule",{value:!0});d.INVERTED_DEFAULT_COLOR=257;d.DIM_OPACITY=.5;d.CHAR_ATLAS_CELL_SPACING=1},{}],56:[function(b,h,d){function a(a,b){var c=k.call(this)||this;return c._terminal=a,c._colors=b,c._terminalClass=q++,c._rowElements=[],c._rowContainer=document.createElement("div"),c._rowContainer.classList.add("xterm-rows"),c._rowContainer.style.lineHeight="normal",c._rowContainer.setAttribute("aria-hidden",
"true"),c._refreshRowElements(c._terminal.cols,c._terminal.rows),c._selectionContainer=document.createElement("div"),c._selectionContainer.classList.add("xterm-selection"),c._selectionContainer.setAttribute("aria-hidden","true"),c.dimensions={scaledCharWidth:null,scaledCharHeight:null,scaledCellWidth:null,scaledCellHeight:null,scaledCharLeft:null,scaledCharTop:null,scaledCanvasWidth:null,scaledCanvasHeight:null,canvasWidth:null,canvasHeight:null,actualCellWidth:null,actualCellHeight:null},c._updateDimensions(),
c._injectCss(),c._rowFactory=new m.DomRendererRowFactory(a.options,document),c._terminal.element.classList.add("xterm-dom-renderer-owner-"+c._terminalClass),c._terminal.screenElement.appendChild(c._rowContainer),c._terminal.screenElement.appendChild(c._selectionContainer),c._terminal.linkifier.onLinkHover(function(a){return c._onLinkHover(a)}),c._terminal.linkifier.onLinkLeave(function(a){return c._onLinkLeave(a)}),c}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function d(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(d.prototype=b.prototype,new d)});Object.defineProperty(d,"__esModule",{value:!0});var k,m=b("./DomRendererRowFactory"),p=b("../atlas/Types"),q=1;b=(k=b("../../common/Lifecycle").Disposable,h(a,k),a.prototype.dispose=function(){this._terminal.element.classList.remove("xterm-dom-renderer-owner-"+this._terminalClass);
this._terminal.screenElement.removeChild(this._rowContainer);this._terminal.screenElement.removeChild(this._selectionContainer);this._terminal.screenElement.removeChild(this._themeStyleElement);this._terminal.screenElement.removeChild(this._dimensionsStyleElement);k.prototype.dispose.call(this)},a.prototype._updateDimensions=function(){var a=this;this.dimensions.scaledCharWidth=this._terminal.charMeasure.width*window.devicePixelRatio;this.dimensions.scaledCharHeight=Math.ceil(this._terminal.charMeasure.height*
window.devicePixelRatio);this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._terminal.options.letterSpacing);this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._terminal.options.lineHeight);this.dimensions.scaledCharLeft=0;this.dimensions.scaledCharTop=0;this.dimensions.scaledCanvasWidth=this.dimensions.scaledCellWidth*this._terminal.cols;this.dimensions.scaledCanvasHeight=this.dimensions.scaledCellHeight*this._terminal.rows;this.dimensions.canvasWidth=
Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio);this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio);this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._terminal.cols;this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._terminal.rows;this._rowElements.forEach(function(b){b.style.width=a.dimensions.canvasWidth+"px";b.style.height=a.dimensions.actualCellHeight+"px";b.style.lineHeight=a.dimensions.actualCellHeight+
"px";b.style.overflow="hidden"});this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._terminal.screenElement.appendChild(this._dimensionsStyleElement));this._dimensionsStyleElement.innerHTML=this._terminalSelector+" .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: "+this.dimensions.actualCellWidth+"px}";this._selectionContainer.style.height=this._terminal._viewportElement.style.height;this._terminal.screenElement.style.width=
this.dimensions.canvasWidth+"px";this._terminal.screenElement.style.height=this.dimensions.canvasHeight+"px"},a.prototype.setColors=function(a){this._colors=a;this._injectCss()},a.prototype._injectCss=function(){var a=this;this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._terminal.screenElement.appendChild(this._themeStyleElement));var b=this._terminalSelector+" .xterm-rows { color: "+this._colors.foreground.css+"; background-color: "+this._colors.background.css+
"; font-family: "+this._terminal.options.fontFamily+"; font-size: "+this._terminal.options.fontSize+"px;}";b+=this._terminalSelector+" span:not(."+m.BOLD_CLASS+") { font-weight: "+this._terminal.options.fontWeight+";}"+this._terminalSelector+" span."+m.BOLD_CLASS+" { font-weight: "+this._terminal.options.fontWeightBold+";}"+this._terminalSelector+" span."+m.ITALIC_CLASS+" { font-style: italic;}";b+="@keyframes blink { 0% { opacity: 1.0; } 50% { opacity: 0.0; } 100% { opacity: 1.0; }}";b+=this._terminalSelector+
" .xterm-rows:not(.xterm-focus) ."+m.CURSOR_CLASS+" { outline: 1px solid "+this._colors.cursor.css+"; outline-offset: -1px;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+m.CURSOR_CLASS+"."+m.CURSOR_BLINK_CLASS+" { animation: blink 1s step-end infinite;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+m.CURSOR_CLASS+"."+m.CURSOR_STYLE_BLOCK_CLASS+" { background-color: "+this._colors.cursor.css+"; color: "+this._colors.cursorAccent.css+";}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+
m.CURSOR_CLASS+"."+m.CURSOR_STYLE_BAR_CLASS+" { box-shadow: 1px 0 0 "+this._colors.cursor.css+" inset;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+m.CURSOR_CLASS+"."+m.CURSOR_STYLE_UNDERLINE_CLASS+" { box-shadow: 0 -1px 0 "+this._colors.cursor.css+" inset;}";b+=this._terminalSelector+" .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}"+this._terminalSelector+" .xterm-selection div { position: absolute; background-color: "+this._colors.selection.css+
";}";this._colors.ansi.forEach(function(c,d){b+=a._terminalSelector+" .xterm-fg-"+d+" { color: "+c.css+"; }"+a._terminalSelector+" .xterm-bg-"+d+" { background-color: "+c.css+"; }"});b+=this._terminalSelector+" .xterm-fg-"+p.INVERTED_DEFAULT_COLOR+" { color: "+this._colors.background.css+"; }"+this._terminalSelector+" .xterm-bg-"+p.INVERTED_DEFAULT_COLOR+" { background-color: "+this._colors.foreground.css+"; }";this._themeStyleElement.innerHTML=b},a.prototype.onDevicePixelRatioChange=function(){this._updateDimensions()},
a.prototype._refreshRowElements=function(a,b){for(a=this._rowElements.length;a<=b;a++){var c=document.createElement("div");this._rowContainer.appendChild(c);this._rowElements.push(c)}for(;this._rowElements.length>b;)this._rowContainer.removeChild(this._rowElements.pop())},a.prototype.onResize=function(a,b){this._refreshRowElements(a,b);this._updateDimensions()},a.prototype.onCharSizeChanged=function(){this._updateDimensions()},a.prototype.onBlur=function(){this._rowContainer.classList.remove("xterm-focus")},
a.prototype.onFocus=function(){this._rowContainer.classList.add("xterm-focus")},a.prototype.onSelectionChanged=function(a,b,c){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(a&&b){var d=a[1]-this._terminal.buffer.ydisp,f=b[1]-this._terminal.buffer.ydisp,g=Math.max(d,0),h=Math.min(f,this._terminal.rows-1);if(!(g>=this._terminal.rows||0>h)){var k=document.createDocumentFragment();c?k.appendChild(this._createSelectionElement(g,
a[0],b[0],h-g+1)):(k.appendChild(this._createSelectionElement(g,d===g?a[0]:0,g===h?b[0]:this._terminal.cols)),(k.appendChild(this._createSelectionElement(g+1,0,this._terminal.cols,h-g-1)),g!==h)&&k.appendChild(this._createSelectionElement(h,0,f===h?b[0]:this._terminal.cols)));this._selectionContainer.appendChild(k)}}},a.prototype._createSelectionElement=function(a,b,c,d){void 0===d&&(d=1);var f=document.createElement("div");return f.style.height=d*this.dimensions.actualCellHeight+"px",f.style.top=
a*this.dimensions.actualCellHeight+"px",f.style.left=b*this.dimensions.actualCellWidth+"px",f.style.width=this.dimensions.actualCellWidth*(c-b)+"px",f},a.prototype.onCursorMove=function(){},a.prototype.onOptionsChanged=function(){this._updateDimensions();this._injectCss();this._terminal.refresh(0,this._terminal.rows-1)},a.prototype.clear=function(){this._rowElements.forEach(function(a){return a.innerHTML=""})},a.prototype.renderRows=function(a,b){for(var c=this._terminal,d=c.buffer.ybase+c.buffer.y,
f=this._terminal.buffer.x,h=this._terminal.options.cursorBlink;a<=b;a++){var k=this._rowElements[a];k.innerHTML="";var l=a+c.buffer.ydisp,m=c.buffer.lines.get(l);k.appendChild(this._rowFactory.createRow(m,l===d,c.options.cursorStyle,f,h,this.dimensions.actualCellWidth,c.cols))}},Object.defineProperty(a.prototype,"_terminalSelector",{get:function(){return".xterm-dom-renderer-owner-"+this._terminalClass},enumerable:!0,configurable:!0}),a.prototype.registerCharacterJoiner=function(a){return-1},a.prototype.deregisterCharacterJoiner=
function(a){return!1},a.prototype._onLinkHover=function(a){this._setCellUnderline(a.x1,a.x2,a.y1,a.y2,a.cols,!0)},a.prototype._onLinkLeave=function(a){this._setCellUnderline(a.x1,a.x2,a.y1,a.y2,a.cols,!1)},a.prototype._setCellUnderline=function(a,b,c,d,h,k){for(;a!==b||c!==d;){var f=this._rowElements[c];if(!f)break;(f=f.children[a])&&(f.style.textDecoration=k?"underline":"none");++a>=h&&(a=0,c++)}},a);d.DomRenderer=b},{"../../common/Lifecycle":24,"../atlas/Types":55,"./DomRendererRowFactory":57}],
57:[function(b,h,d){function a(a,b){this._terminalOptions=a;this._document=b;this._workCell=new k.CellData}Object.defineProperty(d,"__esModule",{value:!0});var c=b("../atlas/Types"),k=b("../../core/buffer/BufferLine");d.BOLD_CLASS="xterm-bold";d.DIM_CLASS="xterm-dim";d.ITALIC_CLASS="xterm-italic";d.UNDERLINE_CLASS="xterm-underline";d.CURSOR_CLASS="xterm-cursor";d.CURSOR_BLINK_CLASS="xterm-cursor-blink";d.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block";d.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar";d.CURSOR_STYLE_UNDERLINE_CLASS=
"xterm-cursor-underline";b=(a.prototype.createRow=function(a,b,h,l,f,g,n){var m=this._document.createDocumentFragment(),q=0;for(n=Math.min(a.length,n)-1;0<=n;n--)if(a.loadCell(n,this._workCell).getCode()!==k.NULL_CELL_CODE||b&&n===l){q=n+1;break}for(n=0;n<q;n++){a.loadCell(n,this._workCell);var p=this._workCell.getWidth();if(0!==p){var t=this._document.createElement("span");if(1<p&&(t.style.width=g*p+"px"),b&&n===l)switch(t.classList.add(d.CURSOR_CLASS),f&&t.classList.add(d.CURSOR_BLINK_CLASS),h){case "bar":t.classList.add(d.CURSOR_STYLE_BAR_CLASS);
break;case "underline":t.classList.add(d.CURSOR_STYLE_UNDERLINE_CLASS);break;default:t.classList.add(d.CURSOR_STYLE_BLOCK_CLASS)}this._workCell.isBold()&&this._terminalOptions.enableBold&&t.classList.add(d.BOLD_CLASS);this._workCell.isItalic()&&t.classList.add(d.ITALIC_CLASS);this._workCell.isDim()&&t.classList.add(d.DIM_CLASS);this._workCell.isUnderline()&&t.classList.add(d.UNDERLINE_CLASS);t.textContent=this._workCell.getChars()||k.WHITESPACE_CELL_CHAR;p=this._workCell.isInverse();if(this._workCell.isFgRGB()){var y=
t.getAttribute("style")||"";y+=(p?"background-":"")+"color:rgb("+k.AttributeData.toColorRGB(this._workCell.getFgColor()).join(",")+");";t.setAttribute("style",y)}else if(this._workCell.isFgPalette()){var w=this._workCell.getFgColor();this._workCell.isBold()&&8>w&&!p&&this._terminalOptions.enableBold&&this._terminalOptions.drawBoldTextInBrightColors&&(w+=8);t.classList.add("xterm-"+(p?"b":"f")+"g-"+w)}else p&&t.classList.add("xterm-bg-"+c.INVERTED_DEFAULT_COLOR);this._workCell.isBgRGB()?(y=t.getAttribute("style")||
"",y+=(p?"":"background-")+"color:rgb("+k.AttributeData.toColorRGB(this._workCell.getBgColor()).join(",")+");",t.setAttribute("style",y)):this._workCell.isBgPalette()?t.classList.add("xterm-"+(p?"f":"b")+"g-"+this._workCell.getBgColor()):p&&t.classList.add("xterm-fg-"+c.INVERTED_DEFAULT_COLOR);m.appendChild(t)}}return m},a);d.DomRendererRowFactory=b},{"../../core/buffer/BufferLine":29,"../atlas/Types":55}],58:[function(b,h,d){function a(a){return{css:a,rgba:parseInt(a.slice(1),16)<<8|255}}function c(a){a=
a.toString(16);return 2>a.length?"0"+a:a}function k(a,b){this.allowTransparency=b;a=a.createElement("canvas");a.width=1;a.height=1;a=a.getContext("2d");if(!a)throw Error("Could not get rendering context");this._ctx=a;this._ctx.globalCompositeOperation="copy";this._litmusColor=this._ctx.createLinearGradient(0,0,1,1);this.colors={foreground:m,background:p,cursor:q,cursorAccent:l,selection:f,ansi:d.DEFAULT_ANSI_COLORS.slice()}}Object.defineProperty(d,"__esModule",{value:!0});var m=a("#ffffff"),p=a("#000000"),
q=a("#ffffff"),l=a("#000000"),f={css:"rgba(255, 255, 255, 0.3)",rgba:4294967159};d.DEFAULT_ANSI_COLORS=function(){for(var b=[a("#2e3436"),a("#cc0000"),a("#4e9a06"),a("#c4a000"),a("#3465a4"),a("#75507b"),a("#06989a"),a("#d3d7cf"),a("#555753"),a("#ef2929"),a("#8ae234"),a("#fce94f"),a("#729fcf"),a("#ad7fa8"),a("#34e2e2"),a("#eeeeec")],d=[0,95,135,175,215,255],f=0;216>f;f++){var h=d[f/36%6|0],k=d[f/6%6|0],l=d[f%6];b.push({css:"#"+c(h)+c(k)+c(l),rgba:(h<<24|k<<16|l<<8|255)>>>0})}for(f=0;24>f;f++)d=8+10*
f,h=c(d),b.push({css:"#"+h+h+h,rgba:(d<<24|d<<16|d<<8|255)>>>0});return b}();b=(k.prototype.setTheme=function(a){void 0===a&&(a={});this.colors.foreground=this._parseColor(a.foreground,m);this.colors.background=this._parseColor(a.background,p);this.colors.cursor=this._parseColor(a.cursor,q,!0);this.colors.cursorAccent=this._parseColor(a.cursorAccent,l,!0);this.colors.selection=this._parseColor(a.selection,f,!0);this.colors.ansi[0]=this._parseColor(a.black,d.DEFAULT_ANSI_COLORS[0]);this.colors.ansi[1]=
this._parseColor(a.red,d.DEFAULT_ANSI_COLORS[1]);this.colors.ansi[2]=this._parseColor(a.green,d.DEFAULT_ANSI_COLORS[2]);this.colors.ansi[3]=this._parseColor(a.yellow,d.DEFAULT_ANSI_COLORS[3]);this.colors.ansi[4]=this._parseColor(a.blue,d.DEFAULT_ANSI_COLORS[4]);this.colors.ansi[5]=this._parseColor(a.magenta,d.DEFAULT_ANSI_COLORS[5]);this.colors.ansi[6]=this._parseColor(a.cyan,d.DEFAULT_ANSI_COLORS[6]);this.colors.ansi[7]=this._parseColor(a.white,d.DEFAULT_ANSI_COLORS[7]);this.colors.ansi[8]=this._parseColor(a.brightBlack,
d.DEFAULT_ANSI_COLORS[8]);this.colors.ansi[9]=this._parseColor(a.brightRed,d.DEFAULT_ANSI_COLORS[9]);this.colors.ansi[10]=this._parseColor(a.brightGreen,d.DEFAULT_ANSI_COLORS[10]);this.colors.ansi[11]=this._parseColor(a.brightYellow,d.DEFAULT_ANSI_COLORS[11]);this.colors.ansi[12]=this._parseColor(a.brightBlue,d.DEFAULT_ANSI_COLORS[12]);this.colors.ansi[13]=this._parseColor(a.brightMagenta,d.DEFAULT_ANSI_COLORS[13]);this.colors.ansi[14]=this._parseColor(a.brightCyan,d.DEFAULT_ANSI_COLORS[14]);this.colors.ansi[15]=
this._parseColor(a.brightWhite,d.DEFAULT_ANSI_COLORS[15])},k.prototype._parseColor=function(a,b,c){if(void 0===c&&(c=this.allowTransparency),void 0===a)return b;if(this._ctx.fillStyle=this._litmusColor,this._ctx.fillStyle=a,"string"!=typeof this._ctx.fillStyle)return console.warn("Color: "+a+" is invalid using fallback "+b.css),b;this._ctx.fillRect(0,0,1,1);var d=this._ctx.getImageData(0,0,1,1).data;return c||255===d[3]?{css:a,rgba:(d[0]<<24|d[1]<<16|d[2]<<8|d[3])>>>0}:(console.warn("Color: "+a+" is using transparency, but allowTransparency is false. Using fallback "+
b.css+"."),b)},k);d.ColorManager=b},{}],59:[function(b,h,d){Object.defineProperty(d,"__esModule",{value:!0});d.addDisposableDomListener=function(a,b,d,h){return a.addEventListener(b,d,h),{dispose:function(){d&&a.removeEventListener(b,d,h)}}}},{}],60:[function(b,h,d){function a(a){this._renderCallback=a}Object.defineProperty(d,"__esModule",{value:!0});b=(a.prototype.dispose=function(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},a.prototype.refresh=
function(a,b,d){var c=this;this._rowCount=d;a=void 0!==a?a:0;b=void 0!==b?b:this._rowCount-1;this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,a):a;this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,b):b;this._animationFrame||(this._animationFrame=window.requestAnimationFrame(function(){return c._innerRefresh()}))},a.prototype._innerRefresh=function(){void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount&&(this._rowStart=Math.max(this._rowStart,0),this._rowEnd=
Math.min(this._rowEnd,this._rowCount-1),this._renderCallback(this._rowStart,this._rowEnd),this._rowStart=void 0,this._rowEnd=void 0,this._animationFrame=void 0)},a);d.RenderDebouncer=b},{}],61:[function(b,h,d){function a(){var a=null!==k&&k.apply(this,arguments)||this;return a._currentDevicePixelRatio=window.devicePixelRatio,a}var c;h=this&&this.__extends||(c=function(a,b){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&
(a[c]=b[c])})(a,b)},function(a,b){function d(){this.constructor=a}c(a,b);a.prototype=null===b?Object.create(b):(d.prototype=b.prototype,new d)});Object.defineProperty(d,"__esModule",{value:!0});var k;b=(k=b("../common/Lifecycle").Disposable,h(a,k),a.prototype.setListener=function(a){var b=this;this._listener&&this.clearListener();this._listener=a;this._outerListener=function(){b._listener&&(b._listener(window.devicePixelRatio,b._currentDevicePixelRatio),b._updateDpr())};this._updateDpr()},a.prototype.dispose=
function(){k.prototype.dispose.call(this);this.clearListener()},a.prototype._updateDpr=function(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._currentDevicePixelRatio=window.devicePixelRatio,this._resolutionMediaMatchList=window.matchMedia("screen and (resolution: "+window.devicePixelRatio+"dppx)"),this._resolutionMediaMatchList.addListener(this._outerListener))},a.prototype.clearListener=function(){this._resolutionMediaMatchList&&
this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)},a);d.ScreenDprMonitor=b},{"../common/Lifecycle":24}],62:[function(b,h,d){Object.defineProperty(d,"__esModule",{value:!0});b=b("./public/Terminal");h.exports=b.Terminal},{"./public/Terminal":37}]},{},[62])(62)});SSHyClient.auth=function(e){this.parceler=e;this.authenticated=null;this.awaitingAuthentication=!1;this.hostname=wsproxyURL?wsproxyURL.split("/")[2].split(":")[0]:"";this.termUsername="";this.termPassword=void 0;this.failedAttempts=0;this.channelOpened=!1};
SSHyClient.auth.prototype={request_auth:function(){var e=new SSHyClient.Message;e.add_bytes(String.fromCharCode(SSHyClient.MSG_SERVICE_REQUEST));e.add_string("ssh-userauth");this.parceler.send(e)},ssh_connection:function(){if(this.termUsername&&this.termPassword){var e=new SSHyClient.Message;e.add_bytes(String.fromCharCode(SSHyClient.MSG_USERAUTH_REQUEST));e.add_string(this.termUsername);e.add_string("ssh-connection");e.add_string("password");e.add_boolean(!1);e.add_string(this.termPassword);this.awaitingAuthentication=
!0;this.parceler.send(e)}else term||startxtermjs()},auth_success:function(e){e&&(document.title=this.termUsername+"@"+this.hostname,this.termUsername="",this.termPassword=void 0,term||startxtermjs(),transport.settings.setKeepAlive(240),document.getElementById("keepAlive").value=240,this.open_channel("session"))},open_channel:function(e,b){b=new SSHyClient.Message;b.add_bytes(String.fromCharCode(SSHyClient.MSG_CHANNEL_OPEN));b.add_string(e);b.add_int(1);b.add_int(SSHyClient.WINDOW_SIZE);b.add_int(SSHyClient.MAX_PACKET_SIZE);
this.parceler.send(b)},mod_pty:function(e,b,h,d){if(this.channelOpened){var a=new SSHyClient.Message;a.add_bytes(String.fromCharCode(SSHyClient.MSG_CHANNEL_REQUEST));a.add_int(0);a.add_string(e);a.add_boolean(!1);d&&a.add_string(d);a.add_int(b);a.add_int(h);a.add_int(0);a.add_int(0);d&&a.add_string("");this.parceler.send(a);d&&this.invoke_shell()}},invoke_shell:function(){var e=new SSHyClient.Message;e.add_bytes(String.fromCharCode(SSHyClient.MSG_CHANNEL_REQUEST));e.add_int(0);e.add_string("shell");
e.add_boolean(!1);this.parceler.send(e);void 0===this.termPassword?term.write("\n\r"):startxtermjs()},authFailure:function(){term?(term.write("Access Denied\r\n"),5<=++this.failedAttempts?(term.write("Too many failed authentication attempts"),transport.disconnect()):(term.write(this.termUsername+"@"+this.hostname+"'s password:"),this.termPassword="")):display_error("Invalid Username or Password")}};SSHyClient.crypto={};SSHyClient.crypto.AES=function(e,b,h,d){this.cipher=new sjcl.cipher.aes(sjcl.codec.bytes.toBits(toByteArray(e)),b);this.mode=b;this.mode==SSHyClient.AES_CBC&&(this.iv=toByteArray(h));this.counter=d};
SSHyClient.crypto.AES.prototype={encrypt:function(e){e=this.cipher.encrypt(toByteArray(e),this.iv,this.counter);this.mode==SSHyClient.AES_CBC&&(this.iv=e.slice(-16));return fromByteArray(e)},decrypt:function(e){e=toByteArray(e);if(this.mode==SSHyClient.AES_CBC){var b=this.cipher.decrypt(e,this.iv);this.iv=e.slice(-16)}else b=this.cipher.encrypt(e,this.iv,this.counter);return fromByteArray(b)}};
SSHyClient.crypto.counter=function(e,b){b=void 0===b?1:b;this.blocksize=e/8;this.overflow=0;0===b?this.value=(new array(this.blocksize+1)).join("\u00ff"):(e=deflate_long(b.subtract(BigInteger.ONE),!1),this.value=Array(this.blocksize-e.length+1).join("\x00")+e)};
SSHyClient.crypto.counter.prototype={increment:function(){for(var e=this.blocksize;e--;){var b=String.fromCharCode((this.value.charCodeAt(e)+1)%256);this.value=setCharAt(this.value,e,b);if("\x00"!=b)return this.value}e=deflate_long(this.overflow,!1);return this.value=Array(this.blocksize-e.length+1).join("\x00")+e}};SSHyClient.kex={K:null,H:null,sessionId:null};function verifyKey(e,b){if(!(new SSHyClient.RSAKey(new SSHyClient.Message(e))).verify(SSHyClient.kex.H,new SSHyClient.Message(b)))throw transport.disconnect(),"RSA signature verification failed, disconnecting.";}
SSHyClient.kex.DiffieHellman=function(e,b,h){this.transport=e;this.SHAVersion=h;this.group=b;void 0===this.group?(this.p=this.q=this.g=this.x=this.e=this.f=null,this.minBits=1024,this.maxBits=8192,this.preferredBits=2048):(1===this.group?this.P=new BigInteger("FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE65381FFFFFFFFFFFFFFFF",
16):14===this.group&&(this.P=new BigInteger("FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AACAA68FFFFFFFFFFFFFFFF",
16)),this.x=this.e=this.f=new BigInteger("0",10),this.G=new BigInteger("2",10))};
SSHyClient.kex.DiffieHellman.prototype={start:function(){var e=new SSHyClient.Message;void 0===this.group?(e.add_bytes(String.fromCharCode(SSHyClient.MSG_KEXDH_GEX_REQUEST)),e.add_int(this.minBits),e.add_int(this.preferredBits),e.add_int(this.maxBits)):(this.x=inflate_long(read_rng(128)),this.e=this.G.modPow(this.x,this.P),e.add_bytes(String.fromCharCode(SSHyClient.MSG_KEXDH_INIT)),e.add_mpint(this.e));this.transport.send_packet(e)},parse_reply:function(e,b){void 0===this.group&&e==SSHyClient.MSG_KEXDH_GEX_GROUP?
this.parse_gex_group(b):this.handleDHReply(b)},handleDHReply:function(e){e=new SSHyClient.Message(e);var b=e.get_string();if(transport.settings.rsaCheckEnabled){var h=wsproxyURL.split("/")[3],d=ascii2hex(b),a=ascii2hex(SSHyClient.hash.MD5(b)).match(/.{2}/g);randomart(a);var c=localStorage.getItem(h);if(c){if(c!=d)if(confirm("WARNING - POTENTIAL SECURITY BREACH!\r\n\nThe servers host key does not match the one SSHy has cached in local storage. This means that either the server administrator has changed the host key, or you have actually connected to another computer pretending to be the server.\r\nThe new rsa2 key fingerprint is:\r\nssh-rsa 2048 "+
a.join(":")+"\r\nIf you were expecting this change and trust the new key, hit `Ok` to add the key to SSHy's cache and carry on connecting.\r\nIf you do not trust this new key, hit `Cancel` to abandon the connection"))localStorage.setItem(h,d);else throw ws.close(),"Error: Locally stored rsa key does not match remote key";}else if(confirm("The server's host key is not cached in local storage. You have no guarentee that the server is the computer you think it is.\n\rThe server's rsa2 key finterprint is:\r\nssh-rsa 2048 "+
a.join(":")+"\r\nIf you trust the host, hit `Ok` to add the key to SSHy's cache and carry on connecting.\r\nIf you do not trust this host, hit `Cancel` to abandon the connection"))localStorage.setItem(h,d);else throw ws.close(),"User has declined the rsa-key and closed the connection";}this.f=e.get_mpint();e=e.get_string();h=this.f.modPow(this.x,this.p);d=new SSHyClient.Message;d.add_string(this.transport.local_version);d.add_string(this.transport.remote_version);d.add_string(this.transport.local_kex_message);
d.add_string(this.transport.remote_kex_message);d.add_string(b);void 0===this.group&&(d.add_int(this.minBits),d.add_int(this.preferredBits),d.add_int(this.maxBits),d.add_mpint(this.p),d.add_mpint(this.g));d.add_mpint(this.e);d.add_mpint(this.f);d.add_mpint(h);SSHyClient.kex.K=h;SSHyClient.kex.sessionId=SSHyClient.kex.H="SHA-1"==this.SHAVersion?(new SSHyClient.hash.SHA1(d.toString())).digest():(new SSHyClient.hash.SHA256(d.toString())).digest();transport.settings.rsaCheckEnabled&&verifyKey(b,e);this.transport.send_new_keys()},
generate_x:function(){var e=this.p.subtract(BigInteger.ONE);e=e.divide(new BigInteger("2",10));var b=deflate_long(e,0),h=b[0].charCodeAt(0);b=b.length;for(var d=255;!(h&128);)h<<=1,d>>=1;for(;!(h=read_rng(b),h=String.fromCharCode(h[0].charCodeAt(0)&d)+h.substring(1),h=inflate_long(h,1),0<h.compareTo(BigInteger.ONE)&&0<e.compareTo(h)););this.x=h},parse_gex_group:function(e){e=new SSHyClient.Message(e);this.p=e.get_mpint();this.g=e.get_mpint();this.generate_x();this.e=this.g.modPow(this.x,this.p);e=
new SSHyClient.Message;e.add_bytes(String.fromCharCode(SSHyClient.MSG_KEXDH_GEX_INIT));e.add_mpint(this.e);this.transport.send_packet(e)}};SSHyClient.Message=function(e){this.position=0;this.packet=void 0===e?String():String(e)};
SSHyClient.Message.prototype={toString:function(){return this.packet},get_bytes:function(e){var b=this.packet.substring(this.position,this.position+e);this.position+=e;return b.length<e&&1048576>e?b+Array(e-b.length+1).join("\x00"):b},get_int:function(){return struct.unpack("I",this.get_bytes(4))[0]},get_string:function(){return this.get_bytes(this.get_int())},get_mpint:function(){return inflate_long(this.get_string())},add_bytes:function(e){this.packet+=e;return this},add_boolean:function(e){this.add_bytes(!0===
e?"\u0001":"\x00");return this},add_int:function(e){this.packet+=struct.pack("I",e);return this},add_mpint:function(e){this.add_string(deflate_long(e));return this},add_string:function(e){this.add_int(e.length);this.packet+=e;return this}};SSHyClient.parceler=function(e,b){this.socket=e;this.transport=b;this.encrypting=!1;this.hmacSHAVersion=this.inbound_iv=this.inbound_enc_key=this.inbound_mac_key=this.inbound_cipher=this.outbound_enc_iv=this.outbound_enc_key=this.outbound_mac_key=this.outbound_cipher=null;this.outbound_sequence_num=this.inbound_sequence_num=this.macSize=0;this.block_size=8;this.prevHeader=this.inbound_buffer="";this.windowSize=SSHyClient.WINDOW_SIZE;this.recieveData=this.transmitData=0};
SSHyClient.parceler.prototype={send:function(e){packet=this.pack_message(e.toString());this.encrypting&&(packet=this.outbound_cipher.encrypt(packet)+SSHyClient.hash.HMAC(this.outbound_mac_key,struct.pack("I",this.outbound_sequence_num)+packet,this.hmacSHAVersion));this.socket.sendB64(packet);this.outbound_sequence_num++},pack_message:function(e){var b=3+this.block_size-(e.length+8)%this.block_size;e=struct.pack("I",e.length+b+1)+struct.pack("B",b)+e;return e+=this.encrypting?read_rng(b):Array(b+1).join("\x00")},
handle:function(e){this.recieveData+=e.length;this.transport.settings.setNetTraffic(transport.parceler.recieveData,!0);if(this.encrypting)this.inbound_buffer+=e,this.decrypt();else if(this.transport.remote_version)this.inbound_buffer+=e,this.decrypt(e);else this.transport.handler_table[0](this.transport,e)},decrypt:function(){for(var e=" ",b;null!==e;){if(this.prevHeader)b=this.prevHeader,this.prevHeader="";else{b=this.read_ibuffer();if(!b)break;this.encrypting&&(b=this.inbound_cipher.decrypt(b))}var h=
struct.unpack("I",b.substring(0,4))[0],d=b.substring(4);e=this.read_ibuffer(h+this.macSize-d.length);if(!e){this.prevHeader=b;break}b=e.substring(0,h-d.length);this.encrypting&&(b=this.inbound_cipher.decrypt(b));b=d+b;if(this.macSize){d=e.substring(h-d.length);var a=struct.pack("I",this.inbound_sequence_num)+struct.pack("I",h)+b;if(SSHyClient.hash.HMAC(this.inbound_mac_key,a,this.hmacSHAVersion)!=d)throw this.transport.disconnect(),"Inbound MAC verification failed - Mismatched MAC";}this.inbound_sequence_num++;
this.windowSize-=h;0>=this.windowSize&&this.transport.winAdjust();this.transport.handle_dec(b)}},read_ibuffer:function(e){e=void 0===e?this.block_size:e;if(this.inbound_buffer.length<e)return null;var b=this.inbound_buffer.substring(0,e);this.inbound_buffer=this.inbound_buffer.substring(e);return b}};SSHyClient.RSAKey=function(e){e.get_string();this.e=e.get_mpint();this.n=e.get_mpint()};SSHyClient.RSAKey.prototype={pkcs1imify:function(e){return"\x00\u0001"+Array(deflate_long(this.n,0).length-15-e.length-3+1).join("\u00ff")+"\x000!0\t\u0006\u0005+\u000e\u0003\u0002\u001a\u0005\x00\u0004\u0014"+e},verify:function(e,b){if("ssh-rsa"!=b.get_string())return!1;b=inflate_long(b.get_string(),!0);e=inflate_long(this.pkcs1imify((new SSHyClient.hash.SHA1(e)).digest()),!0);return b.modPow(this.e,this.n).equals(e)}};SSHyClient.settings=function(){this.localEcho=0;this.fsHintEnter="\u001b[?1";this.fsHintLeave=SSHyClient.bashFsHintLeave;this.autoEchoState=!1;this.autoEchoTimeout=0;this.blockedKeys=[":"];this.keepAliveInterval=void 0;this.fontSize=16;this.colorTango=!0;this.colorNames=Object.keys(this.colorSchemes);this.colorCounter=0;this.shellString="";this.sidenavElementState=0;this.rxElement=document.getElementById("rxTraffic");this.txElement=document.getElementById("txTraffic");this.autoEchoElement=document.getElementById("autoEchoState");
this.rsaCheckEnabled=!0};
SSHyClient.settings.prototype={colorSchemes:[["Solarized",{background:"#002b36",black:"#002b36",red:"#dc322f",green:"#859900",yellow:"#b58900",blue:"#268bd2",magenta:"#6c71c4",cyan:"#2aa198",white:"#93a1a1",brightBlack:"#657b83",brightRed:"#dc322f",brightGreen:"#859900",brightYellow:"#b58900",brightBlue:"#268bd2",brightMagenta:"#6c71c4",brightCyan:"#2aa198",brightWhite:"#fdf6e3",cursor:"#93a1a1",foreground:"#93a1a1"}],["Material",{background:"#263238",black:"#263238",red:"#ff9800",green:"#8bc34a",
yellow:"#ffc107",blue:"#03a9f4",magenta:"#e91e63",cyan:"#009688",white:"#cfd8dc",brightBlack:"#37474f",brightRed:"#ffa74d",brightGreen:"#9ccc65",brightYellow:"#ffa000",brightBlue:"#81d4fa",brightMagenta:"#ad1457",brightCyan:"#26a69a",brightWhite:"#eceff1",cursor:"#eceff1",foreground:"#eceff1"}],["Monokai",{background:"#272822",black:"#272822",red:"#dc2566",green:"#8fc029",yellow:"#d4c96e",blue:"#55bcce",magenta:"#9358fe",cyan:"#56b7a5",white:"#acada1",brightBlack:"#76715e",brightRed:"#fa2772",brightGreen:"#a7e22e",
brightYellow:"#e7db75",brightBlue:"#66d9ee",brightMagenta:"#ae82ff",brightCyan:"#66efd5",brightWhite:"#cfd0c2",cursor:"#f1ebeb",foreground:"#f1ebeb"}],["Ashes",{background:"#1c2023",black:"#1c2023",red:"#c7ae95",green:"#95c7ae",yellow:"#aec795",blue:"#ae95c7",magenta:"#c795ae",cyan:"#95aec7",white:"#c7ccd1",brightBlack:"#747c84",brightRed:"#c7ae95",brightGreen:"#95c7ae",brightYellow:"#aec795",brightBlue:"#ae95c7",brightMagenta:"#c795ae",brightCyan:"#95aec7",brightWhite:"#f3f4f5",cursor:"#c7ccd1",
foreground:"#c7ccd1"}],["Google",{background:"#ffffff",black:"#ffffff",red:"#cc342b",green:"#198844",yellow:"#fba922",blue:"#3971ed",magenta:"#a36ac7",cyan:"#3971ed",white:"#c5c8c6",brightBlack:"#969896",brightRed:"#cc342b",brightGreen:"#198844",brightYellow:"#fba922",brightBlue:"#3971ed",brightMagenta:"#a36ac7",brightCyan:"#3971ed",brightWhite:"#ffffff",cursor:"#373b41",foreground:"#373b41"}],["Mono Light",{background:"#f7f7f7",black:"#f7f7f7",red:"#7c7c7c",green:"#8e8e8e",yellow:"#a0a0a0",blue:"#686868",
magenta:"#747474",cyan:"#868686",white:"#b9b9b9",brightBlack:"#525252",brightRed:"#7c7c7c",brightGreen:"#8e8e8e",brightYellow:"#a0a0a0",brightBlue:"#686868",brightMagenta:"#747474",brightCyan:"#868686",brightWhite:"#f7f7f7",cursor:"#464646",foreground:"#464646"}],["Mono Dark",{background:"#000000",black:"#000000",red:"#6b6b6b",green:"#c4c4c4",yellow:"#b3b3b3",blue:"#999999",magenta:"#717171",cyan:"#8a8a8a",white:"#b5cabb",brightBlack:"#202020",brightRed:"#464646",brightGreen:"#f8f8f8",brightYellow:"#eeeeee",
brightBlue:"#7c7c7c",brightMagenta:"#adadad",brightCyan:"#c0c0c0",brightWhite:"#99ac9e",cursor:"#ffffff",foreground:"#ffffff"}],["Tango",{}]],testShell:function(e){-1===e.substring(0,2).indexOf("]")&&(0===this.shellString.length||7<this.shellString.length)?this.shellString="":(this.shellString+=e,7>this.shellString.length||(-1!==this.shellString.indexOf("]0;fish")?(this.shellString="",this.fsHintLeave=SSHyClient.fishFsHintLeave):-1!==this.shellString.indexOf("@")&&(this.shellString="",this.fsHintLeave=
SSHyClient.bashFsHintLeave)))},setLocalEcho:function(e){this.localEcho=Math.min(Math.max(this.localEcho+=e,0),2);document.getElementById("currentLEcho").innerHTML=["Force Off","Auto","Force On"][this.localEcho];e=document.getElementById("autoEchoState");1===this.localEcho?(e.style.visibility="visible",e.innerHTML="State: "+(!1===this.autoEchoState?"Disabled":"Enabled")):e.style.visibility="hidden"},parseLocalEcho:function(e){if(1===this.localEcho){var b=performance.now();if(!(100>b-this.autoEchoTimeout))if(e=
e.substring(0,64),!this.autoEchoState)-1!=e.indexOf(this.fsHintLeave)&&-1!=e.indexOf("@")&&(this.autoEchoState=!0,this.autoEchoElement.innerHTML="State: Enabled",this.autoEchoTimeout=b);else if(-1!=e.indexOf(this.fsHintEnter)||-1!=e.toLowerCase().indexOf("password"))this.autoEchoState=!1,this.autoEchoElement.innerHTML="State: Disabled",this.autoEchoTimeout=b}},parseKey:function(e){1===this.localEcho&&!1===this.autoEchoState||1<e.key.length||this.blockedKeys.includes(e.key)||e.altKey||e.ctrlKey||e.metaKey||
(transport.lastKey||term.write(e.key),transport.lastKey+=e.key)},setKeepAlive:function(e){e=void 0===e?0:1E3*Math.floor(e);if(0===e||void 0!==this.keepAliveInterval)if(clearInterval(this.keepAliveInterval),this.keepAliveInterval=void 0,!e)return;this.keepAliveInterval=setInterval(transport.keepAlive,e)},setColorScheme:function(e){var b=document.styleSheets[0],h=this.colorSchemes[e][0];e=this.colorSchemes[e][1];term&&term._setTheme(e);if(!this.colorTango)for(i=0;4>i;i++)b.deleteRule(13);"Tango"===
h?(this.colorTango=!0,document.getElementById("currentColor").innerHTML="Tango"):(b.insertRule("html, body {background-color: "+e.background+" !important;}",13),b.insertRule(".sidenav {background-color: "+modColorPercent(e.background,-.2)+" !important;}",13),b.insertRule(".brightgreen {color: "+e.brightGreen+" !important;}",13),b.insertRule(".brightyellow {color: "+e.brightYellow+" !important;}",13),this.colorTango=!1,document.getElementById("currentColor").innerHTML=void 0===h?"Custom":h)},importXresources:function(){var e=
new FileReader,b=document.getElementById("Xresources").files[0];e.readAsText(b);e.onload=function(){var h=e.result.split("\n");h=h.sort((new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"})).compare);colScheme=[];for(var d=0;d<h.length;d++){var a=h[d].match(/#([0-9a-f]{3}){1,2}/ig);if(a&&(colScheme.push(a[0]),19<=colScheme.length))break}if(19!==colScheme.length)return alert("Uploaded file could not be parsed correctly.");colScheme={background:colScheme[0],black:colScheme[1],red:colScheme[2],
green:colScheme[3],yellow:colScheme[4],blue:colScheme[5],magenta:colScheme[6],cyan:colScheme[7],white:colScheme[8],brightBlack:colScheme[9],brightRed:colScheme[10],brightGreen:colScheme[11],brightYellow:colScheme[12],brightBlue:colScheme[13],brightMagenta:colScheme[14],brightCyan:colScheme[15],brightWhite:colScheme[16],cursor:colScheme[17],foreground:colScheme[18]};colName=".Xresources"===b.name?"custom":b.name.split(".")[0];transport.settings.colorSchemes.push([colName,colScheme]);transport.settings.colorNames=
Object.keys(transport.settings.colorSchemes);transport.settings.setColorScheme(transport.settings.colorSchemes.length-1)}},cycleColorSchemes:function(e){this.colorCounter=0===e?--this.colorCounter:++this.colorCounter;if(this.colorCounter>this.colorNames.length-1||0>this.colorCounter)this.colorCounter=1===e?0:this.colorNames.length-1;this.setColorScheme(this.colorCounter)},modFontSize:function(e){this.fontSize+=e;term.setOption("fontSize",this.fontSize);document.getElementById("currentFontSize").innerHTML=
transport.settings.fontSize+"px";term.fit();transport.auth.mod_pty("window-change",term.cols,term.rows)},modTerm:function(e,b){e?term.resize(term.cols,b):term.resize(b,term.rows);transport.auth.mod_pty("window-change",term.cols,term.rows)},setNetTraffic:function(e,b){if(this.sidenavElementState){switch(!0){case 1024>e:e+="Bytes";break;case 1024<=e&&1048576>e:e=(e/1024).toFixed(3)+"KB";break;case 1048576<=e&&1073741824>e:e=(e/1048576).toFixed(3)+"MB";break;default:e=(e/1073741824).toFixed(3)+"GB"}element=
!0===b?this.rxElement:this.txElement;element.innerHTML=e}}};var ws,transport,term=null;window.msCrypto&&(window.crypto={},window.crypto.getRandomValues=function(e){return window.msCrypto.getRandomValues(e)},Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice}));var resizeInterval;
window.onload=function(){document.body.innerHTML+='<div id="settingsNav" class="sidenav">\n\t\t\t\t\t\t\t\t\t<a href="javascript:;" class="closebtn" onclick="toggleNav(0)">&times;</a>\n\t\t\t\t\t\t\t\t\t<span class="title large">Terminal Options</span>\n\t\t\t\t\t\t\t\t\t<hr>\n\t\t\t\t\t\t\t\t\t<span class="title" style="padding-top:20px">Font Size</span>\n\t\t\t\t\t\t\t\t\t<a class="leftarrow" href="javascript:;" onclick="transport.settings.modFontSize(-1)"><--</a>\n\t\t\t\t\t\t\t\t\t<span class="middle" id="currentFontSize">16px</span>\n\t\t\t\t\t\t\t\t\t<a class="rightarrow" href="javascript:;" onclick="transport.settings.modFontSize(1)">--\x3e</a>\n\t\t\t\t\t\t\t\t\t<span class="title" style="padding-top:40px">Terminal Size</span>\n\t\t\t\t\t\t\t\t\t<span class="leftarrow">Cols:\n\t\t\t\t\t\t\t\t\t\t<input type="number" id="termCols" min="5" oninput="transport.settings.modTerm(0, this.value)">\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<span class="rightarrow">Rows:\n\t\t\t\t\t\t\t\t\t\t<input type="number" id="termRows" min="5" oninput="transport.settings.modTerm(1, this.value)">\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<span class="title" style="padding-top:60px;">Local Echo</span>\n\t\t\t\t\t\t\t\t\t<a class="leftarrow" href="javascript:;" onclick="transport.settings.setLocalEcho(-1)"><--</a>\n\t\t\t\t\t\t\t\t\t<a class="rightarrow" href="javascript:;" onclick="transport.settings.setLocalEcho(1)">--\x3e</a>\n\t\t\t\t\t\t\t\t\t<div class="fileUpload btn btn-primary nomargin">\n\t\t\t\t\t\t\t\t\t\t<span class="tooltiptext" style="visibility:visible;" id="autoEchoState">State: Enabled</span>\n\t\t\t\t\t\t\t\t\t\t<span class="middle" id="currentLEcho">Force Off</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<span class="title" style="padding-top:50px">Colours</span>\n\t\t\t\t\t\t\t\t\t<a class="leftarrow" href="javascript:;" onclick="transport.settings.cycleColorSchemes(0)"><--</a>\n\t\t\t\t\t\t\t\t\t<span class="middle" id="currentColor">Monokai</span>\n\t\t\t\t\t\t\t\t\t<a class="rightarrow" href="javascript:;" onclick="transport.settings.cycleColorSchemes(1)">--\x3e</a>\n\t\t\t\t\t\t\t\t\t<div class="fileUpload btn btn-primary">\n\t\t\t\t\t\t\t\t\t\t<span class="tooltiptext">Format: Xresources</span>\n\t\t\t\t\t\t\t\t\t\t<span class="middle" style="width:220px;">Upload</span>\n\t\t\t\t\t\t\t\t\t\t<input type="file" title=" " id="Xresources" class="upload" onchange="transport.settings.importXresources()" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<span class="title" style="padding-top:20px;">Keep Alive</span>\n\t\t\t\t\t\t\t\t\t<div class="fileUpload btn btn-primary">\n\t\t\t\t\t\t\t\t\t\t<span class="tooltiptext">0 to disable</span>\n\t\t\t\t\t\t\t\t\t\t<input type="number" class="large" id="keepAlive" onchange="transport.settings.setKeepAlive(this.value);" placeholder="0">\n\t\t\t\t\t\t\t\t\t\t<span style="font-size:16px;"> seconds</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<span class="title" style="padding-top:20px;">Network Traffic</span>\n\t\t\t\t\t\t\t\t\t<div class="netTraffic">\n\t\t\t\t\t\t\t\t\t\t<span class="leftarrow brightgreen">rx: <span id="rxTraffic"></span></span>\n\t\t\t\t\t\t\t\t\t\t<span class="rightarrow brightyellow">tx: <span id="txTraffic"></span></span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div id="hostKey" style="display: none;">\n\t\t\t\t\t\t\t\t        <span class="title" style="padding-top:20px;">Host Key</span>\n\t\t\t\t\t\t\t\t        <span id="hostKeyImg" class="hostKeyImg"></span>\n\t\t\t\t\t\t\t\t    </div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span id="gear" class="gear" style="visibility:visible;" onclick="toggleNav(250)">&#9881</span>';fit.apply(Terminal);
startSSHy()};window.onresize=function(){clearTimeout(resizeInterval);resizeInterval=setTimeout(resize,400)};window.onbeforeunload=function(){(ws||transport)&&transport.disconnect()};function resize(){term&&term.fit()}
function toggleNav(e){document.getElementById("settingsNav").style.width=e;if(transport.settings.sidenavElementState=e)transport.settings.setNetTraffic(transport.parceler.recieveData,!0),transport.settings.setNetTraffic(transport.parceler.transmitData,!1);e=document.getElementById("gear").style;e.visibility="hidden"===e.visibility?"visible":"hidden"}
function startSSHy(){document.title="SSHy Client";ws=new WebSocket(wsproxyURL,"base64");ws.onopen=function(e){transport=new SSHyClient.Transport(ws);transport.settings.rsaCheckEnabled=!1};ws.onmessage=function(e){transport.parceler.handle(atob(e.data))};ws.onclose=function(e){term?transport.closing||(term.write("\n\n\rWebsocket connection to "+transport.auth.hostname+" was unexpectedly closed."),transport.settings.keepAliveInterval||term.write("\n\n\rThis was likely caused by he remote SSH server timing out the session due to inactivity.\r\n- Session Keep Alive interval can be set in the settings to prevent this behaviour.")):
(termInit(),term.write("WebSocket connection failed: Error in connection establishment: code "+e.code))};ws.sendB64=function(e){this.send(btoa(e));transport.parceler.transmitData+=e.length;transport.settings.setNetTraffic(transport.parceler.transmitData,!1)}}
function termInit(){term=new Terminal({cols:80,rows:24});term.open(document.getElementById("terminal"),!0);term.fit();term.focus();document.getElementById("termCols").value=term.cols;document.getElementById("termRows").value=term.rows;transport.settings.setColorScheme(1)}
function startxtermjs(){termInit();transport.auth.authenticated||term.write("Login as: ");term.textarea.onkeydown=function(e){if(ws&&transport&&!(5<=transport.auth.failedAttempts)&&!transport.auth.awaitingAuthentication){var b=e.char&&1==e.char.length?e.char:e.key;if(!(1<b.length&&(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)&&"Backspace"!=b)){if(transport.auth.authenticated){if(1==b.length&&(!(e.altKey||e.ctrlKey||e.metaKey)||e.altKey&&e.ctrlKey))var h=b;else if(1==b.length&&e.shiftKey&&e.ctrlKey){if("V"!=
e.key){e.preventDefault();return}}else h=term._evaluateKeyEscapeSequence(e).key;transport.settings.localEcho&&transport.settings.parseKey(e);return null===h?null:transport.expect_key(h)}if(!(e.altKey||e.ctrlKey||e.metaKey||1<b.length&&13!=e.keyCode&&8!=e.keyCode))switch(e.keyCode){case 8:void 0===transport.auth.termPassword?0<transport.auth.termUsername.length&&(termBackspace(term),transport.auth.termUsername=transport.auth.termUsername.slice(0,transport.auth.termUsername.length-1)):transport.auth.termPassword=
transport.auth.termPassword.slice(0,transport.auth.termPassword.length-1);break;case 13:void 0===transport.auth.termPassword?(term.write("\n\r"+transport.auth.termUsername+"@"+transport.auth.hostname+"'s password: "),transport.auth.termPassword=""):(term.write("\n\r"),transport.auth.ssh_connection());break;default:void 0===transport.auth.termPassword?(transport.auth.termUsername+=b,term.write(b)):transport.auth.termPassword+=b}}}};term.textarea.onpaste=function(e){var b;window.clipboardData&&window.clipboardData.getData?
b=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData&&(b=e.clipboardData.getData("text/plain"));if(b)if(1E6>b.length)if(5E3<b.length)for(b=splitSlice(b),e=0;e<b.length;e++)transport.expect_key(b[e]);else transport.expect_key(b);else alert("Error: Pasting large strings is not permitted.")}};SSHyClient.Transport=function(e,b){this.local_version="SSH-2.0-SSHyClient";this.remote_version="";this.remote_kex_message=this.local_kex_message=null;this.preferred_algorithms="diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha256,diffie-hellman-group14-sha1,diffie-hellman-group1-sha256,diffie-hellman-group1-sha1 ssh-rsa aes128-ctr hmac-sha2-256,hmac-sha1 none ".split(" ");this.preferred_hash=this.preferred_mac=this.preferred_kex=null;this.parceler=
new SSHyClient.parceler(e,this);this.auth=new SSHyClient.auth(this.parceler);this.settings=void 0===b?new SSHyClient.settings:b;this.lastKey="";this.closing=!1};
SSHyClient.Transport.prototype={kex_info:{"diffie-hellman-group1-sha1":function(e){return new SSHyClient.kex.DiffieHellman(e,1,"SHA-1")},"diffie-hellman-group14-sha1":function(e){return new SSHyClient.kex.DiffieHellman(e,14,"SHA-1")},"diffie-hellman-group-exchange-sha1":function(e){return new SSHyClient.kex.DiffieHellman(e,void 0,"SHA-1")},"diffie-hellman-group1-sha256":function(e){return new SSHyClient.kex.DiffieHellman(e,1,"SHA-256")},"diffie-hellman-group14-sha256":function(e){return new SSHyClient.kex.DiffieHellman(e,
14,"SHA-256")},"diffie-hellman-group-exchange-sha256":function(e){return new SSHyClient.kex.DiffieHellman(e,void 0,"SHA-256")}},mac_info:{"hmac-sha1":function(e){e.parceler.hmacSHAVersion="SHA-1";e.preferred_hash=20},"hmac-sha2-256":function(e){e.parceler.hmacSHAVersion="SHA-256";e.preferred_hash=32}},handler_table:{0:function(e,b){e.parceler.socket.sendB64(e.local_version+"\r\n");e.remote_version=b.slice(0,b.length-2);e.send_kex_init()},1:function(e,b){e.disconnect()},2:function(e,b){},3:function(e,
b){},6:function(e,b){"ssh-userauth"==(new SSHyClient.Message(b.slice(1))).get_string()&&e.auth.ssh_connection()},20:function(e,b){e.parse_kex_reply(b);e.remote_kex_message=b;e.preferred_kex.start()},21:function(e){e.activate_encryption()},31:function(e,b){e.preferred_kex.parse_reply(31,b.slice(1))},33:function(e,b){e.preferred_kex.parse_reply(33,b.slice(1))},51:function(e,b){e.auth.awaitingAuthentication=!1;e.auth.authFailure()},52:function(e,b){e.auth.authenticated=!0;e.auth.awaitingAuthentication=
!1;e.auth.auth_success(!0)},80:function(e,b){},91:function(e,b){e.auth.channelOpened=!0;resize();e.auth.mod_pty("pty-req",term.cols,term.rows,"xterm")},93:function(e,b){},94:function(e,b){b=b.slice(9);if(e.settings.localEcho&&(e.settings.testShell(b),e.settings.parseLocalEcho(b),e.lastKey)){if(b==e.lastKey.substring(0,1)){e.lastKey=e.lastKey.slice(1);return}e.lastKey=e.lastKey.slice(1);term.write("\b")}term.write(fromUtf8(b))},96:function(e,b){},97:function(e,b){e.disconnect()},98:function(e,b){}},
winAdjust:function(){var e=new SSHyClient.Message;e.add_bytes(String.fromCharCode(SSHyClient.MSG_CHANNEL_WINDOW_ADJUST));e.add_int(0);e.add_int(SSHyClient.WINDOW_SIZE);this.send_packet(e.toString());this.parceler.windowSize=SSHyClient.WINDOW_SIZE},disconnect:function(e){this.closing=!0;e=void 0===e?11:e;var b=new SSHyClient.Message;b.add_bytes(String.fromCharCode(SSHyClient.MSG_DISCONNECT));b.add_int(e);this.send_packet(b.toString());ws.close();term.write("\r\nConnection to "+this.auth.hostname+" closed. Code - "+
e)},keepAlive:function(){if(3!==ws.readyState){var e=new SSHyClient.Message;e.add_bytes(String.fromCharCode(SSHyClient.MSG_IGNORE));e.add_string("");transport.send_packet(e.toString())}},cut_padding:function(e){return e.substring(1,e.length-e[0].charCodeAt(0))},send_packet:function(e){this.parceler.send(e)},send_kex_init:function(){var e=new SSHyClient.Message;e.add_bytes(String.fromCharCode(SSHyClient.MSG_KEX_INIT));e.add_bytes(read_rng(16));e.add_string(this.preferred_algorithms[0]);e.add_string(this.preferred_algorithms[1]);
for(var b=2;6>b;b++)e.add_string(this.preferred_algorithms[b]),e.add_string(this.preferred_algorithms[b]);e.add_boolean(!1);e.add_int(0);this.local_kex_message=e=e.toString();this.send_packet(e)},parse_kex_reply:function(e){e=new SSHyClient.Message(e);e.get_bytes(17);var b=filter(this.preferred_algorithms[0],e.get_string().split(",")),h=filter(this.preferred_algorithms[1],e.get_string().split(","));e.get_string();var d=filter(this.preferred_algorithms[2],e.get_string().split(","));e.get_string();
e=filter(this.preferred_algorithms[3],e.get_string().split(","));if(!(b&&h&&d&&e))throw"Chosen Algs = kex="+b+", keys="+h+", cipher="+d+", mac="+e;this.preferred_kex=this.kex_info[b](this);this.preferred_mac=this.mac_info[e](this)},generate_key:function(e,b){var h=new SSHyClient.Message;h.add_mpint(SSHyClient.kex.K);h.add_bytes(SSHyClient.kex.H);h.add_bytes(e);h.add_bytes(SSHyClient.kex.sessionId);return"SHA-1"==this.preferred_kex.SHAVersion?(new SSHyClient.hash.SHA1(h.toString())).digest().substring(0,
b):(new SSHyClient.hash.SHA256(h.toString())).digest().substring(0,b)},activate_encryption:function(){this.parceler.block_size=16;this.parceler.macSize=this.preferred_hash;this.parceler.outbound_enc_iv=this.generate_key("A",this.parceler.block_size,this.preferred_kex.SHAVersion);this.parceler.outbound_enc_key=this.generate_key("C",this.parceler.block_size,this.preferred_kex.SHAVersion);this.parceler.outbound_mac_key=this.generate_key("E",this.parceler.macSize,this.preferred_kex.SHAVersion);this.parceler.outbound_cipher=
new SSHyClient.crypto.AES(this.parceler.outbound_enc_key,SSHyClient.AES_CTR,this.parceler.outbound_enc_iv,new SSHyClient.crypto.counter(8*this.parceler.block_size,inflate_long(this.parceler.outbound_enc_iv)));this.parceler.inbound_enc_iv=this.generate_key("B",this.parceler.block_size,this.preferred_kex.SHAVersion);this.parceler.inbound_enc_key=this.generate_key("D",this.parceler.block_size,this.preferred_kex.SHAVersion);this.parceler.inbound_mac_key=this.generate_key("F",this.parceler.macSize,this.preferred_kex.SHAVersion);
this.parceler.inbound_cipher=new SSHyClient.crypto.AES(this.parceler.inbound_enc_key,SSHyClient.AES_CTR,this.parceler.inbound_enc_iv,new SSHyClient.crypto.counter(8*this.parceler.block_size,inflate_long(this.parceler.inbound_enc_iv)));this.parceler.encrypting=!0;this.auth.request_auth()},handle_dec:function(e){e=this.cut_padding(e);try{this.handler_table[e.substring(0,1).charCodeAt(0)](this,e)}catch(b){console.log(b),console.log("Error! code - "+e.substring(0,1).charCodeAt(0)+" does not exist!")}},
str_to_bytes:function(e){return unescape(encodeURIComponent(e))},expect_key:function(e){if(e){var b=new SSHyClient.Message;b.add_bytes(String.fromCharCode(SSHyClient.MSG_CHANNEL_DATA));b.add_int(0);b.add_string(this.str_to_bytes(e.toString()));this.parceler.send(b)}},send_new_keys:function(e){e=new SSHyClient.Message;e.add_bytes(String.fromCharCode(SSHyClient.MSG_NEW_KEYS));this.send_packet(e)}};
